/*
 2012 ReadSpeaker International B.v.

 @class ReadSpeaker.ui
 @namespace ReadSpeaker.ui
 @memberOf ReadSpeaker
 2012 ReadSpeaker International B.v.
 2012 ReadSpeaker International B.v.
 2012 ReadSpeaker International B.v.
 2012 ReadSpeaker International B.v.
 2012 ReadSpeaker International B.v.
*/
window.ReadSpeakerDefer={deferred:null,clickhandler:function(a){a=a||window.event;var b=a.target||a.srcElement;3===b.nodeType&&(b=b.parentNode);if(b!==document&&window.ReadSpeakerDefer.isRSLink(b))return window.ReadSpeakerDefer.deferred=b,(b=window.ReadSpeakerDefer.findRSParent(b))&&b.className&&!/rsdeferred/i.test(b.className)&&(b.className+=" rsdeferred"),a.cancelBubble=!0,a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),!1},init:function(){this.RSDeferClick(document)},
isRSLink:function(a){return this.isRSParent(a.parentNode)||a.href&&-1<a.href.indexOf("readspeaker.com/cgi-bin/rsent")},isRSParent:function(a){return a?a.className&&-1<a.className.indexOf("rsbtn")||a.id&&"string"===typeof a.id&&-1<a.id.indexOf("readspeaker_button"):!1},findRSParent:function(a){for(;a.parentNode&&a.parentNode!==document&&(a=a.parentNode,"a"!=a.tagName.toLowerCase()||!this.isRSLink(a)););return a==document?void 0:a.parentNode},RSDeferClick:function(a){a.addEventListener?a.addEventListener("click",
this.clickhandler,!1):a.attachEvent?a.attachEvent("onclick",this.clickhandler):a.onclick=this.clickhandler}};window.ReadSpeakerDefer.init();
(function(a){var b=function(){var b={major:"2",minor:"5",update:"7",revision:"2887",prod:"embhlcombined"},e=[],h=!1,c=0,g=null,l="",n={},k="",m={extract:function(c){if("string"==typeof c){var k={};c=c.split(/[;&]/);for(var a,g=0;g<c.length;g++)(a=c[g].split("="))&&2==a.length&&(k[unescape(a[0])]=unescape(a[1]).replace(/\+/g," "));return k}return{}}},p={isok:!0,executeCode:function(){this.isok=!0;if(!e.length)return!0;for(idx in e)if(e.hasOwnProperty(idx)&&"function"==typeof e[idx])try{e[idx].apply(a,
[])}catch(c){this.isok=!1,rspkr.log("[rspkr.q] "+c,3)}},flush:function(){e=[]}},q=0,t={1:[],2:[],3:[],4:[],5:[],6:[]},r=function(c){rspkr.log("[rspkr.printErrorLog]",1);c=(c||"3").split(",");for(var k=0;k<c.length;k++)if(t.hasOwnProperty(c[k])){var a=t[c[k]],g=c[k],g=parseInt(g)||3,b=w[g].lbl;console.groupCollapsed&&console.groupCollapsed(b);for(b=0;b<a.length;b++)try{console[w[g].method]&&console[w[g].method](a[b])}catch(p){}console.groupCollapsed&&console.groupEnd()}},w={1:{lbl:"Info",method:"log"},
2:{lbl:"Warn",method:"warn"},3:{lbl:"Err",method:"error"},4:{lbl:"AS",method:"log"},5:{lbl:"SW",method:"log"}},x=function(c,k){var a=l;k=k||1;t[k].push(c);if(a&&"string"===typeof a&&-1<a.indexOf(","+k+",")){a=w[k].lbl;try{console[w[k].method]&&console[w[k].method](q++ +". "+a+": "+c)}catch(g){}}};(function(){Object.size=function(c){var k=0,a;for(a in c)c.hasOwnProperty(a)&&k++;return k}})();(function(){if(a.rsConf&&a.rsConf.params&&"string"===typeof a.rsConf.params&&a.rsConf.params)var c=a.rsConf.params,
b=c.split("?");else b=document.getElementsByTagName("script"),c=b[b.length-1].getAttribute("src"),b=c.split("?");if(/\?/i.test(c)&&1<b.length&&b[1].length){k=c.replace(/[^\/]*$/,"");var p;if(/rsdebug=rsdebug/i.test(document.location.href))try{p=","+document.location.href.split("?").pop().match(/rsdebug=rsdebug([^$|&]*)/i).pop()+","}catch(f){p=",3,"}else p="";l=p;g=p=m.extract(b[1]);p.pids.split(",");g.path=b[0].replace("ReadSpeaker.js","")}})();return new function(){this.meta={obj:b,version:[b.major,
b.minor,b.update].join(".")+"_rev"+b.revision+"-"+b.prod};this.q=function(c){"function"==typeof c&&(n.onReady?c.apply(a,[]):e.push(c))};this.getParams=function(){return g};this.init=function(){h||(h=!0,document.addEventListener&&document.removeEventListener("DOMContentLoaded",a.ReadSpeaker.init,!1),a.ReadSpeaker.Common&&a.ReadSpeaker.Common.dispatchEvent("onDOMReady"),x("[rspkr] DOM Ready!"))};this.rsidCount=1E3;this.logcount=0;this.log=function(c,k){x(c,k||1)};this.showLog=function(c){r(c||"1")};
this.showLog=function(c){r(c||"1")};this.getID=function(){return"readspeaker"+c++};this.getVersion=function(){return this.meta.version};this.displog=n;this.dispatcher=p;this.baseUrl=k;this.audio=null}}();a.ReadSpeaker=a.rs=a.rspkr=b;rspkr.initialize={}})(window);
rspkr.initialize={getObjectRef:function(a){if("string"==typeof a){a="ReadSpeaker."+a.replace("_",".");a=a.split(".");for(var b=window,f=0,e=a.length;f<e;f++)if(b)if(b[a[f]]){if(f==e-1)return b[a[f]];b=b[a[f]]}else break;else break;return!1}},execInit:function(a){a=this.getObjectRef(a);if("function"===typeof a.init)try{a.init.apply(a,[])}catch(b){rspkr.log("[rspkr.initialize.execInit] Error: "+b.message,3)}}};
ReadSpeaker.Common=function(){var a={revision:"2887"},b={onAdapterReady:[],onInit:[],onCoreLoaded:[],onModsLoaded:[],onAfterModsLoaded:[],onAfterExtraModsLoaded:[],onConfigLoaded:[],onConfigSetup:[],onDOMReady:[],onReady:[],onSelectedText:[],onDeselectedText:[],onSettingsInitialized:[],onSettingsChanged:[],onSettingsLoaded:[],onSettingsClosed:[],onDownloadLoaded:[],onFocusIn:[],onFocusOut:[],onUIInitialized:[],onUIBeforePlay:[],onUIAfterPlay:[],onUIPause:[],onUISliderMove:[],onUIStop:[],onUIShowPlayer:[],
onUIClosePlayer:[],onAPIPlay:[],onAPIPause:[],onAPIStop:[],onAPIVolumeUp:[],onAPIVolumeDown:[],onAPIMute:[],onAPIFastForward:[],onAPIRewind:[],onAPISetVolume:[],onAPISetProgress:[],onAPIGetProgress:[],onAPIInitAdapter:[],onAPIReleaseAdapter:[],onAPIReloadAdapter:[],onBeforeSyncInit:[],onAfterSyncInit:[],onBeforeSync:[],onAfterSync:[],onAfterSyncExit:[],onBeforeContentChange:[],onAfterContentChange:[],onBeforeGetAudioLink:[],onBeforeParamsSet:[],onAudioLoadError:[],onVolumeAdjusted:[]},f={speed:function(c,
a){var g=parseInt(a||rspkr.pub.Config.item("general.defaultSpeedValue")||100);switch(c){case "slow":return g-25;case "medium":return g;case "fast":return g+25;default:return g}}},e={audioLink:null,params:{},postContent:"",postLink:null,saveLink:null,selectedHTML:"",selectedText:"",selectedRange:null,sync:"wordsent",syncLink:null,browser:{name:"",flashVersion:"",version:"",OS:"",html5AudioFormat:"",html5Support:!1,html5Priority:!1,syncContainer:""},setParams:function(c){rspkr.log("[rspkr.c.data.setParams] "+
c);if("string"==typeof c){this.params={};var a="",g="",a="";c=c.split("?")[1].split(/[;&]/);for(var b=0;b<c.length;b++)if((a=c[b].split("="))&&2==a.length){var g=decodeURIComponent(a[0]),f=a[1],a=decodeURIComponent(a[1]);if("url"==g)0==a.length&&(f=encodeURIComponent(document.location.href));else if("lang"==g&&2==a.length)for(var l in rspkr.cfg.item("phrases"))if(rspkr.cfg.item("phrases").hasOwnProperty(l)&&a==l.substring(0,2)){f=l;break}this.params[g]=f}this.params.rsjs_ver=rspkr.getVersion();this.params.synccontainer=
this.browser.syncContainer;this.params.url||(this.params.url=document.location.href);this.params.readid=this.params.readid||""}},setDefaultValues:function(){rspkr.log("[rspkr.c.data.setDefaultValues] Called!");rspkr.Common.data.selectedHTML="";rspkr.Common.data.saveLink=null},setPostContent:function(c){if("string"==typeof c)if("textsel"===c){var a=this.selectedHTML;!0===rspkr.cfg.item("general.parseMathJax")&&(a=this.parseMathJax(a));this.postContent=n.encode(a)}else{c=[];var g="";rspkr.hl&&rspkr.hl.Restore.hasMarkup()&&
rspkr.hl.sync.fullCleanUp();if(rspkr.Common.data.params.hasOwnProperty("readclass")){var b=rspkr.Common.data.params.readclass;c=$rs.get("."+b);$rs.isArray(c)||(c=[c]);for(a=0;a<c.length;a++)g+='<div class="'+b+'">'+c[a].innerHTML+"</div>"}else if(rspkr.Common.data.params.hasOwnProperty("readid"))for(a in c=rspkr.Common.data.params.readid.split(","),c)c.hasOwnProperty(a)&&(g+='<div id="'+c[a]+'">'+$rs.get(c[a]).innerHTML+"</div>");!0===rspkr.cfg.item("general.parseMathJax")&&(g=this.parseMathJax(g));
this.postContent=n.encode(g)}},parseMathJax:function(c){var a=document.createElement("div"),g,b,f;b=window.MathJax;a.innerHTML=c;if(g=$rs.findIn(a,".MathJax")){c=$rs.findIn(g,".math");$rs.isArray(c)&&0===c.length&&(c=g);c=$rs.isArray(c)?c:[c];for(var l=c.length-1;0<=l;l--)"object"===typeof c[l]&&(f=document.createElement("div"),mjaxObj=b.Hub.getJaxFor(c[l].id),f.innerHTML=mjaxObj.originalText,g=$rs.closest(c[l],"div.MathJax_Display"),$rs.hasClass(c[l],"math")?(c[l].parentNode.parentNode.replaceChild(f,
c[l].parentNode),g&&g.tagName&&g.parentNode.replaceChild(f,g)):g?g.parentNode.replaceChild(f,g):c[l].parentNode.replaceChild(f,c[l]));b=a.getElementsByTagName("script");for(c=b.length-1;0<=c;c--)b[c].type&&"math/mml"===b[c].type&&b[c].parentNode.removeChild(b[c]);return a.innerHTML}return c},setSelectedText:function(c){this.selectedText="";var a=void 0,b=void 0;window.getSelection?(b=window.getSelection(),b.isCollapsed||(b.getRangeAt?a=b.getRangeAt(0):(a=document.createRange(),a.setStart(b.anchorNode,
b.anchorOffset),a.setEnd(b.focusNode,b.focusOffset)),a?(DOM=a.cloneContents(),object=document.createElement("div"),object.appendChild(DOM.cloneNode(!0)),this.selectedText=object.innerHTML):this.selectedText=b),this.selectedRange=a):document.selection?(b=document.selection,this.selectedText=(a=b.createRange())&&a.htmlText&&a.text&&0<a.text.length?a.htmlText:a&&a.text?a.text:"",this.selectedRange=a.duplicate()):document.getSelection&&(this.selectedText=document.getSelection());window.getSelection?0<
this.selectedText.length&&window.getSelection().getRangeAt&&window.getSelection().getRangeAt(0)&&0<window.getSelection().getRangeAt(0).toString().length&&c?g("onSelectedText",window,[c]):(this.selectedText="",g("onDeselectedText",window,["empty"])):0<this.selectedText.length&&c?g("onSelectedText",window,[c]):g("onDeselectedText",window,["empty"]);rspkr.log("[rspkr.c.setSelectedText] Selected text length is "+this.selectedText.length)},createReadRange:function(c){if(c=document.getElementById(c))if(document.selection&&
(9>this.browser.version||9>document.documentMode)){var a=document.body.createTextRange();a.moveToElementText(c);this.selectedRange=a;this.selectedText=a.htmlText}else a=document.createRange(),a.selectNodeContents(c),this.selectedRange=a,this.selectedText=a.toString()},getParam:function(c){return this.params&&this.params[c]&&void 0!==this.params[c]?this.params[c]:null},getParams:function(){return this.params},getPostContent:function(){return this.postContent},getRestoreContent:function(){return this.restoreContent},
getSelectedText:function(){return this.selectedText},getAudioLink:function(c,a){rspkr.devt("onBeforeGetAudioLink",window);a="undefined"!==typeof a?a:rspkr.HL;this.audioLink=null;var g={},b;for(b in this.params)this.params.hasOwnProperty(b)&&(g[b]=this.params[b]);for(b in c)c.hasOwnProperty(b)&&(g[b]=c[b]);g.speed=f.speed(rspkr.Common.Settings.get("hlspeed"),g.speed?g.speed:void 0);(b=rspkr.cfg.item("general.selectionEngine"))&&"newcontent"===b&&g.hasOwnProperty("readid")&&1>this.selectedText.length&&
(!document.selection||document.selection&&8<rspkr.Common.data.browser.version&&8<document.documentMode)&&this.createReadRange(g.readid);if(g.readid&&/rslightbox_content/gi.test(g.readid)){0==rs.cfg.item("general.usePost")?(rs.cfg.item("general.usePost",!0),rspkr.c.addEvent("onSettingsClosed",function(){rs.cfg.item("general.usePost",!1);rs.PlayerAPI.stop()})):rspkr.c.addEvent("onSettingsClosed",function(){rs.PlayerAPI.stop()});var n=function(c){for(var a=function(c,a){return document.defaultView&&
document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(c,null)[a]:c.currentStyle?c.currentStyle[a]:c.style[a]},g=0;g<c.childNodes.length;g++){var k=c.childNodes[g],b=k.className&&-1!==k.className.indexOf("rs_skip_always");1!==k.nodeType||"none"!=a(k,"display")&&"hidden"!=a(k,"visibility")||b?k.title?$rs.addClass(k,"rs_skip_always"):1===k.nodeType&&n(k):$rs.addClass(k,"rs_skip_always")}};n($rs.get("rslightbox_content"))}0<this.selectedText.length||0<this.selectedHTML.length?(0<
this.selectedText.length&&a.clientMarkup.preProcess.init(),g.sync="user",g.syncalignuser=rspkr.st.get("hl"),this.setPostContent("textsel"),this.audioLink=l.issuePost(g)):!0===rspkr.cfg.item("general.premarkup")?(g.sync="user",this.setPostContent("nosel"),!0===rspkr.pub.Config.item("general.usePost")?this.audioLink=l.issuePost(g):this.audioLink=h(g)):!0===rspkr.pub.Config.item("general.usePost")?(g.sync="wordsent",this.setPostContent("nosel"),this.audioLink=l.issuePost(g)):(g.sync="wordsent",this.audioLink=
h(g));rspkr.log("[rspkr.c.data.getAudioLink] Audio link: "+this.audioLink);return this.audioLink},setSettingsChanged:function(c,a,g){"hlspeed"===c&&(rspkr.c.data.settingsChanged=!0)},settingsChanged:!1,getSaveData:function(c){rspkr.log("[rspkr.c.data.getSaveData]");if(!this.saveLink||this.settingsChanged){var a={},g={audioformat:"mp3"};this.settingsChanged=!1;"iOS"!==this.browser.OS&&"dialog"===(c||"link")&&(g.save="1");for(var b in this.params)this.params.hasOwnProperty(b)&&(a[b]=this.params[b]);
for(b in g)g.hasOwnProperty(b)&&(a[b]=g[b]);a.speed=f.speed(rspkr.st.get("hlspeed"),a.speed);0<this.selectedHTML.length?(this.setPostContent("textsel"),this.saveLink=l.issuePost(a)):!0===rspkr.cfg.item("general.usePost")?(this.setPostContent("nosel"),this.saveLink=l.issuePost(a)):this.saveLink=h(a)}return this.saveLink}},h=function(c){var a=rspkr.pub.Config.item("general.protocol")+"//"+rspkr.pub.Config.item("general.subdomain")+"."+rspkr.pub.Config.item("general.domain")+"/cgi-bin/"+rspkr.pub.Config.item("general.rsent")+
"?",g;for(g in c)c.hasOwnProperty(g)&&c[g]&&(a+=g+"="+c[g]+"&");return a.substr(0,a.length-1)},c=function(){var c=rspkr.cfg.item("extraMods")||[],g=[a.major,a.minor,a.update,a.revision].join("."),b=0;rspkr.log("[rspkr.c.loadExtraMods] Number of mod files to load: "+c.length);for(var f=0;f<c.length;f++){var l=c[f][0],n=l.substring(l.lastIndexOf(".")),e=void 0;".js"===n?(e=document.createElement("script"),e.type="text/javascript",e.src=rs.params.path+"mods/"+l+"?v="+g,e.async=!0):".css"===n&&(l=rs.params.path+
"mods/"+l+"?v="+g,"Explorer"==rs.c.data.browser.name&&8>=rs.c.data.browser.version?e=document.createStyleSheet(l):(e=document.createElement("link"),e.type="text/css",e.rel="stylesheet",e.href=l));"Explorer"==rs.c.data.browser.name&&8>=rs.c.data.browser.version||void 0===e.onreadystatechange?e.onload=function(a){a&&"function"==typeof a&&a.apply(window);b++;b==c.length&&rs.devt("onAfterExtraModsLoaded",window)}(c[f][1]):e.onreadystatechange=function(a){if("complete"==e.readyState||"loaded"==e.readyState)a&&
"function"==typeof a&&a.apply(window),b++,b==c.length&&rs.devt("onAfterExtraModsLoaded",window)}(c[f][1]);document.getElementsByTagName("head")[0].appendChild(e)}},g=function(c,a,g){if(b[c]){g=g||[];rspkr.displog[c]=rspkr.displog[c]?++rspkr.displog[c]:1;if(!b[c].length)return rspkr.log("[rspkr.c] Dispatched event: "+c+" - no handlers to call.",2),!0;rspkr.log("[rspkr.c] Dispatching event: "+c,1);for(var f in b[c])if(b[c].hasOwnProperty(f)&&"function"==typeof b[c][f])try{"__self__"===a&&(a=b[c][f]),
b[c][f].apply(a,g)}catch(l){rspkr.log("[rspkr.c._dispatchEvent] Error: "+l.message,3),this.isok=!1}else if("object"==typeof b[c][f])try{var e=b[c][f];e.func.apply(e.context||window,e.params||g)}catch(n){this.isok=!1}}else rspkr.log("[rspkr.c] Undefined event: "+c,3)},l={issuePost:function(c){rspkr.log("[rspkr.c] Using POST");document.getElementById("ReadSpeakerPostIframe")||this.createIframe();var a=Math.random(),g=this.createForm(c);c=rspkr.pub.Config.item("general.protocol")+"//"+rspkr.pub.Config.item("general.subdomain")+
"."+rspkr.pub.Config.item("general.domain")+"/enterprise/iframeproxy.php?rsent="+rspkr.pub.Config.item("general.rsent")+"&version="+rspkr.pub.Config.item("general.proxyVersion");g.action=c+"&randid="+a;var b=document.createElement("textarea");1<e.getSelectedText().length?b.setAttribute("name","selectedhtml_base64"):b.setAttribute("name","html_base64");b.innerHTML=e.getPostContent();g.appendChild(b);setTimeout(function(){document.body.appendChild(g);g.submit();document.body.removeChild(g)},0);return c+
"&listen=1&randid="+a},createForm:function(c){var a,g=document.createElement("form");g.target="ReadSpeakerPostIframe";g.method="post";for(var b in c)a=document.createElement("input"),a.setAttribute("name",b),"url"===b?a.setAttribute("value",decodeURIComponent(c[b])):a.setAttribute("value",c[b]),g.appendChild(a);a=document.createElement("input");a.setAttribute("name","output");a.setAttribute("value","audiolink");g.appendChild(a);return g},createIframe:function(){var c=null;if(document.selection)try{c=
document.createElement('<iframe name="ReadSpeakerPostIframe">')}catch(a){c=document.createElement("iframe")}else c=document.createElement("iframe");c.setAttribute("name","ReadSpeakerPostIframe");c.setAttribute("id","ReadSpeakerPostIframe");c.setAttribute("style","display: none; position: absolute;");c.style.display="none";var g=document.getElementsByTagName("body"),b=null;0<g.length&&(b=g.item(0));b&&b.appendChild(c)},removeIframe:function(){document.getElementById("ReadSpeakerPostIframe")&&document.body.removeChild(document.getElementById("ReadSpeakerPostIframe"))}},
n={encode:function(c){newdata=encodeURIComponent(c);var a=0,g=0;for(c=[];a<newdata.length;a++)37!=newdata.charCodeAt(a)?c[g]=newdata.charCodeAt(a):(c[g]=parseInt("0x"+newdata.charAt(a+1)+""+newdata.charAt(a+2)),a+=2),g++;a=c.length;parseInt((a+2)/3);for(var g=new String,b=parseInt(a/3),f,l=a-3*b,a=0;a<3*b;a+=3)f=this.chars(c[a]>>2),g+=f,f=this.chars((c[a]&3)<<4|c[a+1]>>4),g+=f,f=this.chars((c[a+1]&15)<<2|c[a+2]>>6),g+=f,f=this.chars(c[a+2]&63),g+=f;1==l&&(g+=this.chars(c[a]>>2),g+=this.chars((c[a]&
3)<<4),g+="==");2==l&&(g+=this.chars(c[a]>>2),g+=this.chars((c[a]&3)<<4|c[a+1]>>4),g+=this.chars((c[a+1]&15)<<2),g+="=");return g},decode:function(c){for(var a="",g="",b=0,f=0,l="",e=c.length;b<e;)if(-1!=this.value(c[b])){for(var l=c.substring(b,b+4),n=f=0;4>n;n++)"="==l[n]&&f++;for(n=0;n<3-f;n++){0==n?g=this.value(l[0])<<2|(this.value(l[1])&48)>>4:1==n?g=(this.value(l[1])&15)<<4|(this.value(l[2])&60)>>2:2==n&&(g=(this.value(l[2])&3)<<6|this.value(l[3]));var h=g.toString(16);1==h.length&&(h="0"+h);
a+="%"+h}b+=4}else b++;return decodeURIComponent(a)},value:function(c){c=c.charCodeAt(0);return 65<=c&&90>=c?c-65:97<=c&&122>=c?c-97+26:48<=c&&57>=c?c-48+52:43==c?62:47==c?63:-1},chars:function(c){return 26>c?String.fromCharCode(c+65):52>c?String.fromCharCode(c+97-26):62>c?String.fromCharCode(c+48-52):62==c?"+":63==c?"/":String.fromCharCode(0)}};return{meta:a,init:function(){g("onInit",window);b.onInit=[];b.onUIShowPlayer.push(rspkr.Common.data.setDefaultValues);b.onSettingsChanged.push(rspkr.Common.data.setSettingsChanged);
b.onAfterModsLoaded.push(c)},addEvent:function(c,a){b[c].push(a)},base64:n,buildReadSpeakerCall:function(c){return h(c)},data:e,Detect:{init:function(){rspkr.log("[rspkr.c.Detect] Initialized!");var c=navigator.userAgent;e.browser.name=this.searchString(this.dataBrowser)||"Unknown";e.browser.version=this.searchVersion(c)||this.searchVersion(navigator.appVersion)||"Unknown";e.browser.OS=this.searchString(this.dataOS)||"Unknown";"Windows"===e.browser.OS&&-1!==c.indexOf("Windows NT 6.0")&&(this.browserSettings.Firefox.html5Priority=
!1);e.browser.flashVersion=this.getFlashVersion();rspkr.log("[rspkr.c.Detect.init] Flash version: "+e.browser.flashVersion,1);"default"!==rspkr.pub.Config.item("general.syncContainer")?e.browser.syncContainer=rspkr.pub.Config.item("general.syncContainer"):e.browser.syncContainer="rs:span";c=e.browser.name;this.browserSettings.hasOwnProperty(e.browser.name)||(this.browserSettings[c]={});"default"===rspkr.pub.Config.item("general.syncContainer")&&this.browserSettings[c].hasOwnProperty("syncContainer")&&
(e.browser.syncContainer=this.browserSettings[c].syncContainer);this.browserSettings[c].hasOwnProperty("html5Support")?e.browser.html5Support=this.browserSettings[c].html5Support:document.createElement("audio").canPlayType&&(e.browser.html5Support=!0);if(!0===e.browser.html5Support){var a=document.createElement("audio"),g=!1,b=!1;a.canPlayType&&(g=!!a.canPlayType&&""!=a.canPlayType("audio/mpeg"),b=!!a.canPlayType&&""!=a.canPlayType('audio/ogg; codecs="vorbis"'));rspkr.log("Browser can play mp3? "+
a.canPlayType("audio/mpeg"),1);rspkr.log("Browser can play ogg? "+a.canPlayType('audio/ogg; codecs="vorbis"'),1);!0===g?e.browser.html5AudioFormat="mp3":!0===b?e.browser.html5AudioFormat="ogg":e.browser.html5Support=!1;this.browserSettings[c].hasOwnProperty("html5Priority")?e.browser.html5Priority=this.browserSettings[c].priority:e.browser.html5Priority=!0;this.browserSettings[c].hasOwnProperty("audioFormat")&&(e.browser.html5AudioFormat=this.browserSettings[c].audioFormat)}this.browserSettings[c].hasOwnProperty("minver")&&
parseFloat(e.browser.version)<=parseFloat(this.browserSettings[c].minver)&&(e.browser.html5Priority=!1)},browserSettings:{Android:{minver:4},Explorer:{syncContainer:"font"},Firefox:{minver:6},Opera:{html5Support:!1,priority:!1}},getFlashVersion:function(){try{if(document.selection){try{var c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");try{c.AllowScriptAccess="always"}catch(a){return"6,0,0"}}catch(g){}return(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version").replace(/\D+/g,
",").match(/^,?(.+),?$/)[1]}try{if(navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)return(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(b){}}catch(f){try{if(navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)return(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(l){}}return"0,0,0"},
searchString:function(c){for(var a=0;a<c.length;a++){var g=c[a].string,b=c[a].prop;this.versionSearchString=c[a].versionSearch||c[a].identity;if(g){if(-1!=g.indexOf(c[a].subString))return c[a].identity}else if(b)return c[a].identity}},searchVersion:function(c){var a=c.indexOf(this.versionSearchString);if(-1!=a)return parseFloat(c.substring(a+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chromium",identity:"Chromium"},{string:navigator.userAgent,subString:"Chrome",
identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},
{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Android",identity:"Android"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,
subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iOS"},{string:navigator.userAgent,subString:"iPad",identity:"iOS"},{string:navigator.userAgent,subString:"Android",identity:"Android"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]},dispatchEvent:function(c,a,b){g(c,a,b)},post:l,cookie:{create:function(c,a,g,b,f){g=g||rspkr.pub.Config.item("general.cookieLifetime");b=b||rspkr.pub.Config.item("general.cookiePath");f=f||rspkr.pub.Config.item("general.cookieDomain");
if(g){var l=new Date;l.setTime(l.getTime()+g);g="; expires="+l.toGMTString()}else g="";return document.cookie=c+"="+a+g+(b?"; path="+b:"")+(f?"; domain="+f:"")},read:function(c){c+="=";for(var a=document.cookie.split(";"),g=0;g<a.length;g++){for(var b=a[g];" "==b.charAt(0);)b=b.substring(1,b.length);if(0==b.indexOf(c))return b.substring(c.length,b.length)}},readKey:function(c,a){var g=this.read(c),b;if(g)for(var g=g.split("&"),f=0,l=g.length;f<l;f++)if(b=g[f].split("="),b[0]==a)return b[1]},readKeyAll:function(c){c=
this.read(c);var a={},g;if(c){c=c.split("&");for(var b=0,f=c.length;b<f;b++)g=c[b].split("="),a[g[0]]=g[1];return a}},createSub:function(c,a,g,b,f){if("object"!==typeof a)this.create(c,a.toString(),g,b,f);else{var l=[],e;for(e in a)l.push(e+"="+a[e]);return this.create(c,l.join("&"),g,b,f)}},updateKey:function(c,a,g,b,f,l){g=g.toString();for(var e=decodeURIComponent(this.read(c)),n,h={},v=!1,e=e&&"null"!=e&&"undefined"!=e?-1<e.indexOf("=")&&-1==e.indexOf("&")?[e]:e.split("&"):[],y=0,z=e.length;y<
z;y++)n=e[y].split("="),n[0]==a&&(n[1]=g,v=!0),n.length&&n[1].length&&(h[n[0]]=n[1]);!v&&g.length&&(h[a]=g);return this.createSub(c,h,b,f,l)},erase:function(c,a,g){this.create(c,"",-1,a,g)}},css:{getStylesheet:function(c){var a;(a=document.styleSheets[c]||document.getElementById(c))||(a=document.createElement("style"),a.type="text/css",a.id=a.name=c,(document.getElementsByTagName("head")[0]||document.body).appendChild(a),a.addRule||a.sheet||(a=document.styleSheets[c]));return a.sheet||a},rsSheet:function(c){this.rules=
c.rules||c.cssRules;this.del=function(c,a){c.deleteRule?c.deleteRule(a):c.removeRule&&c.removeRule(a)};this.ins=function(c,a,g){$rs.isArray(g)||(g=[g]);if(c.insertRule&&c.cssRules)c.insertRule(a+" {"+g.join(";")+";}",c.cssRules.length);else if(c.addRule)for(var b=0,f=g.length;b<f;b++)c.addRule(a,g[b])}},setRule:function(c,a,g){c=this.getStylesheet(c);var b=new this.rsSheet(c);b.ins(c,a,"string"==typeof g?g.split(";"):g);return b.length},removeRule:function(c,a){var g=this.getStylesheet(c),b=new this.rsSheet(g),
f=[];if(b.rules){for(var l=0,e=b.rules.length;l<e;l++)b.rules[l].selectorText==a&&f.push(l);for(;f.length;)b.del(g,f.pop());return f}return b},replaceRule:function(c,a,g){this.removeRule(c,a);this.setRule(c,a,g)}},converter:f,findFirstRSButton:function(c){c=c||document.body;c=c.getElementsByTagName("a");for(var a=0,g=c.length;a<g;a++)if($rs.hasClass(c[a],"rsbtn_play")||c[a].href&&-1!==c[a].href.indexOf(rspkr.pub.Config.item("general.domain")+"/cgi-bin/"+rspkr.pub.Config.item("general.rsent"))||c[a].href&&
/customerid=/i.test(c[a].href)&&/lang=/i.test(c[a].href)&&/(readid|readclass)/i.test(c[a].href))return c[a];return!1},decodeEntities:function(c){var a=document.createElement("p");a.innerHTML=c;return a.textContent||a.innerText},e:b,createShortcuts:function(){var c=window.ReadSpeaker;c.Common&&(c.c=c.Common);c.c&&(c.evt=c.c.addEvent,c.devt=c.c.dispatchEvent);c.c&&c.c.Settings&&(c.c.s=c.c.Settings);c.c.s&&(c.st=c.c.s);c.lib&&(c.l=c.lib);c.l&&c.lib.Facade&&(c.l.f=c.lib.Facade);c.l&&c.l.f&&c.l.f.adapter&&
(c.l.f.a=c.l.f.adapter);c.modmap&&(c.m=c.modmap);c.pub&&c.pub.Config&&(c.pub.c=c.pub.Config);c.pub.c&&(c.cfg=c.pub.c);c.PlayerAPI&&(c.pl=c.PlayerAPI);c.HL&&(c.hl=c.HL);c.ui&&(c.u=c.ui)}}}();rspkr.lib||(rspkr.lib={});
rspkr.lib.Facade=function(a){var b=function(c,a,b){c=String(c);b=String(b);a="="==a?"==":a;c=c.split(".");b=b.split(".");for(var f=Math.max(c.length,b.length),e,h,p=0,q=0;q<f&&!p;q++)e=parseInt(c[q],10)||0,h=parseInt(b[q],10)||0,e<h&&(p=1),e>h&&(p=-1);return eval("0"+a+p)},f=[{name:"jquery",minver:"1.4",check:function(){if("function"==typeof jQuery){if("explorer"===rspkr.Common.data.browser.name.toLowerCase()&&9>rspkr.Common.data.browser.version&&b(jQuery.fn.jquery,"<",2))return!1;if(b(jQuery.fn.jquery,
">=",this.minver))return!0}return!1}}],e="",h={store:[],push:function(c,a,b){this.store[c]||(this.store[c]=[]);this.store[c][a]||(this.store[c][a]=[]);this.store[c][a].push(b);return this.store.length},pop:function(c,a,b){var f;if(this.store[c]&&this.store[c][a]){f=this.store[c][a];for(var e=f.length-1;-1<e;e--)f[e]==b&&this.store[c][a].splice(e,1);return this.store[c][a].length}return 0},dispatch:function(c,a){var b=$rs.convertEvent(c,a),f=$rs.getAttr(b.target.window?document.documentElement:b.target,
"data-rsevent-id");if(f){for(var e=!0,f=h.store[f][b.type],m=0,p=f.length;m<p;m++)"function"==typeof f[m]&&(f[m].apply(b.target,[b])||(e=!1));return e}}};return{init:function(){if(rspkr&&rspkr.params&&rspkr.params.forceRSLib&&"1"===rspkr.params.forceRSLib)e="RSLib";else{for(idx in f)if(f[idx]&&f[idx].check&&f[idx].check()){e=f[idx].name;break}e.length||(e="RSLib")}},currentLib:function(){return e},setLib:function(c){e=c},eq:h,adapterInit:function(c){a.$rs=c}}}(window);
ReadSpeaker.lib.Facade.RSEvent=function(){};
ReadSpeaker.modmap={products:{all:[["Common.Settings","text/javascript",["Common.Settings"]]],custom:function(){var a=[];a.push(["Custom","text/javascript"]);return a},dr:function(){var a=[];a.push(["DocReader.AutoAdd","text/javascript"]);return a},expl:function(){var a=this.all;a.push(["PlayerAPI","text/javascript"],["XP","text/javascript"],["ui","text/javascript",["ui","ui.Lightbox","ui.Slider"]]);return a},embhl:function(){var a=this.all;a.push(["PlayerAPI","text/javascript"],["HL","text/javascript"],
["ui","text/javascript",["ui","ui.Lightbox","ui.Slider"]]);return a}}};ReadSpeaker.pub||(ReadSpeaker.pub={});
ReadSpeaker.pub.Config=function(){var a={extraMods:[["enlargeHL/ReadSpeaker.enlargeHL.js"],["enlargeHL/ReadSpeaker.enlargeHL.css"]],general:{cookieLifetime:36E7,cookieName:"ReadSpeakerSettings",cookieDomain:null,cookiePath:"/",defaultSpeedValue:100,domain:"readspeaker.com",popupCloseTime:2E3,protocol:document.location.protocol||"http:",proxyVersion:"2",region:"eu",rscall:null,rsent:"rsent",subdomain:"app",syncContainer:"default",selectionEngine:"old",useCompactPopupButton:!0,useCloudService:!0,usePost:!1,
sentOnlyLang:["ja_jp","zh_cn"],popupHref:"",parseMathJax:!1,enableSkipAlways:!1},survey:{allowed:!1,url:function(){return a.general.protocol+"//sf1-eu.readspeaker.com/survey/survey.php"},cookieName:"rspkrsurvey",cookieLifeTime:15552E6},settings:{hltoggle:"hlon",hl:"wordsent",hlicon:"iconon",hlspeed:"medium",hlword:"#a4cbff",hlsent:"#beffd6",hlscroll:"scrolloff",hltext:"#000000"},defaultsettings:{hltoggle:"hlon",hl:"wordsent",hlicon:"iconon",hlspeed:"medium",hlword:"#a4cbff",hlsent:"#beffd6",hlscroll:"scrolloff",
hltext:"#000000"},phrases:{en_us:{closeplayer:"Close Player",fast:"Fast",hide:"Hide",highlightingoptions:"Highlighting options",listen:"Listen",listentoselectedtext:"Listen to selected text",medium:"Medium",nohighlighting:"No highlighting",pause:"Pause",playerwidth:"310",play:"Play",popupbutton:"Pop-up button",sentonly:"Sentence only",settings:"Settings",show:"Show",slow:"Slow",speechenabled:'Speech-enabled by <a href="http://www.readspeaker.com/?ref='+encodeURIComponent(document.location.href)+'" target="_blank">ReadSpeaker</a>',
newwindow:"New Window",speed:"Speed",stop:"Stop",volume:"Volume",wordonly:"Word only",wordsent:"Word and sentence",nosound:"No sound? Click here",download:"Download mp3",highlighting:"Highlighting",wordcolor:"Word color",sentcolor:"Sentence color",textcolor:"Text color",lightgreen:"Light green",lightblue:"Light blue",lightyellow:"Light yellow",white:"White",black:"Black",darkred:"Dark red",darkgreen:"Dark green",darkblue:"Dark blue",yellow:"Yellow",underline:"Underline",none:"None",on:"On",off:"Off",
autoscroll:"Automatic scrolling",general:"General",reading:"Reading",showhighlighting:"Text highlighting",help:"Help",hltoggleinfo:"Enables synchronized highlighting of the text that is currently being read.",hloptionsinfo:"Controls the behavior of synchronized highlighting.",hlwordinfo:"Sets the style or color of highlighted words.",hlsentinfo:"Sets the style or color of highlighted sentences.",hltextinfo:"Sets the foreground color of the highlighted text.",hlspeedinfo:"Controls the reading speed.",
hlscrollinfo:"Toggles automatic scrolling. When switched on, the page will automatically scroll to follow the highlighted text.",hliconinfo:"Controls whether or not a pop-up button should be displayed when text is selected.",close:"Close",sliderseek:"Seek bar",slidervolume:"Volume bar",slidervolumedesc:"Change volume",touheading:"Terms of use for downloaded audio",toubody:"<p>Thank you for using the ReadSpeaker service.</p><p>The audio file you are about to download can be used for personal use only. This means that you are not allowed to distribute this file to anyone else, or use it for any other purpose than to listen to it yourself.</p>",
touaccept:"Agree and Download file",toudecline:"Cancel",loaderror:"An error has occurred, try again",hlrestore:"Restore default settings",hlrestoreinfo:"Restore all settings to their original defaults.",hlrestore:"Restore default settings",hlrestoreinfo:"Restore all settings to their original defaults.",red:"Red"},en_uk:function(){return this.en_us}},ui:{rsbtnClass:"rsbtn",progressHandleClass:"rsbtn_progress_handle rsimg",progressDir:"h",volumeHandleClass:"rsbtn_volume_handle rsimg",volumeDir:"v",
autoscrollOffset:0,usePin:!1,settingsListenButton:!0,listenBtn:'<div id="readspeaker_button_settings" class="rs_skip rsbtn rs_preserve readspeaker_button_settings">;\t<a class="rsbtn_play" href="">;\t\t<span class="rsbtn_left rsimg rspart">;\t\t\t<span class="rsbtn_text">;\t\t\t\t<span>rsLISTENrs</span>;\t\t\t</span>;\t\t</span>;\t\t<span class="rsbtn_right rsimg rsplay rspart"></span>;\t</a>;</div>'.split(";"),player:'<a class="rsbtn_pause rsimg rspart" href="javascript:void(0);" title="Pause" role="button"><span class="rsbtn_btnlabel">Pause</span></a>,<a class="rsbtn_stop rsimg rspart" href="javascript:void(0);" title="Stop" role="button"><span class="rsbtn_btnlabel">Stop</span></a>,<span class="rsbtn_player rsimg rspart">,\t<span class="rsbtn_progress_container rsimg rsplaypart rsloading">,\t\t<span class="rsbtn_progress_played rsimg"></span>,\t</span>\t,\t<a class="rsbtn_volume rsimg rsplaypart" href="javascript:void(0);" title="Volume" role="button"><span class="rsbtn_btnlabel">Volume</span></a>,\t<span class="rsbtn_volume_container rsimg">,\t\t<span class="rsbtn_volume_slider"></span>,\t</span>,\t<a class="rsbtn_settings rsimg rsplaypart" href="javascript:void(0);" title="Settings" role="button"><span class="rsbtn_btnlabel">Settings</span></a>,\t<a class="rsbtn_dl rsimg rsplaypart" href="javascript:void(0);" title="Download MP3" role="button"><span class="rsbtn_btnlabel">Download mp3</span></a>,\t<a class="rsbtn_pin turnedOff rsplaypart" href="javascript:void(0);" title="Pin player" role="button"><span class="rsbtn_btnlabel">Pin player</span></a>,</span>,<a class="rsbtn_closer rsimg rspart" href="javascript:void(0);" title="Close Player" role="button"><span class="rsbtn_btnlabel">Close</span></a>,<span class="rsbtn_powered rsimg"><span class="rsbtn_btnlabel">Speech-enabled by ReadSpeaker</span></span>'.split(","),
popupbutton:['<a class="rsbtn_play" accesskey="L" title="" href="">','<span class="rsbtn_left rsimg rspart"><span class="rsbtn_text"><span></span></span></span>','<span class="rsbtn_right rsimg rsplay rspart"></span>',"</a>"],popupplayer:function(){return this.player},settings:{form:'<div id="rsform_wrapper" dir="ltr">;\t<h1 class="rs_preserve">rsSETTINGS_HEADINGrs</h1>;\trsLISTEN_BUTTONrs;\t<form id="rssettings_form" class="rsform rs_preserve">;\trsSECTIONS_STARTrs;\trsSECTIONSrs;\trsSECTIONS_ENDrs;\t</form>;</div>'.split(";"),
formsection:['<fieldset id="rsSECTION_IDrs" class="rsform-section">',"\t<legend>rsSECTION_HEADINGrs</legend>","\trsSECTION_ROWSrs","</fieldset>"],formrow:['\t<div class="rsform-row rsCONTROL_CLASSESrs" id="rscontrol_rsCONTROL_IDrs" data-rsform-type="rsCONTROL_TYPErs">',"\t\trsCONTROLrs","\t</div>"],formbuttons:['\t\t<a class="rssettings-button-close rsdialog-button" href="javascript:void(0);" title="rsSETTINGS_BUTTON_CLOSErs" role="button">rsSETTINGS_BUTTON_CLOSErs</a>']},overlay:{overlayStyles:"position: absolute;top: 0;left: 0;bottom: 0;width: 100%;background-color: #000;opacity: 0.7;filter: alpha(opacity=70);z-index: 1001".split(";"),
contentStyles:"position: absolute;width: 500px;height: 500px;background-color: #eee;z-index: 10002;border-radius: 10px;-moz-box-shadow: 0px 0px 20px #000;-webkit-box-shadow: 0px 0px 20px #000;box-shadow: 0px 0px 20px #000".split(";"),contentTemplate:'<div id="rslightbox_logo" class="rsimg"></div>,<div id="rslightbox_content" style="overflow:auto;"></div>,<div id="rslightbox_toolbar">,\t<a id="rslightbox_closer" href="javascript: void(0);" title="rsLIGHTBOX_CLOSE_LABELrs" role="button"><span class="rsbtn_btnlabel">rsLIGHTBOX_CLOSE_LABELrs</span></a>,</div>,<div id="rslightbox_buttons" class="rsform-buttons"></div>'.split(",")},
dldialog:'<div id="rsdl_container">;\t<div class="rsdl_textwrapper">;\t\t<h2>rsTERMS_OF_USE_HEADINGrs</h2>;\t\trsTERMS_OF_USE_BODYrs;\t</div>;</div>'.split(";"),dlbuttons:['\t\t<a id="rsdl_button_accept" class="rsdialog-button" href="javascript:void(0);" title="rsTERMS_OF_USE_ACCEPTrs" role="button">rsTERMS_OF_USE_ACCEPTrs</a>','\t\t<a id="rsdl_button_decline" class="rsdialog-button" href="javascript:void(0);" title="rsTERMS_OF_USE_DECLINErs" role="button">rsTERMS_OF_USE_DECLINErs</a>'],survey:{buttons:['\t\t<a id="rssurvey_button_close" class="rsdialog-button" href="javascript:void(0);" title="rsSURVEY_BUTTON_CLOSErs" role="button">rsSURVEY_BUTTON_CLOSErs</a>']}},
flash:{allowScriptAccess:"always",flashSrc:function(){return a.general.useCloudService&&-1===a.general.protocol.indexOf("https")?a.general.protocol+"//f1."+a.general.region+".readspeaker.com/flash/readspeaker_1x1.swf":a.general.protocol+"//sf1-"+a.general.region+".readspeaker.com/flash/readspeaker_1x1.swf"}},cb:{ui:{open:function(){rspkr.log("conf.cb.ui.open: "+this)},play:function(){rspkr.log("conf.cb.ui.play")},pause:function(){rspkr.log("conf.cb.ui.pause")},stop:function(){rspkr.log("conf.cb.ui.stop")},
beforeclose:function(){rspkr.log("conf.cb.ui.beforeclose")},close:function(){rspkr.log("conf.cb.ui.close")},settingsopened:function(){rspkr.log(this)},volumechanged:function(a){rspkr.log("conf.cb.ui.volumechanged: "+a+"%")},timeupdated:function(a,c){},progresschanged:function(a){0<a&&0==a%10&&rspkr.log("conf.cb.ui.progresschanged: "+a+"%")}}}},b={reading:{phrase:"ph_reading",items:{hlspeed:{phrase:"ph_speed",type:"radio",info:"ph_hlspeedinfo",options:[{value:"slow",phrase:"ph_slow"},{value:"medium",
phrase:"ph_medium"},{value:"fast",phrase:"ph_fast"}]}}},highlighting:{phrase:"ph_highlighting",items:{hltoggle:{phrase:"ph_showhighlighting",type:"radio",info:"ph_hltoggleinfo",options:[{value:"hlon",phrase:"ph_on"},{value:"hloff",phrase:"ph_off",dims:["hl","hlword","hlsent","hltext"]}]},hl:{phrase:"ph_highlightingoptions",type:"select",info:"ph_hloptionsinfo",options:[{value:"wordsent",phrase:"ph_wordsent"},{value:"sent",phrase:"ph_sentonly",dims:["hlword"]},{value:"word",phrase:"ph_wordonly",dims:["hlsent"]},
{value:"none",phrase:"ph_nohighlighting",dims:["hlword","hlsent","hltext"]}]},hlword:{phrase:"ph_wordcolor",type:"colorpicker",info:"ph_hlwordinfo",options:[{value:"#beffd6",phrase:"ph_lightgreen"},{value:"#a4cbff",phrase:"ph_lightblue"},{value:"#ffffcc",phrase:"ph_lightyellow"},{value:"#ffffff",phrase:"ph_white"},{value:"#000000",phrase:"ph_black"},{value:"#770000",phrase:"ph_darkred"},{value:"#ED0000",phrase:"ph_red"},{value:"underline",phrase:"ph_underline"},{value:"none",phrase:"ph_none"}]},hlsent:{phrase:"ph_sentcolor",
type:"colorpicker",info:"ph_hlsentinfo",options:[{value:"#beffd6",phrase:"ph_lightgreen"},{value:"#a4cbff",phrase:"ph_lightblue"},{value:"#ffffcc",phrase:"ph_lightyellow"},{value:"#ffffff",phrase:"ph_white"},{value:"#000000",phrase:"ph_black"},{value:"#770000",phrase:"ph_darkred"},{value:"#ED0000",phrase:"ph_red"},{value:"underline",phrase:"ph_underline"},{value:"none",phrase:"ph_none"}]},hltext:{phrase:"ph_textcolor",type:"colorpicker",info:"ph_hltextinfo",options:[{value:"#003f00",phrase:"ph_darkgreen"},
{value:"#0000aa",phrase:"ph_darkblue"},{value:"#ffff00",phrase:"ph_yellow"},{value:"#ffffff",phrase:"ph_white"},{value:"#000000",phrase:"ph_black"},{value:"#a4cbff",phrase:"ph_lightblue"}]}}},general:{phrase:"ph_general",items:{hlscroll:{phrase:"ph_autoscroll",type:"radio",info:"ph_hlscrollinfo",options:[{value:"scrollon",phrase:"ph_on"},{value:"scrolloff",phrase:"ph_off"}]},hlicon:{phrase:"ph_popupbutton",type:"radio",info:"ph_hliconinfo",options:[{value:"iconon",phrase:"ph_on"},{value:"iconoff",
phrase:"ph_off"}]}}},restore:{phrase:"ph_hlrestore",items:{hlrestore:{phrase:"ph_hlrestoreinfo",type:"restore"}}}},f=function(a,c,g,b){if(void 0!==a[c[g]])return g<c.length-1?f(a[c[g]],c,g+1,b):void 0===b?a[c[g]]:a[c[g]]=b;if(void 0!==b){var e;if(g<c.length-1)for(e=c.length;g<e-1;g++)a[c[g]]={},a=a[c[g]];return a[c[g]]=b}},e=function(b,c){c=c||a;for(var g in b)b.hasOwnProperty(g)&&(void 0!==c[g]?$rs.isArray(c[g])?c[g]=b[g]:"object"==typeof b[g]&&0<Object.size(b[g])&&!$rs.isArray(b[g])?e(b[g],c[g]):
c[g]=b[g]:c[g]=b[g])};return{meta:{revision:"2887"},defaultsettings:a.defaultsettings,init:function(){rspkr.log("[rspkr.cfg] Initialized!")},item:function(b,c,g){if(void 0===c){if("."==b)c=a;else if(c=b.split("."),b=f(a,c,0),"function"!=typeof b||g)c=b;else{var e=a;g=a;if(c.length){c.splice(c.length-1,1);for(var e=0,n=c.length;e<n;e++)if(g[c[e]])g=g[c[e]];else break;e=g}c=b.apply(e)}return c}b=b.split(".");return f(a,b,0,c)},getPhrase:function(a,c,g){g=g||"en_us";c=(c||rspkr.c.data.params.lang||g).toLowerCase();
var b=this.item("phrases."+c);if(b&&b[a])return this.item("phrases."+c)[a];if(this.item("phrases."+g+"."+a))return this.item("phrases."+g+"."+a)},getPhrases:function(a,c){c=c||"en_us";var g;if((g=this.item("phrases."+(a||c).toLowerCase()))||(g=this.item("phrases."+c)))return g},extendPhrases:function(a){for(var c in a)this.item("phrases."+c)||delete a[c];e({phrases:a})},getSettingsConf:function(){return b},isSentOnly:function(a){for(var c=this.item("general.sentOnlyLang")||[],g=0,b=c.length;g<b;g++)if(c[g]==
a.toLowerCase())return!0;return!1},setup:function(){"object"==typeof window.rsConf&&e(window.rsConf);rspkr.devt("onConfigSetup",window)},execCallback:function(a,c,g){"function"==typeof this.item(a,void 0,!0)&&this.item(a,void 0,!0).apply(c,$rs.isArray(g)?g:[])},c:a}}();rspkr.initialize.core=function(){var a=["Common","lib.Facade","modmap"];i=0;for(j=a.length;i<j;i++)rspkr.initialize.execInit(a[i]);rspkr.Common.addEvent("onModsLoaded",rspkr.pub.Config.setup);return!0}();
ReadSpeaker.lib.Facade.adapter||(ReadSpeaker.lib.Facade.adapter={});
ReadSpeaker.lib.Facade.adapter.jquery=function(){var a={_formatRet:function(a){return a.jquery&&a.length?1==a.length?a[0].jquery?a[0][0]:a[0]:jQuery(a).toArray():[]},get:function(a){return"#"===a?[]:document.getElementById(a)||this._formatRet(jQuery(a))},findIn:function(a,b){var h=a.jquery?a:jQuery(a);return this._formatRet(h.find(b))},closest:function(a,b){return this._formatRet(jQuery(a).closest(b))},getAttr:function(a,b){return jQuery(a).attr(b)},setAttr:function(a,b,h){jQuery(a).attr(b,h)},regEvent:function(a,
e,h){a===window&&(a=document.documentElement);var c=jQuery(a).attr("data-rsevent-id")||"rs_"+Math.round(1E6*Math.random());jQuery(a).attr("data-rsevent-id",c);b.push(c,e,h);if(!(b.store[c]&&b.store[c][e]&&1<b.store[c][e].length))if(jQuery.isFunction(jQuery.fn.on))jQuery(a).on(e,b.dispatch);else jQuery(a).bind(e,b.dispatch)},unregEvent:function(a,e,h){a===window&&(a=document.documentElement);var c=jQuery(a).attr("data-rsevent-id");h?b.pop(c,e,h)||(jQuery.isFunction(jQuery.fn.off)?jQuery(a).off(e,b.dispatch):
jQuery(a).unbind(e,b.dispatch)):jQuery.isFunction(jQuery.fn.off)?jQuery(a).off(e):jQuery(a).unbind(e)},fireEvent:function(a,b){a===window&&(a=document.documentElement);jQuery(a).trigger(b)},width:function(a){return jQuery(a).width()},height:function(a){return jQuery(a).height()},innerWidth:function(a){return jQuery(a).innerWidth()},innerHeight:function(a){return jQuery(a).innerHeight()},outerWidth:function(a,b){return jQuery(a).outerWidth(b||!1)},outerHeight:function(a,b){return jQuery(a).outerHeight(b||
!1)},offsetParent:function(a){return jQuery(a).offsetParent()[0]},offset:function(a,b){return void 0!==b?jQuery(a).offset(b):jQuery(a).offset()},absOffset:function(a){a=jQuery(a)[0];var b=document.body,h=document.defaultView||window,c=document.documentElement,g=document.createElement("div");g.style.paddingLeft=g.style.width="1px";b.appendChild(g);var l=2==g.offsetWidth;b.removeChild(g);g=a.getBoundingClientRect();return{top:g.top+(h.pageYOffset||l&&c.scrollTop||b.scrollTop)-(c.clientTop||b.clientTop||
0),left:g.left+(h.pageXOffset||l&&c.scrollLeft||b.scrollLeft)-(c.clientLeft||b.clientLeft||0)}},position:function(a){return jQuery(a).position()},scrollLeft:function(a,b){return void 0!==b?jQuery(a).scrollLeft(b):jQuery(a).scrollLeft()},scrollTop:function(a,b){return void 0!==b?jQuery(a).scrollTop(b):jQuery(a).scrollTop()},addClass:function(a,b){jQuery(a).addClass(b)},removeClass:function(a,b){jQuery(a).removeClass(b)},hasClass:function(a,b){return jQuery(a).hasClass(b)},css:function(a,b,h){if(h)jQuery(a).css(b,
h);else return jQuery(a).css(b)},isVisible:function(a){return jQuery(a).is(":visible")},addStyleRule:function(a,b,h){h="string"==typeof h?document.styleSheets[h]||document.getElementById(h):h;h.addRule?h.addRule(a,b):h.sheet.insertRule&&h.sheet.insertRule(a+" {"+b+"}",h.sheet.cssRules.length)},isArray:function(a){return jQuery.isArray(a)},rsid:function(a){if(""==this.getAttr(a,"data-rsid")||void 0==this.getAttr(a,"data-rsid")){var b=ReadSpeaker.rsidCount++;this.setAttr(a,"data-rsid",b)}return this.getAttr(a,
"data-rsid")},detach:function(a){return jQuery(a).detach()[0]},convertEvent:function(a){var b=new ReadSpeaker.lib.Facade.RSEvent;b.pageX=a.pageX;b.pageY=a.pageY;b.screenX=a.screenX;b.screenY=a.screenY;b.clientX=a.clientX;b.clientY=a.clientY;b.target=a.currentTarget;b.type=a.type;b.keyCode=a.keyCode;b.targetTouches=a.targetTouches;b.originalEvent=a.originalEvent;return b},clone:function(a,b,h){return this._formatRet(jQuery(a).clone(b,h))},remove:function(a){return jQuery(elm).remove()},replaceWith:function(a,
b){return _formatRet(jQuery(a).replaceWith(b))},focus:function(a,b){void 0!==b?this.focusIn(a,b):jQuery(a).focus()},focusIn:function(a,b){jQuery(a).focusin(b)},focusOut:function(a,b){jQuery(a).focusout(b)}},b=null;return{meta:{revision:"2887"},init:function(){b=rspkr.lib.Facade.eq;rspkr.lib.Facade.adapterInit(a);rspkr.log("[rspkr.l.f] jQuery adapter initialized.");rspkr.Common.dispatchEvent("onAdapterReady")}}}();
rspkr.initialize.lib=function(){var a=rspkr.lib.Facade.currentLib().toLowerCase(),a="rslib"===a?"lib.RSLib":rspkr.lib.Facade.adapter&&rspkr.lib.Facade.adapter[a]?"lib.Facade.adapter."+a:"lib.RSLib";"lib.RSLib"===a&&rspkr.lib.Facade.setLib("rslib");rspkr.initialize.execInit(a);return!0}();
ReadSpeaker.Common.Settings=function(){var a={form:{key:"data-rsform-key",prev:"data-rsform-prev",valyes:"data-rsform-trueval",valno:"data-rsform-falseval"}},b={},f=function(c){return rspkr.Common.cookie.readKey(rspkr.pub.Config.item("general.cookieName"),c)||rspkr.pub.Config.item("settings."+c)},e=function(c,a){var b=f(c);if(a!=b){var n=rspkr.c.cookie.updateKey(rspkr.cfg.item("general.cookieName"),c,a);rspkr.devt("onSettingsChanged",window,[c,a,b]);return n}return null},h={controls:{xp:function(c){return rspkr.st.r().expandPhrase(c)},
helpButton:'<img src="'+rspkr.baseUrl+'img/help.png" alt="" border="0" />',select:function(c,b,l,n){var f=[],e="hl"!==c?!1:rspkr.cfg.isSentOnly&&rspkr.cfg.isSentOnly(rspkr.c.data.params.lang);f.push('<label for="',n,'">',this.xp(b.phrase),"</label>");f.push('<select id="',n,'" name="',n,'" ',a.form.prev,'="',l,'" ',a.form.key,'="',c,'">');for(var p=0,h=b.options.length;p<h;p++)if("hl"!==c||!e||/\bsent|none/i.test(b.options[p].value))"hl"===c&&e&&"sent"===b.options[p].value&&"none"!==l&&(l="sent"),
f.push('<option value="',b.options[p].value,'"',l==b.options[p].value?' selected="selected"':"",b.options[p].dims?' data-rsform-dims="'+b.options[p].dims.join(",")+'"':"",b.options[p].hides?' data-rsform-hides="'+b.options[p].hides.join(",")+'"':"",">",this.xp(b.options[p].phrase),"</option>");f.push("</select>");b.info&&(f.push('<button type="button" id="rstoggle_',n,'" class="rsform-info-toggle" data-rsform-toggles="rscontainer_',n,'" title="',this.xp("ph_help"),": ",this.xp(b.phrase),'">'+this.helpButton+
"</button>"),f.push("&rlm;"),f.push('<div id="rscontainer_',n,'" class="rsform-info-container" aria-live="polite">',this.xp(b.info),"</div>"),rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.info,context:rspkr.st.r().handlers,params:[n]}));rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.select,context:rspkr.st.r().handlers,params:[n]});return f.join("")},checkbox:function(c,b,l,n){var f=l==b.options.truevalue;rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.checkbox,context:rspkr.st.r().handlers,
params:[n]});return['<label for="'+n+'">',this.xp(b.phrase),'</label><input type="checkbox" id="',n,'" name="',n,'"',f?' checked="checked"':"",a.form.valyes,'="',b.options.truevalue,'" ',a.form.valno,'="',b.options.falsevalue,'" ',a.form.prev,'="',l,'" ',a.form.key,'="',c,'" />'].join("")},radio:function(c,b,l,n){var f=[];f.push('<fieldset class="rsform-radio-label" aria-level="2">');f.push("<legend>",this.xp(b.phrase));b.info&&(f.push('<button id="rstoggle_',n,'" type="button" class="rsform-info-toggle" data-rsform-toggles="rscontainer_',
n,'" title="',this.xp("ph_help"),": ",this.xp(b.phrase),'">'+this.helpButton+"</button>"),f.push("&rlm;"));f.push("</legend>");for(var e=0,p=b.options.length;e<p;e++)f.push('<input type="radio" id="',n,"_",e,'" name="',n,'" title="',this.xp(b.phrase),": ",this.xp(b.options[e].phrase),'" value="',b.options[e].value,'"'),f.push(" ",a.form.prev,'="',l,'" ',a.form.key,'="',c,'"'),f.push(l==b.options[e].value?' checked="checked"':""),b.options[e].dims&&f.push(' data-rsform-dims="',b.options[e].dims.join(","),
'"'),f.push(" />"),f.push("&lrm;"),f.push('<label for="',n,"_",e,'">',this.xp(b.options[e].phrase),"</label>");b.info&&(f.push('<div id="rscontainer_',n,'" class="rsform-info-container" aria-live="polite">',this.xp(b.info),"</div>"),rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.info,context:rspkr.st.r().handlers,params:[n]}));f.push("</fieldset>");rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.radio,context:rspkr.st.r().handlers,params:[n,e]});return f.join("")},info:function(c,
a){return['<div class="rsform-infotext">',this.xp(a.phrase),"</div>"].join("")},slider_h:function(c,g,l,f){rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.slider_h,context:rspkr.st.r().handlers,params:[g,f,l]});b[f]=g;return['<span class="rsform-slider-label">',this.xp(g.phrase),'</span><div id="',f,'" class="rsform-slider rsimg" ',a.form.key,'="',c,'" ',a.form.prev,'="',l,'"></div>'].join("")},colorpicker:function(c,b,l,f){var e=[];e.push('<fieldset class="rsform-colorlist-label" aria-level="2">');
e.push("<legend>",this.xp(b.phrase));b.info&&(e.push('<button type="button" id="rstoggle_',f,'" class="rsform-info-toggle" data-rsform-toggles="rscontainer_',f,'" title="',this.xp("ph_help"),": ",this.xp(b.phrase),'">'+this.helpButton+"</button>"),e.push("&rlm;"));e.push("</legend>");e.push('<ul id="',f,'" class="rsform-colorlist" ',a.form.prev,'="',l,'" ',a.form.key,'="',c,'">');c=0;for(var h=b.options.length;c<h;c++){e.push("<li",l==b.options[c].value?' class="rsform-colorlist-active"':"",">");
e.push('<a href="javascript: void(0);"');e.push(' title="'+this.xp(b.phrase)+": "+this.xp(b.options[c].phrase)+'"');e.push(' data-rsform-value="',b.options[c].value,'"');if("underline"==b.options[c].value||"none"==b.options[c].value)e.push(' class="'),"underline"==b.options[c].value&&e.push("rsform-colorlist-style-underline "),"none"==b.options[c].value&&e.push("rsform-colorlist-style-none "),e.push('"');e.push(' role="button"');e.push('><span class="rsform-colorlist-box"');"#"==b.options[c].value.substr(0,
1)&&e.push(' style="background: ',b.options[c].value,';"');e.push("></span>");e.push('<span class="rsform-colorlist-label');"underline"==b.options[c].value?e.push('" style="text-decoration: underline;'):/#/.test(b.options[c].value)&&e.push(" rsform-colorlist-style-color");e.push('">',this.xp(b.options[c].phrase),"</span></a>");e.push("</li>")}e.push("</ul>");e.push('<div style="clear: both;"></div>');b.info&&(e.push('<div id="rscontainer_',f,'" class="rsform-info-container" aria-live="polite">',this.xp(b.info),
"</div>"),rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.info,context:rspkr.st.r().handlers,params:[f]}));e.push("</fieldset>");rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.colorpicker,context:rspkr.st.r().handlers,params:[f]});return e.join("")},restore:function(c,a,b,e){rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.restore,context:rspkr.st.r().handlers,params:[e]});return["<div>",this.xp(a.phrase),'</div><input type="button" id="',e,'" value="',this.xp("ph_"+c),
'" class="rsform-button" role="button"></input>'].join("")}},handlers:{info:function(c){$rs.regEvent($rs.get("#rstoggle_"+c),"click",this.changed.info)},select:function(c){$rs.regEvent($rs.get("#"+c),"change",this.changed.select)},checkbox:function(c){$rs.regEvent($rs.get("#"+c),"click",this.changed.checkbox)},radio:function(c,a){for(var b=0;b<a;b++)$rs.regEvent($rs.get("#"+c+"_"+b),"click",this.changed.radio)},slider_h:function(c,a,b){var e=new ReadSpeaker.ui.Slider,f={};if(c.options)for(var h in c.options)c.options.hasOwnProperty(h)&&
(f[h]=rspkr.st.r().expandPhrase(c.options[h]));f.initval=c.converter?c.converter(b):b||0;f.start=function(){};f.drop=this.changed.slider_h;e.init($rs.get("#"+a),f)},colorpicker:function(c){$rs.regEvent("#"+c+" li a","click",this.changed.colorpicker);$rs.css($rs.get("#"+c),"display","block")},restore:function(c){$rs.regEvent("#"+c,"click",function(){if(rs.cfg.defaultsettings){for(var c in rs.cfg.defaultsettings)if(rs.cfg.defaultsettings.hasOwnProperty(c)){var a=rs.cfg.defaultsettings[c];rspkr.st.r().handlers.updateSetting(c,
a);var b=$rs.get("input[value="+a+"]");if($rs.isArray(b))if(b=$rs.get("select[data-rsform-key="+c+"]"),$rs.isArray(b)){if(b=$rs.get("ul[data-rsform-key="+c+"]"),!$rs.isArray(b)){var e=$rs.findIn(b,".rsform-colorlist-active");$rs.removeClass(e,"rsform-colorlist-active");a=$rs.findIn(b,"a[data-rsform-value="+a+"]").parentNode;$rs.addClass(a,"rsform-colorlist-active")}}else b.value=a;else b.checked=!0}rspkr.Common.Settings.r().handlers.changed.afterdim()}})},changed:{dimmed:[],hidden:[],disable:function(c,
a){a=a||"dimmed";var b=$rs.findIn(c,"input, select, textarea, ul.rsform-colorlist");$rs.addClass(c,a);if("dimmed"==a)for(var e=0,f=b.length;e<f;e++)"ul"!=b[e].tagName.toLowerCase()&&(b[e].disabled=!0)},enable:function(a,b){b=b||"dimmed";var e=$rs.findIn(a,"input, select, textarea");$rs.removeClass(a,b);if("dimmed"==b)for(var f=0,k=e.length;f<k;f++)e[f].disabled=!1},add:function(a,b,e,f){a[b]||(a[b]=[]);for(var k=0,h=e.length;k<h;k++)this.disable($rs.get("#rscontrol_"+e[k]),f),a[b].push($rs.get("#rscontrol_"+
e[k]))},release:function(a,b,e){if(a[b]){for(var f=0,k=a[b].length;f<k;f++)this.enable(a[b][f],e);a[b]=[]}},dim:function(a,b){this.undim(a);this.add(this.dimmed,a,$rs.isArray(b)?b:[b],"dimmed")},undim:function(a){this.release(this.dimmed,a,"dimmed")},afterdim:function(){for(var a=$rs.get("#rslightbox_content .rsform-row"),b,e=0,f=a.length;e<f;e++)b=$rs.getAttr(a[e],"data-rsform-type"),b=this.dimmees[b]?this.dimmees[b](a[e]):null,"string"==typeof b?this.dim(a[e].id.replace("rscontrol_",""),b.split(",")):
1===b&&this.undim(a[e].id.replace("rscontrol_",""))},addButtonEvents:function(a){$rs.regEvent($rs.get("#rslightbox_buttons .rssettings-button-close"),"click",a.hide)},dimmees:{radio:function(a){a=$rs.findIn(a,"input[type=radio]");for(var b,e=!1,f=0,k=a.length;f<k;f++)if(a[f].checked){b=a[f];break}b&&(e=$rs.getAttr(b,"data-rsform-dims")||1);return e},select:function(a){a=$rs.findIn(a,"option");for(var b,e=!1,f=0,k=a.length;f<k;f++)if(a[f].selected){b=a[f];break}b&&(e=$rs.getAttr(b,"data-rsform-dims")||
1);return e}},info:function(a){$rs.hasClass(a.target.parentNode,"dimmed")||$rs.hasClass(a.target.parentNode.parentNode,"dimmed")||(a=$rs.get("#"+$rs.getAttr(this,"data-rsform-toggles")),$rs.css(a,"display","none"==$rs.css(a,"display")?"block":"none"));return!1},select:function(c){this.value!==$rs.getAttr(this,a.form.prev)&&rspkr.st.r().handlers.updateSetting.apply(rspkr.st.r().handlers,[$rs.getAttr(this,a.form.key),this.value,this]);return!0},checkbox:function(c){c=this.checked?$rs.getAttr(this,a.form.valyes):
$rs.getAttr(this,a.form.valno);c!==$rs.getAttr(this,a.form.prev)&&rspkr.st.r().handlers.updateSetting.apply(rspkr.st.r().handlers,[$rs.getAttr(this,a.form.key),c,this]);return!0},radio:function(c){this.value!==$rs.getAttr(this,a.form.prev)&&(rspkr.st.r().handlers.updateSetting.apply(rspkr.st.r().handlers,[$rs.getAttr(this,a.form.key),this.value,this]),$rs.setAttr($rs.findIn(this.parentNode,"input[name="+this.name+"]"),a.form.prev,this.value));return!0},slider_h:function(c,g){var e=g.parent,f=b[g.rsid],
f=f.converter?f.converter(parseInt(c)):parseInt(c),k=$rs.getAttr(e,a.form.prev);f!==k&&rspkr.st.r().handlers.updateSetting.apply(rspkr.st.r().handlers,[$rs.getAttr(e,a.form.key),f,e])},colorpicker:function(c){c.originalEvent&&c.originalEvent.preventDefault&&c.originalEvent.preventDefault();var b=c.target.parentNode.parentNode,e=c.target.parentNode;$rs.hasClass(c.target.parentNode.parentNode.parentNode,"dimmed")||$rs.getAttr(c.target,"data-rsform-value")===$rs.getAttr(b,a.form.prev)||($rs.removeClass($rs.findIn(b,
"li"),"rsform-colorlist-active"),rspkr.st.r().handlers.updateSetting.apply(rspkr.st.r().handlers,[$rs.getAttr(b,a.form.key),$rs.getAttr(c.target,"data-rsform-value"),b]),$rs.addClass(e,"rsform-colorlist-active"))}},updateSetting:function(c,b,f){rspkr.log("[rspkr.st] Setting updated: "+c+" | New value: "+b);e(c,b);if(f){c=$rs.closest(f,".rsform-row");var n=$rs.css(c,"background-color");rspkr.u.hl(c,function(){$rs.css(this,"background-color",n)});$rs.setAttr($rs.get(f),a.form.prev,b)}}},expandPhrase:function(a){if("string"==
typeof a&&"ph_"==a.substr(0,3)){a=a.substr(3);var b=rspkr.cfg.getPhrase(a);return void 0!==b?b:a}return a},row:function(a,b,e){if(/hlword|hltoggle/i.test(a)&&rspkr.cfg.isSentOnly&&rspkr.cfg.isSentOnly(rspkr.c.data.params.lang))return"";var f=rspkr.cfg.item("ui.settings.formrow").join("\n"),k={},h=ReadSpeaker.getID();e=this.controls[b.type](a,b,e,h);k.rsCONTROL_IDrs=a;k.rsCONTROLrs=e;k.rsCONTROL_TYPErs=b.type;k.rsCONTROL_CLASSESrs=b.classes?b.classes.join(" "):"";return this.replaceTokens(f,k)},group:function(a){var b=
rspkr.cfg.item("ui.settings.formsection").join("\n"),e={},n=[],k;for(k in a.items)a.items.hasOwnProperty(k)&&n.push(this.row(k,a.items[k],f(k)));e.rsSECTION_IDrs=ReadSpeaker.getID();e.rsSECTION_HEADINGrs=this.controls.xp(a.phrase);e.rsSECTION_ROWSrs=n.join("\n");return this.replaceTokens(b,e)},replaceTokens:function(a,b){var e=a,f;for(f in b)b.hasOwnProperty(f)&&(e=e.replace(new RegExp(f,"igm"),b[f]));return e}};return{meta:{revision:"2887"},r:function(){return h},e:a,init:function(){for(var a=["ReadSpeakerHL",
"ReadSpeakerHLicon","ReadSpeakerHLspeed"],b="",e=!1,f=0,k=a.length;f<k;f++){if(b=rspkr.Common.cookie.read(a[f]))rspkr.Common.cookie.updateKey(rspkr.pub.Config.item("general.cookieName"),a[f].substr(11).toLowerCase(),b),e=!0;rspkr.Common.cookie.erase(a[f])}e&&rspkr.log("[rspkr.st] Transferred legacy cookie.");rspkr.Common.dispatchEvent("onSettingsInitialized");rspkr.log("[rspkr.st] Initialized!");rspkr.Common.addEvent("onSettingsLoaded",{func:rspkr.Common.Settings.r().handlers.changed.afterdim,context:rspkr.Common.Settings.r().handlers.changed,
params:[]});rspkr.Common.addEvent("onSettingsChanged",{func:rspkr.Common.Settings.r().handlers.changed.afterdim,context:rspkr.Common.Settings.r().handlers.changed,params:[]})},get:function(a){return f(a)},getAll:function(){return rspkr.Common.cookie.readKeyAll(rspkr.pub.Config.item("general.cookieName"))},set:function(a,b){return e(a,b)},getHTML:function(){var a=rspkr.cfg,b=[],e=a.item("ui.settings.form").join("\n"),f={},k=a.getSettingsConf(),m;for(m in k)k.hasOwnProperty(m)&&b.push(h.group(k[m]));
k="";rspkr.ui.getActivePlayer()&&rspkr.cfg.item("ui.listenBtn")&&(k=document.createElement("div"),k.innerHTML=a.item("ui.listenBtn").join(""),a=rspkr.ui.getActivePlayer().getHref(),a=a.replace(/readid=[^&]+/gi,"readid=rslightbox_content"),a=a.replace(/&url=[^&]+/gi,""),$rs.findIn(k,"a").href=a,k=h.replaceTokens(k.innerHTML,{rsLISTENrs:h.controls.xp("ph_listen")}));f.rsSETTINGS_HEADINGrs=h.controls.xp("ph_settings");f.rsLISTEN_BUTTONrs=rs.cfg.item("ui.settingsListenButton")&&"rsbtn"===rs.ui.rsbtnClass?
k:"";f.rsSECTIONS_STARTrs="";f.rsSECTIONSrs=b.join("");f.rsSECTIONS_ENDrs="";return h.replaceTokens(e,f)},getButtons:function(){var a=rspkr.cfg.item("ui.settings.formbuttons").join("\n"),b={};b.rsSETTINGS_BUTTON_CLOSErs=h.controls.xp("ph_close");return h.replaceTokens(a,b)}}}();
ReadSpeaker.PlayerAPI=function(){var a={audioFormat:"flv",minver:8,check:function(){return rspkr.c.data.browser.flashVersion.split(",").shift()>=this.minver?!0:!1}},b={prioritize:!1,audioFormat:null,check:function(){return rspkr.c.data.browser.html5Support?(this.audioFormat=rspkr.c.data.browser.html5AudioFormat,this.prioritize=rspkr.c.data.browser.html5Priority,!0):!1}},f="",e=function(a,b){for(var e in b)a[e]=b[e]},h={meta:{revision:"2887"},init:function(){rspkr.log("[rspkr.pl] Initialized!");rspkr.Common.addEvent("onModsLoaded",
function(){rspkr.Common.Detect.init();rspkr.PlayerAPI.setAdapter()})},setAdapter:function(){f=b.check()&&a.check()?b.prioritize?"html5":"flash":b.check()?"html5":a.check()?"flash":"fallback";"html5"==f?(rspkr.log("[rspkr.pl] Using adapter "+f,1),e(h,rspkr.pl.html5.adapter)):"flash"==f?(rspkr.log("[rspkr.pl] Using adapter "+f,1),e(h,rspkr.pl.flash.adapter)):(rspkr.log("[rspkr.pl] No adapter detected - using fallback!",3),e(h,rspkr.pl.fallback.adapter))},getProduct:function(){return ReadSpeaker.HL?
ReadSpeaker.HL:ReadSpeaker.XP?ReadSpeaker.XP:!1}};return h}();
ReadSpeaker.PlayerAPI.flash=function(){return{init:function(){ReadSpeaker.log("PlayerAPI.flash heartbeat!")},adapter:{adapter:"flash",playerRef:null,timerCallBack:null,timerContext:null,loadTimer:null,progressStarted:!1,networkCheckCounter:0,play:function(){if(this.playerRef)try{this.playerRef.rs_player_play(),rspkr.devt("onAPIPlay",window)}catch(a){ReadSpeaker.log("error: "+a)}else this.initAdapter()},pause:function(){if(rspkr.pl.playerRef)try{this.playerRef.rs_player_pause(),rspkr.devt("onAPIPause",
window)}catch(a){rspkr.log("error: "+a,3)}},stop:function(){if(rspkr.pl.playerRef)try{this.playerRef.rs_player_stop(),rspkr.devt("onAPIStop",window)}catch(a){rspkr.log("error: "+a,3)}},volUp:function(){rspkr.pl.playerRef&&(this.playerRef.rs_player_volup(),rspkr.devt("onAPIVolumeUp",window))},volDown:function(){rspkr.pl.playerRef&&(this.playerRef.rs_player_voldown(),rspkr.devt("onAPIVolumeDown",window))},mute:function(){rspkr.pl.playerRef&&(this.playerRef.rs_player_mute(),rspkr.devt("onAPIMute",window))},
forward:function(){rspkr.pl.playerRef&&(this.playerRef.rs_player_jumpff(),rspkr.devt("onAPIFastForward",window))},rewind:function(){rspkr.pl.playerRef&&(this.playerRef.rs_player_jumpbb(),rspkr.devt("onAPIRewind",window))},setVolume:function(a){rspkr.log("[setVolume]",4);rspkr.pl.playerRef&&(this.playerRef.setVolume?(this.playerRef.setVolume(a),rspkr.devt("onAPISetVolume",window)):window.setTimeout(function(){rspkr.pl.setVolume(a)},10))},setProgress:function(a){if(rspkr.pl.playerRef)try{this.playerRef.setProgress(a),
rspkr.devt("onAPISetProgress",window)}catch(b){}},getProgress:function(a,b,f){rspkr.pl.playerRef&&(this.timerCallBack=b,this.timerContext=f||b,rspkr.pl.playerRef&&"function"==typeof rspkr.pl.playerRef.getProgress?(clearTimeout(this.loadTimer),rspkr.pl.playerRef.getProgress(a,"rspkr.pl.timer",500),this.progressStarted=!0):this.progressStarted||(this.loadTimer=window.setTimeout(function(){rspkr.pl.getProgress(a,b,f)},500)),rspkr.devt("onAPIGetProgress",window))},timer:function(a){a=a.split("|");if("function"==
typeof this.timerCallBack)try{this.timerCallBack.apply(this.timerContext,[a])}catch(b){}},checkNetworkStatus:function(){3<rspkr.pl.networkCheckCounter||setTimeout(function(){if(rspkr.pl.playerRef){rspkr.pl.networkCheckCounter++;try{rspkr.log("[rspkr.pl.checkNetworkStatus] "+rspkr.pl.playerRef.rs_player_networkStatus(),1)}catch(a){rs.pl.checkNetworkStatus();return}3===rspkr.pl.playerRef.rs_player_networkStatus()?(rspkr.log("[rspkr.pl] Cannot load audio!",3),rspkr.ui.showOverlay("loaderror"),rspkr.devt("onAudioLoadError",
window)):0===rs.PlayerAPI.playerRef.rs_player_networkStatus()&&rs.pl.checkNetworkStatus()}},rspkr.cfg.item("general.audioTimeout")||750)},initAdapter:function(){var a=encodeURIComponent(rspkr.c.data.getAudioLink({audioformat:"flv"}));this.progressStarted=!1;this.releaseAdapter();var b=document.getElementById("rs_player_holder");b||(b=document.createElement("div"),$rs.setAttr(b,"id","rs_player_holder"),document.body.appendChild(b));a=['<object id="readspeaker_flash_player" '+(document.selection?'classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"':
'type="application/x-shockwave-flash" data="'+ReadSpeaker.pub.Config.item("flash.flashSrc")+"?flv="+a+'&autoplay=1" ')+'style="height: 1px; width: 1px;">','<param name="movie" value="'+rspkr.cfg.item("flash.flashSrc")+"?flv="+a+'&autoplay=1" />','<param name="quality" value="high" />','<param name="autostart" value="true" />','<param name="allowScriptAccess" value="'+rspkr.cfg.item("flash.allowScriptAccess")+'" />','<param name="loop" value="false" /></object>'];b.innerHTML=a.join("\n");$rs.setAttr(b,
"style","position: fixed; bottom: 0px; right: 0px;");var f=function(a){4===a&&rspkr.pl.playerRef&&rspkr.pl.playerRef.setVolume&&(rspkr.pl.playerRef.setVolume(rspkr.st.get("hlvol")||"100"),document.attachEvent?$rs.get("#readspeaker_flash_player").detachEvent("onreadystatechange",f):document.addEventListener&&$rs.get("#readspeaker_flash_player").removeEventListener("load",function(){f(4)},!1))};document.attachEvent?($rs.get("#readspeaker_flash_player").attachEvent("onreadystatechange",f),rspkr.devt("onVolumeAdjusted",
window)):document.addEventListener&&$rs.get("#readspeaker_flash_player").addEventListener("load",function(){f(4)},!1);rspkr.pl.playerRef=document.getElementById("readspeaker_flash_player");rspkr.devt("onAPIInitAdapter",window);rspkr.pl.checkNetworkStatus()},releaseAdapter:function(){if(rspkr.pl.playerRef){try{rspkr.pl.playerRef.rs_player_stop(),rspkr.devt("onAPIStop",window)}catch(a){ReadSpeaker.log("error: "+a)}var b=$rs.get("#rs_player_holder");b.removeChild(rspkr.pl.playerRef);document.body.removeChild(b);
rspkr.pl.playerRef=null;rspkr.devt("onAPIReleaseAdapter",window)}},reloadAdapter:function(){this.initAdapter();rspkr.devt("onAPIReloadAdapter",window)}}}}();
ReadSpeaker.PlayerAPI.html5=function(){return{init:function(){ReadSpeaker.log("PlayerAPI.html5 heartbeat!")},adapter:{adapter:"html5",playerRef:null,timerCallBack:null,timerContext:null,bufferedTime:null,play:function(){ReadSpeaker.log("[rspkr.pl.play]");this.playerRef?(this.playerRef.play(),rspkr.devt("onAPIPlay",window)):this.initAdapter()},pause:function(){this.playerRef&&(rspkr.pl.playerRef.pause(),rspkr.devt("onAPIPause",window))},stop:function(){rspkr.pl.playerRef&&(rspkr.pl.playerRef.pause(),
rspkr.pl.playerRef.currentTime=0,rspkr.devt("onAPIStop",window))},volUp:function(){this.playerRef&&(this.playerRef.volume=Math.min(1,this.playerRef.volume+.2),rspkr.st.set("hlvol",100*this.playerRef.volume),rspkr.devt("onAPIVolumeUp",window))},volDown:function(){this.playerRef&&(this.playerRef.volume=Math.max(0,this.playerRef.volume-.2),rspkr.st.set("hlvol",100*this.playerRef.volume),rspkr.devt("onAPIVolumeDown",window))},mute:function(){this.playerRef&&(this.playerRef.volume=0,rspkr.devt("onAPIMute",
window))},forward:function(){this.playerRef&&(this.playerRef.currentTime=this.playerRef.currentTime+5<this.playerRef.duration?this.playerRef.currentTime+5:this.playerRef.duration,rspkr.devt("onAPIFastForward",window))},rewind:function(){this.playerRef&&(this.playerRef.currentTime=0<this.playerRef.currentTime-5?this.playerRef.currentTime-5:0,rspkr.devt("onAPIRewind",window))},setVolume:function(a){rspkr.log("[setVolume] "+a,4);this.playerRef&&(this.playerRef.volume=parseFloat(a/100),rspkr.devt("onAPISetVolume",
window))},setProgress:function(a){if(this.playerRef){a=parseInt(a);var b=parseInt(ReadSpeaker.PlayerAPI.getProduct().html5.handlers.totalTime());this.playerRef.currentTime=a<b&&a<this.playerRef.duration?a:this.playerRef.duration;rspkr.devt("onAPISetProgress",window)}},getProgress:function(a,b,f){this.playerRef&&(0==a?rspkr.pl.playerRef.removeEventListener("timeupdate",rspkr.pl.timer,!1):(this.timerCallBack=b,this.timerContext=f||b,rspkr.pl.playerRef.addEventListener("timeupdate",rspkr.pl.timer,!1),
rspkr.devt("onAPIGetProgress",window)))},timer:function(){if(rspkr.pl.playerRef){var a=1E3*parseInt(rspkr.pl.playerRef.currentTime);rspkr.pl.bufferedTime=1E3*parseInt(ReadSpeaker.PlayerAPI.getProduct().html5.handlers.totalTime());a=[a,rspkr.pl.bufferedTime];if("function"==typeof rspkr.pl.timerCallBack)try{rspkr.pl.timerCallBack.apply(rspkr.pl.timerContext,[a])}catch(b){rspkr.log("timeupdate error",2)}}},checkNetworkStatus:function(){var a=rs.pl.playerRef;setTimeout(function(){if(a)if(3===a.networkState)rspkr.log("[rspkr.pl] Cannot load audio!",
3),rspkr.ui.showOverlay("loaderror"),rspkr.devt("onAudioLoadError",window);else if(2===a.networkState){var b=0<a.buffered.length?a.buffered.end(a.buffered.length-1):0,f=a.duration||0;(0==f||b<f)&&rspkr.pl.checkNetworkStatus()}},rspkr.cfg.item("general.audioTimeout")||750)},initAdapter:function(){rspkr.devt("onAPIInitAdapter",window)},releaseAdapter:function(){if(rspkr.pl.playerRef){rspkr.pl.playerRef.pause();try{rspkr.pl.playerRef.currentTime=0}catch(a){}rspkr.pl.playerRef=null;rspkr.devt("onAPIReleaseAdapter",
window)}},reloadAdapter:function(){this.releaseAdapter();this.initAdapter();rspkr.devt("onAPIReloadAdapter",window)}}}}();rspkr.PlayerAPI.fallback=function(){return{init:function(){ReadSpeaker.log("PlayerAPI.fallback heartbeat!")},adapter:{adapter:"fallback"}}}();
rspkr.HL=function(){var a="",b={firstRun:0,previousWord:{},previousSent:{},lastWord:null,selectionRange:null,selectionHTML:null,selectedWordsRange:[]},f={oldWordHL:[],oldWordHLClass:[],oldSentHL:[],oldSentHLClass:[],sync:function(a,b){var e=!1,f=document.getElementById("sync"+b);0==(a&2)&&(e=0!=(a&1)?!0:!1);if(f&&f.className.replace("word","")!=f.className){if(!e&&0<this.oldWordHL.length){for(e=0;e<this.oldWordHLClass.length;e++)this.oldWordHL[e].className=this.oldWordHLClass[e];this.oldWordHL=[];
this.oldWordHLClass=[]}this.oldWordHLClass.push(f.className);this.oldWordHL.push(f);rspkr.HL.customHL&&rspkr.HL.customHL.active()?rspkr.HL.customHL.wordHL(f,a):f.className="sync_word_highlighted"}else if(f&&f.className.replace("sent","")!=f.className){if(!e&&0<this.oldSentHL.length){for(e=0;e<this.oldSentHL.length;e++)this.oldSentHL[e].className=this.oldSentHLClass[e];this.oldSentHL=[];this.oldSentHLClass=[]}this.oldSentHLClass.push(f.className);this.oldSentHL.push(f);rspkr.HL.customHL&&rspkr.HL.customHL.active()?
rspkr.HL.customHL.sentHL(f,a):f.className="sync_sent_highlighted"}f&&rspkr.HL.Scroll.execScroll(f)},preProcess:{setRestoreContent:function(){rspkr.log("[Servermarkup.preProcess.setRestoreContent] Called!");var a=rspkr.Common.data.getParam("readid"),a=document.getElementById(a).innerHTML;rspkr.Common.data.setRestoreContent(a)}},postProcess:{fullCleanUp:function(){rspkr.log("[Servermarkup.postProcess.fullCleanUp] Called!");rspkr.HL.Restore.all()},lightCleanUp:function(){rspkr.log("[Servermarkup.postProcess.lightCleanUp] Called!");
var a=rspkr.HL.serverMarkup.oldWordHL,b=rspkr.HL.serverMarkup.oldWordHLClass,e=rspkr.HL.serverMarkup.oldSentHL,f=rspkr.HL.serverMarkup.oldSentHLClass;if(0<a.length){for(var k=0;k<a.length;k++)a[k].className=b[k];rspkr.HL.serverMarkup.oldWordHL=[];rspkr.HL.serverMarkup.oldWordHLClass=[]}if(0<e.length){for(k=0;k<e.length;k++)e[k].className=f[k];rspkr.HL.serverMarkup.oldSentHL=[];rspkr.HL.serverMarkup.oldSentHLClass=[]}a=document.getElementsByTagName(rspkr.Common.data.browser.syncContainer);for(k=a.length-
1;-1<k;k--)a[k].className=a[k].className.replace("sync_sent_highlighted","sync_sent"),a[k].className=a[k].className.replace("sync_word_highlighted","sync_word"),-1!==a[k].className.toLowerCase().indexOf("sync_user")&&(a[k].className=a[k].className.replace("sync_sent",""),a[k].className=a[k].className.replace("sync_word",""),a[k].removeAttribute("id"))}}},e=function(){rspkr.log("[rspkr.HL.addEvents]");evt("onUIClosePlayer",rspkr.HL.cleanUpHandler);evt("onUIClosePlayer",function(){rspkr.hl.State.setState(rspkr.hl.State.READY)});
evt("onUIStop",function(){rspkr.hl.State.setState(rspkr.hl.State.STOPPED)});evt("onUIBeforePlay",function(){rspkr.hl.Restore.checkContent()});rspkr.PlayerAPI&&rspkr.PlayerAPI.adapter&&"html5"===rspkr.PlayerAPI.adapter&&(rspkr.evt("onAPIInitAdapter",rspkr.HL.html5.handlers.init),rspkr.evt("onAPIPlay",rspkr.HL.html5.handlers.play),rspkr.evt("onAPIPause",rspkr.HL.html5.handlers.pause),rspkr.evt("onAPIStop",rspkr.HL.html5.handlers.stop),rspkr.evt("onAPIRewind",rspkr.HL.html5.handlers.updateTime),rspkr.evt("onAPISetProgress",
rspkr.HL.html5.handlers.updateTime),rspkr.evt("onAPIReleaseAdapter",rspkr.HL.html5.handlers.release));rspkr.evt("onAPIStop",rspkr.HL.sync.lightCleanUp)},h={enums:{key:"readspeaker_inline_styles",sent:"sync_sent",sent_hl:"sync_sent_highlighted",word:"sync_word",word_hl:"sync_word_highlighted"},word_index:null,sent_index:null,hlChanged:!1,setHL:function(){var a=rspkr.pub.Config,b=rspkr.Common.Settings.get("hlword")||a.item("settings.hlword"),e=rspkr.Common.Settings.get("hlsent")||a.item("settings.hlsent"),
a=rspkr.Common.Settings.get("hltext")||a.item("settings.hltext");this.updateHL("hlword",b,null);this.updateHL("hlsent",e,null);this.updateHL("hltext",a,null)},updateHL:function(c,g,e){e=e||null;"hlspeed"===c&&g!==e&&(this.hlChanged=!0);g===e||"hl"!==c&&"hltoggle"!==c||(this.hlChanged=!0,rspkr.HL.sync.lightCleanUp());g!==e&&("hl"===c&&"none"!==g||"hltoggle"===c&&"hlon"===g)&&(this.setTextStyle("word",rspkr.Common.Settings.get("hlword")),this.setTextStyle("sent",rspkr.Common.Settings.get("hlsent")),
this.setTextStyle("hltext",rspkr.Common.Settings.get("hltext")),this.hlChanged=!0,rspkr.HL.Type.CURRENT===rspkr.HL.Type.CLIENT_MARKUP&&rspkr.PlayerAPI.releaseAdapter());/hltext|hlword|hlsent|hlscroll/i.test(c)&&g!=e&&("hlscroll"==c?rspkr.HL.Scroll.initScroll():(this.setTextStyle(c,g),"explorer"==a&&(b.selectionRange&&"wordsent"===rspkr.st.get("hl")&&"hlsent"==c&&(b.selectionRange.execCommand("backcolor",0,rspkr.Common.Settings.get("hlsent")),b.selectionRange.execCommand("forecolor",0,rspkr.Common.Settings.get("hltext"))),
b.lastWord&&("sent"==rspkr.st.get("hl")?b.lastWord.execCommand("backcolor",0,rspkr.Common.Settings.get("hlsent")):b.lastWord.execCommand("backcolor",0,rspkr.Common.Settings.get("hlword")),b.lastWord.execCommand("forecolor",0,rspkr.Common.Settings.get("settings.hltext"))))))},setTextStyle:function(a,b,e){var f=/word/.test(a)?"word":"sent",k="background-color";e=e||h.enums.key;/underline/.test(b)?(k="text-decoration",b+=" !important; background-color: none !important"):/none/.test(b)?(k="background",
b+=" !important; text-decoration: none !important; background-color: none !important"):"hltext"===a?(a=b,b=this.getStyleString(rspkr.Common.Settings.get("hlsent"),a),a=this.getStyleString(rspkr.Common.Settings.get("hlword"),a),rspkr.Common.css.replaceRule(e,"."+h.enums.word_hl,k+": "+a)):b+=" !important; text-decoration: none !important; color: "+rspkr.Common.Settings.get("hltext")+" !important";rspkr.Common.css.replaceRule(e,"."+h.enums[f+"_hl"],k+": "+b)},getStyleString:function(a,b){var e=/underline|none/i.test(a)?
"none":a,f=/underline/i.test(a)?"underline":"none";return e+" !important; text-decoration: "+f+" !important; color: "+b+" !important"}};return{meta:{revision:"2887"},init:function(){var c=rspkr.Common.addEvent;c("onAfterModsLoaded",function(){c("onAPIInitAdapter",rspkr.HL.Restore.setRestoreContent);rspkr.HL.addEvents();rspkr.HL.Scroll.initScroll();a=document.selection&&(9>rspkr.Common.data.browser.version||9>document.documentMode)?"explorer":"gecko";rspkr.log("[rspkr.hl] Using engine "+a);var g=rspkr.HL.engine[a].clientExtension,
e;for(e in g)b[e]=g[e];window.addEventListener&&window.addEventListener("message",rspkr.HL.html5.receiveMessage,!1,!0)});c("onModsLoaded",{func:h.setHL,context:h});c("onSettingsChanged",{func:h.updateHL,context:h});rspkr.log("[rspkr.HL] Initialized!")},addEvents:function(){e()},cleanUpHandler:function(a){rspkr.log("[rspkr.HL.cleanUpHandler] String is: "+a);"userclick"===a||"nosel"===a?rspkr.HL.sync.fullCleanUp():rspkr.HL.sync.lightCleanUp()},clientMarkup:b,serverMarkup:f,markedUpHTML:[],html5:{States:{BEGIN:0,
STOPPED:1,USER_START_NOT_READY:2,USER_START_PLAYING:3,NOT_PLAYING:4,CURRENT:0,setState:function(a){this.CURRENT=a;rspkr.log("[rspkr.hl.html5.States.setState] Changing state from "+this.CURRENT+" to "+a,1)}},Events:{canPlay:!1,durationChange:!1,syncReady:!1,eventTimer:null,onCanPlay:function(){rspkr.log("onCanPlay fired!",1);this.canPlay=!0;this.checkCompletion();this.eventTimer=setTimeout(function(){rspkr.log("[rspkr.hl.html5.Events] Timer triggered. Starting playback.",1);rspkr.hl.html5.Events.resetAll();
rspkr.hl.html5.refresh()},2500);return!1},checkCompletion:function(){this.canPlay&&this.durationChange&&this.syncReady&&(clearTimeout(this.eventTimer),this.eventTimer=null,rspkr.hl.html5.Events.resetAll(),rspkr.hl.html5.refresh())},onDurationChange:function(){rspkr.log("onDurationChange fired!",1);this.durationChange=!0;this.checkCompletion();this.eventTimer=setTimeout(function(){rspkr.log("[rspkr.hl.html5.Events] Timer triggered. Starting playback.",1);rspkr.hl.html5.Events.resetAll();rspkr.hl.html5.refresh()},
2500)},onSyncReady:function(){rspkr.log("onSyncReady fired!",1);this.syncReady=!0;this.checkCompletion();this.eventTimer=setTimeout(function(){rspkr.log("[rspkr.hl.html5.Events] Timer triggered. Starting playback.",1);rspkr.hl.html5.Events.resetAll();rspkr.hl.html5.refresh()},2500)},resetAll:function(){this.syncReady=this.durationChange=this.canPlay=!1}},lastcurrenttime:-1,currentsyncindex:0,lastevent:null,lastlastevent:null,lastlastlastevent:null,synclist:[],synclistindex:0,audioUrl:null,backupUrl:null,
frameUrl:null,timer:null,postMessageData:[],runningRefresh:!1,handlers:{init:function(){rspkr.log("[rspkr.HL.html5.handlers.init]");rspkr.HL.html5.cronologyCheck={proxyCallsDone:!1,errorOccured:!1,quarantine:[]};rspkr.HL.html5.rshlendCall=!1;var a=Math.random(),b={};b.audioformat=rspkr.Common.data.browser.html5AudioFormat;b.requestgrouptype="html5iframe";b.requestgroup=a;rspkr.HL.html5.backupUrl=rspkr.Common.data.getAudioLink(b);(!0===rspkr.cfg.item("general.usePost")||0<rspkr.Common.data.selectedText.length||
0<rspkr.Common.data.selectedHTML.length)&&"iOS"!==rspkr.Common.data.browser.OS&&"Android"!==rspkr.Common.data.browser.OS?rspkr.HL.html5.timer=setTimeout(function(){rspkr.HL.html5.initSyncFrame(b);rspkr.HL.html5.initAudio();clearTimeout(rspkr.HL.html5.timer)},2E3):(rspkr.log("Normal audio init!"),rspkr.HL.html5.initSyncFrame(b),rspkr.HL.html5.initAudio())},play:function(){rspkr.log("[rspkr.HL.html5.handlers.play]");rspkr.HL.Type.CURRENT==rspkr.HL.Type.CLIENT_MARKUP&&rspkr.hl.html5.States.CURRENT==
rspkr.hl.html5.States.STOPPED?(rspkr.hl.html5.States.setState(rspkr.hl.html5.States.BEGIN),rspkr.PlayerAPI.playerRef.pause(),rspkr.HL.html5.handlers.runPostMessages()):rspkr.HL.Type.CURRENT==rspkr.HL.Type.SERVER_MARKUP&&rspkr.hl.html5.States.CURRENT==rspkr.hl.html5.States.STOPPED?rspkr.hl.State.setState(rspkr.hl.State.RELOAD)?this.init():(rspkr.hl.html5.States.setState(rspkr.hl.html5.States.BEGIN),rspkr.PlayerAPI.playerRef.pause(),rspkr.HL.html5.handlers.runPostMessages()):(rspkr.hl.html5.States.CURRENT=
rspkr.hl.html5.States.USER_START_PLAYING,rspkr.hl.html5.refresh())},pause:function(){rspkr.hl.html5.States.setState(rspkr.hl.html5.States.NOT_PLAYING);rspkr.hl.html5.lastcurrenttime=0},release:function(){rspkr.log("[rspkr.HL.html5.handlers.release]");rspkr.HL.html5.synclist=[];rspkr.HL.html5.synclistindex=0;rspkr.HL.html5.currentsyncindex=0;rspkr.HL.html5.lastcurrenttime=-1;rspkr.HL.html5.audioUrl=null;rspkr.HL.html5.backupUrl=null;rspkr.HL.html5.frameUrl=null;rspkr.HL.html5.postMessageData=[];rspkr.HL.html5.Events.resetAll();
rspkr.PlayerAPI.playerRef&&rspkr.PlayerAPI.playerRef.removeEventListener("ended",rshlexit,!1);rspkr.PlayerAPI.playerRef=null;var a=document.getElementById("ReadSpeaker_sync_iframe");a&&(a.src="about:blank")},stop:function(){rspkr.hl.html5.States.setState(rspkr.hl.html5.States.STOPPED);rspkr.HL.html5.lastcurrenttime=-1;rspkr.HL.html5.currentsyncindex=0},updateTime:function(){rspkr.log("[rspkr.HL.html5.handlers.updateTime]");rspkr.hl.html5.States.setState(rspkr.hl.html5.States.NOT_PLAYING);rspkr.HL.html5.lastcurrenttime=
rspkr.PlayerAPI.playerRef.currentTime;rspkr.HL.html5.currentsyncindex=0;rspkr.HL.html5.handlers.setCurrentSyncIndex();rspkr.hl.html5.States.setState(rspkr.hl.html5.States.USER_START_PLAYING)},runPostMessages:function(){rspkr.log("[rspkr.HL.html5.handlers.runPostMessages]");var a=rspkr.HL.html5.postMessageData,b;for(b in a)null!==a[b-1]&&"rshlsetContent"==a[b]?rspkr.HL.sync.setContent(rspkr.Common.base64.decode(a[b-1])):null!==a[b-1]&&"rshlsetId"==a[b]?rspkr.HL.sync.setId(a[b-1]):"rshlinit"==a[b]&&
(rspkr.HL.sync.init(),rspkr.PlayerAPI.playerRef.play(),rspkr.HL.html5.refresh())},setCurrentSyncIndex:function(){if(0<rspkr.HL.html5.synclist.length&&rspkr.HL.html5.synclist[rspkr.HL.html5.currentsyncindex])for(;rspkr.HL.html5.synclist[rspkr.HL.html5.currentsyncindex]&&20>=1*rspkr.HL.html5.synclist[rspkr.HL.html5.currentsyncindex][0]-1E3*rspkr.PlayerAPI.playerRef.currentTime;)rspkr.HL.html5.currentsyncindex++},totalTime:function(){var a=rspkr.PlayerAPI.playerRef;if(a)if("Opera"!==rspkr.Common.data.browser.name&&
a.buffered&&a.buffered.end)try{return 0<a.buffered.length?a.buffered.end(a.buffered.length-1):a.buffered.end(0)}catch(b){return a.duration&&"infinity"!==a.duration.toString().toLowerCase()&&"NaN"!==a.duration?a.duration:a.currentTime+15}else return a.duration&&"infinity"!==a.duration.toString.toLowerCase()&&"NaN"!==a.duration?a.duration:a.currentTime+15}},initAudio:function(){rspkr.HL.html5.audioUrl||(rspkr.HL.html5.audioUrl=rspkr.HL.html5.backupUrl);rspkr.log("[rspkr.html5.initAudio] Audio URL: "+
rspkr.HL.html5.audioUrl,1);/ios|android/i.test(rspkr.c.data.browser.OS)&&"object"===typeof window.rspkr.audio&&null!==window.rspkr.audio?(rspkr.audio.src=rspkr.HL.html5.audioUrl,rspkr.PlayerAPI.playerRef=rspkr.audio,rspkr.log("[rs.hl.initAudio] Reusing existing audio element.",4)):rspkr.PlayerAPI.playerRef=new Audio(rspkr.HL.html5.audioUrl);var a=rspkr.PlayerAPI.playerRef;a.loop=!1;a.preload="auto";a.volume=parseFloat((rspkr.st.get("hlvol")||100)/100);rspkr.devt("onVolumeAdjusted",window);/ios|android/i.test(rspkr.c.data.browser.OS)&&
(rspkr.PlayerAPI.playerRef.play(),rspkr.PlayerAPI.playerRef.pause());a.addEventListener("canplay",function(){rspkr.hl.html5.Events.onCanPlay()},!1);a.addEventListener("durationchange",function(){rspkr.log("[rspkr.hl.html5.initAudio] Durationchange occurred",1);1==rspkr.HL.html5.handlers.totalTime()&&1==rspkr.PlayerAPI.playerRef.paused?rspkr.HL.html5.initAudio():(0===rspkr.HL.html5.handlers.totalTime()&&rspkr.pl.playerRef.play(),rspkr.hl.html5.Events.onDurationChange())},!1);rspkr.PlayerAPI.playerRef.addEventListener("ended",
function(){window.rshlexit("false")},!1);rspkr.pl.checkNetworkStatus();rspkr.hl.html5.States.setState(rspkr.hl.html5.States.BEGIN)},initSyncFrame:function(a){if("none"!=rspkr.Common.data.sync){var b=null;document.getElementById("ReadSpeaker_sync_iframe")?b=document.getElementById("ReadSpeaker_sync_iframe"):(b=document.createElement("iframe"),b.setAttribute("id","ReadSpeaker_sync_iframe"),b.height=0,b.width=0,b.style.display="none",document.body.appendChild(b));!rspkr.HL.html5.frameUrl&&(!0===rspkr.cfg.item("general.usePost")||
0<rspkr.Common.data.selectedText.length||0<rspkr.Common.data.selectedHTML.length)?rspkr.HL.html5.frameUrl=rspkr.HL.html5.backupUrl+"sync":rspkr.HL.html5.frameUrl||(a.audioformat="html5iframe",rspkr.HL.html5.frameUrl=rspkr.Common.data.getAudioLink(a));rspkr.log("[rspkr.HL.html5.initSyncFrame] Audio URL: "+rspkr.HL.html5.frameUrl);b.src=rspkr.HL.html5.frameUrl;b.type="text/javascript"}else rspkr.hl.html5.States.setState(rspkr.hl.html5.States.USER_START_PLAYING),rspkr.PlayerAPI.playerRef.play()},removeSyncFrame:function(){var a=
document.getElementById("ReadSpeaker_sync_iframe");a&&a.parentNode.removeChild(a)},receiveMessage:function(a){if(a.origin.match(/readspeaker.?.com/gi)||a.origin.match(rspkr.cfg.item("general.domain"))){if(!0===rspkr.cfg.item("general.usePost")){var b=rspkr.HL.html5.cronologyCheck;if("rshlend"===a.data&&b.quarantine&&0<b.quarantine.length)b.errorOccured=!1,b.cleanUpTimer=setInterval(function(){if(0<b.quarantine.length){var a=b.quarantine.shift();window.postMessage(a,"*")}else clearInterval(b.cleanUpTimer)},
0);else if("rshlendpost"===a.data)b.proxyCallsDone=!0;else if((!b.proxyCallsDone||b.errorOccured)&&"http"!==a.data.substring(0,4)&&"rshlaudio"!==a.data&&"rshlhtml5sync"!==a.data&&"rshlfinished"!==a.data){b.errorOccured=!0;b.quarantine.push(a.data);return}}rspkr.HL.html5.postMessageData.push(a.data);/android|ios/i.test(rspkr.Common.data.browser.OS)||"rshlfinished"!=a.data||(rspkr.HL.html5.timer&&clearTimeout(rspkr.HL.html5.timer),rspkr.HL.html5.initSyncFrame(),rspkr.HL.html5.initAudio());if("rshlend"===
a.data)rspkr.HL.html5.rshlendCall=!0,rspkr.c.post.removeIframe(),rspkr.HL.html5.removeSyncFrame();else{if(-1!=a.data.indexOf("."+rspkr.Common.data.browser.html5AudioFormat)){rspkr.HL.html5.audioUrl=a.data;return}if(-1!=a.data.indexOf(".html5iframe")){rspkr.HL.html5.frameUrl=a.data;return}if("rshlaudio"==a.data||"rshlhtml5sync"==a.data)return;if(null!=rspkr.HL.html5.lastevent&&"rshlsetContent"==a.data)rspkr.HL.html5.synclist=[],rspkr.HL.html5.synclistindex=0,rspkr.HL.sync.setContent(rspkr.Common.base64.decode(rspkr.HL.html5.lastevent.data));
else if(null!=rspkr.HL.html5.lastevent&&"rshlsetId"==a.data)rspkr.HL.sync.setId(rspkr.HL.html5.lastevent.data);else if(null!=rspkr.HL.html5.lastevent&&"rshlReplace"==a.data)if(rspkr.HL.html5.lastevent.data.match(/class=[^&]+/gi)){var e=rspkr.HL.html5.lastevent.data.match(/class=[^&]+/gi)[0].replace("class=","");rspkr.HL.sync.setClass(e)}else rspkr.HL.html5.lastevent.data.match(/id=[^&]+/gi)&&(e=rspkr.HL.html5.lastevent.data.match(/id=[^&]+/gi)[0].replace("id=",""),rspkr.HL.sync.setId(e));else"rshlinit"==
a.data?(rspkr.HL.sync.init(),rspkr.hl.html5.Events.onSyncReady()):null!=rspkr.HL.html5.lastlastlastevent&&null!=rspkr.HL.html5.lastlastevent&&null!=rspkr.HL.html5.lastevent&&"rshlsync"==a.data&&(rspkr.HL.html5.synclist[rspkr.HL.html5.synclistindex]=[rspkr.HL.html5.lastlastlastevent.data,rspkr.HL.html5.lastlastevent.data,rspkr.HL.html5.lastevent.data],rspkr.HL.html5.synclistindex++)}rspkr.HL.html5.lastlastlastevent=rspkr.HL.html5.lastlastevent;rspkr.HL.html5.lastlastevent=rspkr.HL.html5.lastevent;
rspkr.HL.html5.lastevent=a}},refresh:function(){var a=rspkr.PlayerAPI.playerRef,b=rspkr.HL.html5;a&&b.States.CURRENT!=b.States.STOPPED?(b.States.CURRENT==b.States.NOT_PLAYING&&setTimeout(function(){b.refresh()},500),0<a.currentTime&&parseInt(b.lastcurrenttime)>parseInt(a.currentTime)?(rspkr.log("[rspkr.hl.html5.refresh] An error has occurred. Player is stopped.",2),rspkr.ui.getActivePlayer().stop(),b.runningRefresh=!1):(b.lastcurrenttime=a.currentTime,b.runningRefresh=!0,b.States.CURRENT==b.States.BEGIN?
(rspkr.hl.html5.States.setState(b.States.USER_START_NOT_READY),setTimeout(function(){b.refresh()},200)):b.States.CURRENT==b.States.USER_START_NOT_READY?0<b.handlers.totalTime()&&(rspkr.HL.html5.rshlendCall||b.synclist[b.currentsyncindex]&&b.synclist[b.currentsyncindex][0]<1E3*b.handlers.totalTime())?(rspkr.hl.html5.States.setState(b.States.USER_START_PLAYING),a.play(),setTimeout(function(){b.refresh()},50)):0===b.handlers.totalTime()?(a.play(),setTimeout(function(){b.refresh()},250)):b.synclist[b.currentsyncindex]?
20>=1*b.synclist[b.currentsyncindex][0]-1E3*a.currentTime?setTimeout(function(){b.refresh()},0):(a=1*b.synclist[b.currentsyncindex][0]-1E3*a.currentTime-20,75<a?setTimeout(function(){b.refresh()},75):0>a?setTimeout(function(){b.refresh()},0):setTimeout(function(){b.refresh()},a)):setTimeout(function(){b.refresh()},75):b.States.CURRENT==b.States.USER_START_PLAYING&&(b.synclist[b.currentsyncindex]&&1*b.synclist[b.currentsyncindex][0]-20<1E3*a.currentTime&&(rspkr.HL.sync.execute(b.synclist[b.currentsyncindex][1],
b.synclist[b.currentsyncindex][2]),b.currentsyncindex++),b.synclist[b.currentsyncindex]?20>=1*b.synclist[b.currentsyncindex][0]-1E3*a.currentTime?setTimeout(function(){b.refresh()},0):(a=1*b.synclist[b.currentsyncindex][0]-1E3*a.currentTime-20,75<a?setTimeout(function(){b.refresh()},75):0>a?setTimeout(function(){b.refresh()},0):setTimeout(function(){b.refresh()},a)):setTimeout(function(){b.refresh()},75)))):(rspkr.log("[rspkr.hl.html5.refresh] Audio is undefined or player is stopped",2),b.runningRefresh=
!1)}},Preserve:{cls:"rs_preserve",testElem:null,elementShelter:[],formShelter:[],formData:function(a,b,e,f,k){this.name=a;this.type=b;this.value=e;this.checked=f;this.selectedIndex=k;this.selectedOptions=[]},moveToShelter:function(a){function b(a){for(var c=0;c<a.childNodes.length;c++){var e=a.childNodes[c];1==e.nodeType&&p.test(e.className)?h.push(e):1==e.nodeType&&b(e)}}rspkr.log("[rspkr.HL.Preserve.moveToShelter]");var e=[],f=[],k=null,h=[],p=new RegExp(rspkr.HL.Preserve.cls,"i");b(a);for(var q=
0,t=h.length;q<t;q++)k=$rs.get(h[q]).cloneNode(!1),h[q].parentNode.insertBefore(k,h[q]),e.push($rs.detach(h[q]));rspkr.log("[rspkr.hl.Preserve] Moved "+q+" nodes to the shelter.");a=$rs.findIn(a,"input, select");for(q=0;q<a.length;q++){k=new rspkr.HL.Preserve.formData(a[q].name,a[q].type,a[q].value,a[q].checked,a[q].selectedIndex);if("select-multiple"==a[q].type){for(var t=a[q].options,r=[],w=0;w<t.length;w++)r.push(t[w].selected);k.selectedOptions=r}f.push(k)}rspkr.HL.Preserve.elementShelter.push(e);
rspkr.HL.Preserve.formShelter.push(f)},restoreFromShelter:function(a){var b=[],e,f;rspkr.log("[rspkr.HL.Preserve.restoreFromShelter]");if(rspkr.HL.Preserve.elementShelter.length&&(f=rspkr.HL.Preserve.elementShelter.shift(),f.length)){var h=function(a){for(var c=0;c<a.childNodes.length;c++){var e=a.childNodes[c];1==e.nodeType&&m.test(e.className)?b.push(e):1==e.nodeType&&h(e)}},m=new RegExp(rspkr.HL.Preserve.cls,"i");h(a);for(var p=0,q=b.length;p<q;p++)e=f.shift(),b[p].parentNode.insertBefore(e,b[p]),
b[p].parentNode.removeChild(b[p])}if(rspkr.HL.Preserve.formShelter.length&&(a=$rs.findIn(a,"input, select"),e=rspkr.HL.Preserve.formShelter.shift(),a.length&&e.length&&a.length===e.length))for(p=0;p<a.length;p++)if(a[p].name===e[p].name)switch(a[p].type){case "text":a[p].value=e[p].value;break;case "password":a[p].value=e[p].value;break;case "radio":!0===e[p].checked&&(a[p].checked=!0);break;case "checkbox":a[p].checked=e[p].checked;break;case "select-one":a[p].selectedIndex=e[p].selectedIndex;break;
case "select-multiple":for(f=a[p].options,q=0;q<f.length;q++)f[q].selected=e[p].selectedOptions[q]}},clearShelter:function(){rspkr.log("[rspkr.HL.Preserve.clearShelter]");rspkr.HL.Preserve.elementShelter=[];rspkr.HL.Preserve.formShelter=[]}},Restore:{Storage:{readClass:[],readId:[],restoreContent:[]},all:function(){rspkr.log("[rspkr.HL.Restore.all]");var a=rspkr.HL.Restore.Storage,b=[],b=null,e=/sync_(word|sent)/gi;rspkr.c.dispatchEvent("onBeforeContentChange",window);if(0<a.readClass.length&&0<a.restoreContent.length)for(var f=
0;f<a.readClass.length;f++){rspkr.HL.Preserve.clearShelter();b=$rs.get("."+a.readClass[f]);$rs.isArray(b)||(b=[b]);for(var h=0;h<b.length;h++)!0===e.test(b[h].innerHTML)&&(rspkr.HL.Preserve.moveToShelter(b[h]),b[h].innerHTML=a.restoreContent[f][h],rspkr.HL.Preserve.restoreFromShelter(b[h]))}if(0<a.readId.length&&a.restoreContent.length>a.readClass.length)for(f=0;f<a.readId.length;f++)for(h=0;h<a.readId[f].length;h++)b=$rs.get("#"+a.readId[f][h]),!0===e.test(b.innerHTML)&&(rspkr.HL.Preserve.moveToShelter(b),
b.innerHTML=a.restoreContent[f+a.readClass.length][h],rspkr.HL.Preserve.restoreFromShelter(b));a.readId.length||a.restoreContent.length||a.readClass.length||rspkr.log("No stored content exists!",2);rspkr.c.dispatchEvent("onAfterContentChange",window)},checkContent:function(){rspkr.log("[rspkr.hl.Restore.checkContent]",1);!1===this.hasMarkup()&&rspkr.hl.State.CURRENT==rspkr.hl.State.STOPPED&&rspkr.HL.Type.CURRENT==rspkr.HL.Type.SERVER_MARKUP&&(this.clearRestoreContent(),this.setRestoreContent(),rspkr.pl.releaseAdapter(),
rspkr.hl.State.setState(rspkr.hl.State.RELOAD))},hasMarkup:function(){var a=rspkr.HL.Restore.Storage,b=[],b=null,e=/sync_(word|sent)/gi;if(0<a.readId.length&&0<a.restoreContent.length)for(var f=0;f<a.readId.length;f++)for(var h=0;h<a.readId[f].length;h++){if(b=$rs.get("#"+a.readId[f][h]),!0===e.test(b.innerHTML))return!0}else if(0<a.readClass.length&&0<a.restoreContent.length)for(f=0;f<a.readClass.length;f++)for(rspkr.HL.Preserve.clearShelter(),b=$rs.get("."+a.readClass[f]),h=0;h<b.length;h++)if(!0===
e.test(b[h].innerHTML))return!0;return!1},clearRestoreContent:function(){rspkr.log("[rspkr.HL.Restore.clearRestoreContent] Called!")},setRestoreContent:function(){rspkr.log("[rspkr.HL.Restore.setRestoreContent] Called!");if("Explorer"===rs.c.data.browser.name&&9>=rs.c.data.browser.version)for(var a=document.body.getElementsByTagName("style"),b=0,e;e=a[b];b++){e.parentNode.removeChild(e);document.getElementsByTagName("head")[0].appendChild(e);var f=e.innerHTML;if(-1!=f.indexOf("@import")){for(var h=
f.split("\n"),m,f=0,p;p=h[f];f++)if("@import"===p.substring(0,7)){f=p.replace(/;/g,"").replace("@import ","").replace("url(","").replace(")","").replace(/\"/g,"").replace(/\'/g,"").split(" ");for(h=0;h<f.length;h++){var q=f[h].replace(/ /g,"");if(q){m=q;break}}break}f=e.sheet?e.sheet:e.styleSheet;f.insertRule?f.insertRule(p,0):f.addImport&&f.addImport(m)}}a=rspkr.HL.Restore.Storage;b=[];m=[];e=/sync_(word|sent|user)/gi;p=a.restoreContent;0===a.readClass.length&&0===a.readId.length&&rspkr.HL.Restore.getReadData();
if(0<a.readClass.length)for(f=0;f<a.readClass.length;f++)h=$rs.get("."+a.readClass[f]),$rs.isArray(h)||(h=[h]),b.push(h);if(0<a.readId.length)for(f=0;f<a.readId.length;f++){for(h=0;h<a.readId[f].length;h++)m.push($rs.get("#"+a.readId[f][h]));b.push(m);m=[]}0==a.readClass.length&&0==a.readId.length&&rspkr.log("ERR: Could not set restore content or find the read area data",3);a.restoreContent=[];for(f=0;f<b.length;f++){for(h=0;h<b[f].length;h++)!1===e.test(b[f][h].innerHTML)?m.push(b[f][h].innerHTML):
0<p.length?m.push(p[f][h]):m.push(b[f][h].innerHTML);a.restoreContent.push(m);m=[]}},getReadData:function(){rspkr.log("[rspkr.HL.Restore.getReadData]");for(var a=rspkr.HL.Restore.Storage,b=$rs.get("a"),e=0,f=b.length;e<f;e++)if(b[e].getAttribute("href")&&-1!==b[e].getAttribute("href").indexOf(rspkr.cfg.item("general.domain")+"/cgi-bin/"+rspkr.cfg.item("general.rsent"))&&"rsSaveBtn"!==b[e].id&&"rs_selimg"!==b[e].id)if(-1!==b[e].getAttribute("href").search(/readclass=/)){for(var h=b[e].getAttribute("href").match(/readclass=[^&]+/gi)[0].replace("readclass=",
""),m=h.split(","),h=[],p=0;p<m.length;p++)h.push(m[p]);rspkr.HL.Restore.Storage.readClass.push(h)}else if(-1!==b[e].getAttribute("href").search(/readid=/)){h=b[e].getAttribute("href").match(/readid=[^&]+/gi)[0].replace("readid=","");m=h.split(",");h=[];for(p=0;p<m.length;p++)h.push(m[p]);rspkr.HL.Restore.Storage.readId.push(h)}0===a.readClass.length&&0===a.readId.length&&(rspkr.c.data.params.hasOwnProperty("readid")?a.readId.push([rspkr.c.data.params.readid]):rspkr.c.data.params.hasOwnProperty("readclass")&&
a.readClass.push([rspkr.c.data.params.readclass]))}},Scroll:{currentSpan:null,timer:null,useScroll:!1,userScrollTimer:null,stopped:!0,getScrollY:function(){var a=0;"number"==typeof document.pageYOffset?a=document.pageYOffset:document.documentElement&&document.documentElement.scrollTop&&0<document.documentElement.scrollTop?a=document.documentElement.scrollTop:document.body&&document.body.scrollTop&&(a=document.body.scrollTop);return a},getWindowHeight:function(){var a=0;"number"==typeof window.innerHeight?
a=window.innerHeight:document.documentElement&&document.documentElement.clientHeight&&0<document.documentElement.clientHeight?a=document.documentElement.clientHeight:document.body&&document.body.clientHeight&&(a=document.body.clientHeight);return a+30},userScroll:function(){rspkr.HL.Scroll.timer&&(clearTimeout(rspkr.HL.Scroll.timer),rspkr.HL.Scroll.timer=null);rspkr.HL.Scroll.userScrollTimer&&clearTimeout(rspkr.HL.Scroll.userScrollTimer);rspkr.HL.Scroll.userScrollTimer=setTimeout(function(){rspkr.HL.Scroll.userScrollTimer=
null},5E3)},stopTimer:function(){rspkr.log("[rspkr.Hl.Scroll.stopTimer] Called!");rspkr.HL.Scroll.timer&&(clearTimeout(rspkr.HL.Scroll.timer),rspkr.HL.Scroll.timer=null);rspkr.HL.Scroll.stopped=!0},initScroll:function(){"scrollon"==rspkr.Common.Settings.get("hlscroll")?(rspkr.log("[rspkr.HL.Sroll.initScroll] Scroll initiated!"),rspkr.HL.Scroll.useScroll=!0,rspkr.evt("onUIClosePlayer",rspkr.HL.Scroll.stopTimer),rspkr.evt("onUIStop",rspkr.HL.Scroll.stopTimer),rspkr.evt("onUIPause",rspkr.HL.Scroll.stopTimer),
rspkr.evt("onUISliderMove",rspkr.HL.Scroll.userScroll),rspkr.evt("onFocusIn",rspkr.HL.Scroll.userScroll),rspkr.evt("onFocusOut",rspkr.HL.Scroll.userScroll),document.addEventListener?document.addEventListener("scroll",function(){setTimeout(function(){rspkr.HL.Scroll.userScroll()},0)},!1):document.attachEvent?document.attachEvent("onscroll",rspkr.HL.Scroll.userScroll):document.onscroll=rspkr.HL.Scroll.userScroll):this.useScroll=!1},execScroll:function(a){this.useScroll&&(this.currentSpan=a,!0===this.stopped&&
(this.stopped=!1),this.timer||(rspkr.log("[rspkr.hl.Scroll] execScroll"),this.timer=setTimeout(function(){rspkr.HL.Scroll.timer=null;rspkr.HL.Scroll.triggerScroll(rspkr.HL.Scroll.currentSpan)},500)))},triggerScroll:function(a){rspkr.log("[rspkr.HL.Scroll.triggerScroll] timer: "+rspkr.hl.Scroll.userScrollTimer+", stopped: "+rspkr.HL.Scroll.stopped);rspkr.HL.Scroll.userScrollTimer||!1!==rspkr.HL.Scroll.stopped||rspkr.u.scroll.scrollToElm(a)}},State:{CURRENT:1,READY:1,STOPPED:2,PLAYING:3,RELOAD:4,setState:function(a){this.CURRENT=
a;rspkr.log("[rspkr.hl.html5.States.setState] Changing state from "+this.CURRENT+" to "+a,1)}},sync:{init:function(){rspkr.c.dispatchEvent("onBeforeSyncInit",window);h.hlChanged=!1;if(0<rspkr.Common.data.selectedText.length||0<rspkr.Common.data.selectedHTML.length)rspkr.log("[rspkr.HL._sync.init] client markup"),rspkr.HL.Type.CURRENT=rspkr.HL.Type.CLIENT_MARKUP,b.firstRun=1,"explorer"==a?document.selection.empty():b.preProcess.identifyElementsReplacementNode(document.body),rspkr.HL.markedUpHTML.length=
0;else if(rspkr.log("[rspkr.HL._sync.init] server markup"),rspkr.HL.Type.CURRENT=rspkr.HL.Type.SERVER_MARKUP,"none"!=rspkr.Common.data.sync){var c=[],e=[];if(rspkr.c.data.params.hasOwnProperty("readclass")){for(var f=0;f<rspkr.HL.markedUpHTML.length;f++){var n=document.createElement("DIV");n.innerHTML=rspkr.HL.markedUpHTML[f];e.push(n)}c=$rs.get("."+rspkr.c.data.params.readclass.split(",").join(",."))}else if(rspkr.c.data.params.hasOwnProperty("readid")&&"flash"==rspkr.PlayerAPI.adapter)n=document.createElement("DIV"),
n.innerHTML=rspkr.HL.markedUpHTML.join(""),e.push(n),f=rspkr.c.data.params.readid.split(",")[0],c.push($rs.get("#"+f));else if(rspkr.c.data.params.hasOwnProperty("readid")){for(f=0;f<rspkr.HL.markedUpHTML.length;f++)n=document.createElement("DIV"),n.innerHTML=rspkr.HL.markedUpHTML[f],e.push(n);c=$rs.get("#"+rspkr.c.data.params.readid.split(",").join(",#"))}$rs.isArray(c)||(c=[c]);rspkr.log("[rspkr.HL.sync.init] readElements length: "+c.length);rspkr.c.dispatchEvent("onBeforeContentChange",window);
if(!rspkr.cfg.item("general.premarkup")){for(f=0;f<c.length;f++)rspkr.HL.Preserve.moveToShelter(c[f]),c[f].innerHTML=e[f].innerHTML,rspkr.HL.Preserve.restoreFromShelter(c[f]);rspkr.c.dispatchEvent("onAfterContentChange",window);rspkr.HL.Preserve.clearShelter();rspkr.HL.markedUpHTML.length=0}}else rspkr.HL.markedUpHTML.length=0;rspkr.c.post.removeIframe();rspkr.c.dispatchEvent("onAfterSyncInit",window)},lightCleanUp:function(){rspkr.HL.customHL&&rspkr.HL.customHL.active()&&rspkr.HL.customHL.cleanUp();
rspkr.log("[rspkr.HL._sync.lightCleanUp] Called! "+rspkr.HL.Type.CURRENT);rspkr.HL.Type.CURRENT==rspkr.HL.Type.CLIENT_MARKUP&&!0===h.hlChanged?b.postProcess.settingsCleanUp():rspkr.HL.Type.CURRENT==rspkr.HL.Type.CLIENT_MARKUP&&!1===h.hlChanged||0<rspkr.Common.data.selectedText.length?b.postProcess.lightCleanUp():rspkr.HL.Type.CURRENT==rspkr.HL.Type.SERVER_MARKUP&&f.postProcess.lightCleanUp()},fullCleanUp:function(){rspkr.HL.customHL&&rspkr.HL.customHL.active()&&rspkr.HL.customHL.cleanUp();rspkr.log("[rspkr.HL._sync.fullCleanUp] Called!");
rspkr.HL.Type.CURRENT==rspkr.HL.Type.CLIENT_MARKUP&&b.postProcess.fullCleanUp();f.postProcess.fullCleanUp()},setId:function(a){rspkr.log("[rspkr.HL._sync.setId] Called!")},setClass:function(a){rspkr.log("[rspkr.HL._sync.setClass] Called!")},setContent:function(a){rspkr.log("[rspkr.HL._sync.setContent] Called!");rspkr.HL.markedUpHTML.push(a)},execute:function(a,b){var e=rspkr.Common.Settings;if("none"!==e.get("hl")&&"hloff"!==e.get("hltoggle")){if(rspkr.HL.Type.CURRENT==rspkr.HL.Type.SERVER_MARKUP){var f=
$rs.hasClass($rs.get("#sync"+b),"sync_sent")?"sent":"word";if("sent"===e.get("hl")&&"word"===f||"word"===e.get("hl")&&"sent"===f)return}rspkr.c.dispatchEvent("onBeforeSync",window,[a,b]);rspkr.HL.Type.CURRENT==rspkr.HL.Type.CLIENT_MARKUP?(e=rspkr.cfg.item("general.selectionEngine"),!e||"new"!==e&&"newcontent"!==e?rspkr.HL.clientMarkup.sync(a,b):rspkr.HL.clientMarkup.syncNew(a,b)):rspkr.HL.serverMarkup.sync(a,b);rspkr.c.dispatchEvent("onAfterSync",window,[a,b])}}},settings:h,Type:{CURRENT:0,DEFAULT:0,
SERVER_MARKUP:1,CLIENT_MARKUP:2}}}();rspkr.HL.engine||(rspkr.HL.engine={});
rspkr.HL.engine.explorer=function(){return{clientExtension:{firstRun:0,previousWord:{},previousSent:{},selectionRange:null,selectionHTML:null,selectedWordsRange:[],wordsRangeClasses:[],originalParentContent:"",originalParent:null,preProcess:{bookMarkIndex:1,endNode:null,endOffset:null,excludednodes:"table tr select option textarea ul ol dl thead tbody tfoot colgroup script map optgroup style noscript".split(" "),firstRun:0,inc:0,numberOfSelections:0,startNode:null,startOffset:null,init:function(){this.numberOfSelections++;
var a;a="new"===rspkr.cfg.item("general.selectionEngine")||"newcontent"===rspkr.cfg.item("general.selectionEngine")?this.buildMarkupNew(rspkr.Common.data.selectedRange):this.buildMarkup(rspkr.Common.data.selectedRange);a.replace(/  +/g," ");rspkr.Common.data.selectedHTML=a;rspkr.hl.clientMarkup.originalParent=rspkr.c.data.selectedRange.parentElement();rspkr.hl.clientMarkup.originalParentContent=rspkr.c.data.selectedRange.parentElement().innerHTML},buildMarkup:function(a){for(var b=rspkr.c.data.getParam("lang"),
f=!1,e=null,h=rspkr.cfg.item("general.sentOnlyLang"),c=0;c<h.length;c++)if(b&&b.toLowerCase()===h[c]){f=!0;break}var b=a.duplicate(),c=0,h="",g=1,l=0,n=0,k="",m="",p=null;a.moveStart("word",-1);a.moveStart("word",1);b.isEqual(a)||a.moveStart("word",-1);b=a.duplicate();a.moveEnd("word",1);a.moveEnd("word",-1);b.isEqual(a)||a.moveEnd("word",1);rspkr.HL.clientMarkup.selectionRange=a.duplicate();var q=a.parentElement(),t=a.duplicate();t.collapse(!1);b=a.duplicate();b.collapse();for(f&&(e=a.text.split(new RegExp(decodeURIComponent("%e3%80%81")+
"|"+decodeURIComponent("%e3%80%82")+"|"+decodeURIComponent("%DB%94")+"|"+decodeURIComponent("%D8%8C")+"||\\s|\\n")));a.inRange(b)&&0!=a.compareEndPoints("EndToEnd",b);){n++;c++;if(1E4<c)break;if(f)if(b=a.duplicate(),e[n-1])b.findText(e[n-1]);else break;else b.collapse(!1),b.expand("word",1);m=k="";t.collapse(!1);var r=b.duplicate();r.collapse(!1);if(0==t.compareEndPoints("StartToStart",r)&&0==t.compareEndPoints("EndToEnd",r)&&r.htmlText==t.htmlText){l++;if(2>l)b.move("character",1);else if(4>l)b.move("character",
2);else if(6>l)b.move("word",1);else if(8>l)b.move("word",2);else if(10>l)b.move("sentence",1);else if(12>l)b.move("sentence",2);else break;b.collapse(!1)}else{l=0;if(-1===n)return b;rspkr.HL.clientMarkup.selectedWordsRange[n]=b.duplicate();t=b.text;r=b.htmlText;b.collapse(!1);var w;1===g?(p=b.duplicate(),w=this.iterateParentTree(p.parentElement(),document.body,q,0)):w=this.iterateParentTree(b.parentElement(),p.parentElement(),q,0);for(var x=this.iterateParentTree(p.parentElement(),b.parentElement(),
q,0),u=b.parentElement(),v=0;v<w&&20>v;v++)u.className.match("sync_")||(k=u.outerHTML.match("<[^>]*>")[0]+k),u=u.parentElement;u=p.parentElement();for(v=0;v<x&&20>v;v++)u.className.match("sync_")||(m+="</"+u.tagName+">"),u=u.parentElement;if(0!=w||0!=x)p=b.duplicate();1===g?(h+=k,g=0):h+=m+k;""!=r.replace("sync_sent_highlighted","")&&(h+="<"+rspkr.Common.data.browser.syncContainer+' class="sync_user" id="sync'+n+'">'+t+"</"+rspkr.Common.data.browser.syncContainer+">");t=b.duplicate()}}h+="\x3c!-- f --\x3e";
x=this.iterateParentTree(p.parentElement(),document.body,q,0);u=p.parentElement();for(v=0;v<x;v++)u.className.match("sync_")||(h+="</"+u.tagName+">"),u=u.parentElement;b.collapse();return h},buildMarkupNew:function(a){for(var b=rspkr.c.data.getParam("lang"),f=!1,e=rspkr.cfg.item("general.sentOnlyLang"),h=0;h<e.length;h++)if(b&&b.toLowerCase()===e[h]){f=!0;break}var b=a.duplicate(),e="",c=1,g=0,l=0,n="",k="",m="",p=null,h=0;rspkr.HL.clientMarkup.selectionRange=a.duplicate();var q=a.parentElement(),
t=a.duplicate(),n=a.duplicate();t.collapse(!1);b.collapse();var r=[],k=n.duplicate(),m=n.duplicate();n.moveStart("sentence",-1);n.moveStart("sentence",1);k.isEqual(n)||n.moveStart("sentence",-1);k=n.duplicate();n.moveEnd("sentence",1);n.moveEnd("sentence",-1);k.isEqual(n)||n.moveEnd("sentence",1);k=n.duplicate();m.collapse(!0);for(n.collapse(!0);k.inRange(n)&&0!=k.compareEndPoints("EndToEnd",n);){m.expand("sentence",1);if(!0===m.isEqual(n)||0===m.compareEndPoints("EndToEnd",n))break;n.expand("sentence",
1);r.push(m.duplicate())}for(;!1===a.inRange(r[0])&&0!=a.compareEndPoints("StartToStart",r[0]);)r[0].moveStart("word",1);for(;!1===a.inRange(r[r.length-1])&&0!=a.compareEndPoints("EndToEnd",r[r.length-1]);)r[r.length-1].moveEnd("word",-1);for(var w=0;w<r.length;w++){for(m="";r[w].inRange(b)&&0!=r[w].compareEndPoints("EndToEnd",b);){l++;h++;if(1E4<h)break;f?(b=a.duplicate(),b.findText(null[l-1])):(b.collapse(!1),b.expand("word",1));k=n="";t.collapse(!1);var x=b.duplicate();x.collapse(!1);if(0==t.compareEndPoints("StartToStart",
x)&&0==t.compareEndPoints("EndToEnd",x)&&x.htmlText==t.htmlText){g++;if(2>g)b.move("character",1);else if(4>g)b.move("character",2);else if(6>g)b.move("word",1);else if(8>g)b.move("word",2);else if(10>g)b.move("sentence",1);else if(12>g)b.move("sentence",2);else break;b.collapse(!1)}else{g=0;if(-1===l)return b;rspkr.HL.clientMarkup.selectedWordsRange[l]=b.duplicate();rspkr.HL.clientMarkup.wordsRangeClasses[l]="word";t=b.text;x=b.htmlText;b.collapse(!1);var u;1===c?(p=b.duplicate(),u=this.iterateParentTree(p.parentElement(),
document.body,q,0)):u=this.iterateParentTree(b.parentElement(),p.parentElement(),q,0);for(var v=this.iterateParentTree(p.parentElement(),b.parentElement(),q,0),y=b.parentElement(),z=0;z<u&&20>z;z++)y.className.match("sync_")||(n=y.outerHTML.match("<[^>]*>")[0]+n),y=y.parentElement;y=p.parentElement();for(z=0;z<v&&20>z;z++)y.className.match("sync_")||(k+="</"+y.tagName+">"),y=y.parentElement;if(0!=u||0!=v)p=b.duplicate();1===c?(m+=n,c=0):m+=k+n;""!=x.replace("sync_sent_highlighted","")&&(m+="<"+rspkr.Common.data.browser.syncContainer+
' class="sync_user sync_word" id="sync'+l+'">'+t+"</"+rspkr.Common.data.browser.syncContainer+">");t=b.duplicate()}}l++;rspkr.HL.clientMarkup.selectedWordsRange[l]=r[w];rspkr.HL.clientMarkup.wordsRangeClasses[l]="sent";e+="<"+rspkr.Common.data.browser.syncContainer+' class="sync_user sync_sent" id="sync'+l+'">';e+=m;e+="</"+rspkr.Common.data.browser.syncContainer+">\n"}v=this.iterateParentTree(p.parentElement(),document.body,q,0);y=p.parentElement();for(z=0;z<v;z++)y.className.match("sync_")||(e+=
"</"+y.tagName+">"),y=y.parentElement;b.collapse();return e},iterateParentTree:function(a,b,f,e){for(var h=b;null!==h;){if(a==f||a==h)return e;h=h.parentElement}e++;return this.iterateParentTree(a.parentElement,b,f,e)}},postProcess:{lightCleanUp:function(){rspkr.log("[clientMarkup.postProcess.lightCleanUp] called!");for(var a=document.getElementsByTagName(rspkr.Common.data.browser.syncContainer),b=a.length-1;-1<b;b--)a[b].className=a[b].className.replace("sync_sent_highlighted","sync_sent"),a[b].className=
a[b].className.replace("sync_word_highlighted","sync_word"),-1===a[b].className.toLowerCase().indexOf("sync_user")&&(a[b].removeAttribute("id"),a[b].removeAttribute("color"));var a=rspkr.HL.clientMarkup.previousWord.range,f=rspkr.HL.clientMarkup.previousWord.forecolor,e=rspkr.HL.clientMarkup.previousWord.backcolor,h=rspkr.HL.clientMarkup.previousSent.range,c=rspkr.HL.clientMarkup.previousSent.forecolor,g=rspkr.HL.clientMarkup.previousSent.backcolor;if(0<a.length)for(var b=0,l=a.length;b<l;b++)null!==
e[b]&&(a[b].execCommand("backcolor",0,e[b]),null!==f[b]&&a[b]&&a[b].execCommand("forecolor",0,f[b]));if(0<h.length)for(b=0,l=h.length;b<l;b++)null!==g[b]&&(h[b].execCommand("backcolor",0,g[b]),null!==c[b]&&h[b]&&h[b].execCommand("forecolor",0,c[b]));rspkr.hl.clientMarkup.lastWord=null},settingsCleanUp:function(){this.lightCleanUp()},fullCleanUp:function(){rspkr.log("[ClientMarkup.postProcess.fullCleanUp] called!");if(null===rspkr.hl.clientMarkup.originalParent)this.lightCleanUp();else{var a=rspkr.hl.clientMarkup.originalParent;
rspkr.hl.Preserve.moveToShelter(a);a.innerHTML=rspkr.hl.clientMarkup.originalParentContent;rspkr.hl.Preserve.restoreFromShelter(a)}rspkr.hl.clientMarkup.selectedWordsRange=[];rspkr.hl.clientMarkup.selectionRange=null;rspkr.hl.clientMarkup.originalParentContent="";rspkr.hl.clientMarkup.originalParent=null;rspkr.hl.clientMarkup.lastWord=null}},sync:function(a,b){var f=!1,e;0===(a&2)&&(f=0!=(a&1)?!0:!1);1===this.firstRun&&(this.previousWord.range=[],this.previousWord.backcolor=[],this.previousWord.forecolor=
[],this.previousSent.range=[],this.previousSent.backcolor=[],this.previousSent.forecolor=[]);e=this.selectedWordsRange[b];if(1===this.firstRun){this.firstRun=0;if(0<this.previousSent.range.length){for(var h=0,c=this.previousSent.range.length;h<c;h++)this.previousSent.range[h].execCommand("backcolor",0,this.previousSent.backcolor[h]),null!==this.previousSent.forecolor[h]&&this.previousSent.range[h].execCommand("forecolor",0,this.previousSent.forecolor[h]);this.previousSent.range=[];this.previousSent.backcolor=
[];this.previousSent.forecolor=[]}rspkr.HL.clientMarkup.selectionRange&&"wordsent"===rspkr.st.get("hl")&&(this.previousSent.range.push(rspkr.HL.clientMarkup.selectionRange),this.previousSent.backcolor.push(rspkr.HL.clientMarkup.selectionRange.queryCommandValue("backcolor")),this.previousSent.forecolor.push(rspkr.HL.clientMarkup.selectionRange.queryCommandValue("forecolor")),this.selectionRange.execCommand("backcolor",0,rspkr.Common.Settings.get("hlsent")),this.selectionRange.execCommand("forecolor",
0,rspkr.Common.Settings.get("hltext")))}if(!f&&0<this.previousWord.range.length){for(h=0;h<this.previousWord.range.length;h++)"word"==rspkr.st.get("hl")||"sent"==rspkr.st.get("hl")?this.previousWord.range[h].execCommand("backcolor",0,this.previousWord.backcolor[h]):this.previousWord.range[h].execCommand("backcolor",0,rspkr.Common.Settings.get("hlsent")),this.previousWord.range[h].execCommand("forecolor",0,this.previousWord.forecolor[h]);this.previousWord.range=[];this.previousWord.backcolor=[];this.previousWord.forecolor=
[]}this.previousWord.backcolor.push(e.queryCommandValue("backcolor"));this.previousWord.forecolor.push(e.queryCommandValue("forecolor"));this.previousWord.range.push(e);"sent"==rspkr.st.get("hl")?rspkr.HL.customHL&&rspkr.HL.customHL.active()?rspkr.HL.customHL.sentHL(e,a):e.execCommand("backcolor",0,rspkr.Common.Settings.get("hlsent")):rspkr.HL.customHL&&rspkr.HL.customHL.active()?rspkr.HL.customHL.wordHL(e,a):e.execCommand("backcolor",0,rspkr.Common.Settings.get("hlword"));this.lastWord=e;rspkr.HL.customHL&&
rspkr.HL.customHL.active()||e.execCommand("forecolor",0,rspkr.Common.Settings.get("hltext"))},syncNew:function(a,b){var f=!1;0===(a&2)&&(f=0!=(a&1)?!0:!1);1===this.firstRun&&(this.previousWord.range=[],this.previousWord.backcolor=[],this.previousWord.forecolor=[],this.previousSent.range=[],this.previousSent.backcolor=[],this.previousSent.forecolor=[],this.firstRun=0);var e=this.selectedWordsRange[b];if(e&&"word"===this.wordsRangeClasses[b]&&("word"==rspkr.st.get("hl")||"wordsent"==rspkr.st.get("hl"))){if(0<
this.previousWord.range.length&&!f){for(f=0;f<this.previousWord.range.length;f++)"word"==rspkr.st.get("hl")||"sent"==rspkr.st.get("hl")?this.previousWord.range[f].execCommand("backcolor",0,this.previousWord.backcolor[f]):this.previousWord.range[f].execCommand("backcolor",0,rspkr.Common.Settings.get("hlsent")),this.previousWord.range[f].execCommand("forecolor",0,this.previousWord.forecolor[f]);this.previousWord.range=[];this.previousWord.backcolor=[];this.previousWord.forecolor=[]}this.previousWord.backcolor.push(e.queryCommandValue("backcolor"));
this.previousWord.forecolor.push(e.queryCommandValue("forecolor"));this.previousWord.range.push(e);e.execCommand("backcolor",0,rspkr.Common.Settings.get("hlword"));this.lastWord=e;e.execCommand("forecolor",0,rspkr.Common.Settings.get("hltext"))}else if(e&&"sent"===this.wordsRangeClasses[b]&&("sent"==rspkr.st.get("hl")||"wordsent"==rspkr.st.get("hl"))){if(0<this.previousWord.range.length){for(f=0;f<this.previousWord.range.length;f++)this.previousWord.range[f].execCommand("backcolor",0,this.previousWord.backcolor[f]),
this.previousWord.range[f].execCommand("forecolor",0,this.previousWord.forecolor[f]);this.previousWord.range=[];this.previousWord.backcolor=[];this.previousWord.forecolor=[]}if(0<this.previousSent.range.length){for(f=0;f<this.previousSent.range.length;f++)this.previousSent.range[f].execCommand("backcolor",0,this.previousSent.backcolor[f]),this.previousSent.range[f].execCommand("forecolor",0,this.previousSent.forecolor[f]);this.previousSent.range=[];this.previousSent.backcolor=[];this.previousSent.forecolor=
[]}this.previousSent.backcolor.push(e.queryCommandValue("backcolor"));this.previousSent.forecolor.push(e.queryCommandValue("forecolor"));this.previousSent.range.push(e);e.execCommand("backcolor",0,rspkr.Common.Settings.get("hlsent"));e.execCommand("forecolor",0,rspkr.Common.Settings.get("hltext"))}}}}}();
rspkr.HL.engine.gecko=function(){return{clientExtension:{preProcess:{bookMarkIndex:1,endNode:null,endOffset:null,excludednodes:"table tr select option textarea ul ol dl thead tbody tfoot colgroup script map optgroup style noscript".split(" "),firstRun:0,inc:0,numberOfSelections:0,startNode:null,startOffset:null,init:function(){this.numberOfSelections++;var a="",a=rspkr.Common.data.selectedRange;this.startNode=a.startContainer;this.endNode=a.endContainer;this.startOffset=this.modifyOffsetStartOfWord(this.startNode,
a.startOffset);this.endOffset=this.modifyOffsetEndOfWord(this.endNode,a.endOffset);a=this.buildMarkup(a.commonAncestorContainer);a.replace(/  +/g," ");window.getSelection().removeAllRanges();rspkr.Common.data.selectedHTML=a},buildMarkup:function(a){this.firstRun=1;var b="",f=this.inc;if(3==a.nodeType)b+=this.textMarkup(a);else{var e,h="";if(a.hasChildNodes())for(e=0;e<a.childNodes.length;e++){var c=a.childNodes.item(e);c==this.startNode&&(this.inc=1);a==this.startNode&&e==this.startOffset&&(this.inc=
1);8!=c.nodeType&&(h+=this.buildMarkup(c));if(a==this.endNode&&e==this.endOffset){this.inc=0;break}if(c==this.endNode){this.inc=0;break}}!f&&!this.inc||a.className&&(a.className.replace("sync")!==a.className||a.id.replace("sync")!==a.id)?b+=h:(f=document.createElement("div"),f.appendChild(a.cloneNode(!0)),tempdivtag=f.innerHTML.match("<[^>]*>"),null!==tempdivtag&&0<tempdivtag.length?(b+=tempdivtag[0],b=b+h+("</"+a.nodeName+">")):b+=h);if(a.hasChildNodes())for(e=0;e<a.childNodes.length;e++){if(a===
this.endNode&&e===this.endOffset){this.inc=0;break}if(c===this.endNode){this.inc=0;break}}}return b},textMarkup:function(a){var b=!0,f="",e,h="",c="",g=a.nodeValue;a===this.startNode&&-1!==this.startOffset&&a===this.endNode&&-1!==this.endOffset?(h=a.nodeValue.substring(0,this.startOffset),g=a.nodeValue.substring(this.startOffset,this.endOffset),c=a.nodeValue.substring(this.endOffset),this.inc=1):a===this.startNode&&-1!==this.startOffset?(h=a.nodeValue.substring(0,this.startOffset),g=a.nodeValue.substring(this.startOffset),
this.inc=1):a===this.endNode&&-1!==this.endOffset&&(g=a.nodeValue.substring(0,this.endOffset),c=a.nodeValue.substring(this.endOffset),this.inc=1);if(!this.inc)return"";for(e=0;e<this.excludednodes.length;e++)if(a.parentNode&&a.parentNode.nodeName.toLowerCase()===this.excludednodes[e]){b=!1;f=this.htmlencode(g);break}b&&(f=rspkr.cfg.item("general.selectionEngine"),f=!f||"new"!==f&&"newcontent"!==f?this.markupSentences(this.htmlencode(g),null):this.markupSentencesNew(this.htmlencode(g),null));a===this.endNode&&
-1!==this.endOffset&&(this.inc=0);if(rs.cfg.item("general.enableSkipAlways")){e=a;for(var l=!1;e.parentNode;){if(/rs_skip_always/i.test(e.className)){l=!0;break}e=e.parentNode}l&&(f='<span class="rs_skip_always">'+f+"</span>")}b&&null!==a.parentNode&&""!==g&&(b=this.createreplacementnode(h+f+c,getComputedStyle(a.parentNode,null)),a.parentNode.insertBefore(b,a),a.parentNode.removeChild(a));return f},markupSentencesNew:function(a){a=this.splitString(a,[", ",". ","! ","? ",decodeURIComponent("%e3%80%81"),
decodeURIComponent("%e3%80%82"),decodeURIComponent("%DB%94"),decodeURIComponent("%D8%8C")]);if(!a)return"";for(var b="",f="",e=!1,h=0;h<a.length;h++)b+="<"+rspkr.Common.data.browser.syncContainer+' class="sync_user sync_sent cj'+this.numberOfSelections+'" ',b+='id="sync'+this.bookMarkIndex++ +'">',this.endsWithSpace(a[h])?(e=!0,f=a[h].slice(0,-1)):f=a[h],b+=this.markupWords(f),b+="</"+rspkr.Common.data.browser.syncContainer+">",!0===e&&(b+=" "),e=!1;return b},markupSentences:function(a){a=this.splitString(a,
[", ",". ","! ","? ",decodeURIComponent("%e3%80%81"),decodeURIComponent("%e3%80%82"),decodeURIComponent("%DB%94"),decodeURIComponent("%D8%8C")]);if(!a)return"";for(var b="",f="",e=!1,h=0;h<a.length;h++)b+="<"+rspkr.Common.data.browser.syncContainer+' class="ffsent'+this.numberOfSelections+" cj"+this.numberOfSelections+'" ',b+='id="sync'+this.bookMarkIndex++ +'">',this.endsWithSpace(a[h])?(e=!0,f=a[h].slice(0,-1)):f=a[h],b+=this.markupWords(f),!0===e&&(b+=" "),b+="</"+rspkr.Common.data.browser.syncContainer+
">",e=!1;return b},markupWords:function(a){a=this.splitString(a," ");if(!a)return"";for(var b="",f="",e=!1,h=0;h<a.length;h++)b+="<"+rspkr.Common.data.browser.syncContainer+' class="sync_user sync_word ck'+this.numberOfSelections+'"',b+=' id="sync'+this.bookMarkIndex++ +'">',this.endsWithSpace(a[h])?(e=!0,f=a[h].slice(0,-1)):f=a[h],b+=f,b+="</"+rspkr.Common.data.browser.syncContainer+">",!0===e&&(b+=" "),e=!1;return b},trim:function(a){return a.replace(/^\s+|\s+$/g,"")},htmlencode:function(a){var b=
document.createElement("div");a=document.createTextNode(a);b.appendChild(a);return b.innerHTML},identifyElementsReplacementNode:function(a){a.tagName&&a.tagName.toLowerCase()==rspkr.Common.data.browser.syncContainer&&a.id&&(rspkr.HL.clientMarkup.selectedWordsRange[a.id]=a);if(a.hasChildNodes())for(var b=0;b<a.childNodes.length;b++)this.identifyElementsReplacementNode(a.childNodes[b])},createreplacementnode:function(a,b){var f=document.createElement(rspkr.Common.data.browser.syncContainer);f.innerHTML=
a;f.setAttribute("class","synctemp cl"+this.numberOfSelections);return f},modifyOffsetStartOfWord:function(a,b){for(var f=[" ",", ",". ","! ","? ",decodeURIComponent("%e3%80%81"),decodeURIComponent("%e3%80%82"),decodeURIComponent("%DB%94"),decodeURIComponent("%D8%8C")];a.nodeValue&&0!=b;){for(var e=0;e<f.length;e++)if(breakstr=f[e],0==a.nodeValue.substring(b).indexOf(breakstr))return b;b--}return b},modifyOffsetEndOfWord:function(a,b){for(var f=[" ",", ",". ","! ","? ",decodeURIComponent("%e3%80%81"),
decodeURIComponent("%e3%80%82"),decodeURIComponent("%DB%94"),decodeURIComponent("%D8%8C")];a.nodeValue&&b!=a.nodeValue.length;){for(var e=0;e<f.length;e++)if(breakstr=f[e],0==a.nodeValue.substring(b-1).indexOf(breakstr))return b;b++}return b},returnClassArraySubstring:function(a){var b=document.getElementsByTagName("*"),f=0,e=[];for(i=0;i<b.length;i++)"undefined"!=typeof b[i].className&&b[i].className.replace(a,"")!=b[i].className&&(e[f]=b[i],f++);return e},splitString:function(a,b){for(var f=[""],
e=0,h=0;h<a.length;h++){for(var c=0;c<b.length;c++){for(var g=b[c],l=!0,n=0;n<g.length;n++)if(0>a.length-(h+n)||g[g.length-n-1]!=a[h-n-1]){l=!1;break}l&&(e++,f[e]="")}f[e]+=a[h]}return f},endsWithSpace:function(a){return-1!==a.indexOf(" ",a.length-1)}},postProcess:{cleanUpSpans:function(){rspkr.log("[ClientMarkup.postProcess.cleanUpSpans] called!");var a=document.getElementsByTagName(rspkr.Common.data.browser.syncContainer),b;for(i=a.length-1;-1<i;i--)b=document.createDocumentFragment(),b.textContent=
a[i].textContent,a[i].parentNode.replaceChild(b,a[i])},lightCleanUp:function(){rspkr.log("[ClientMarkup.postProcess.lightCleanUp] called!!");var a=document.getElementsByTagName(rspkr.Common.data.browser.syncContainer);for(i=a.length-1;-1<i;i--)a[i].className=a[i].className.replace("sync_sent_highlighted","sync_sent"),a[i].className=a[i].className.replace("sync_word_highlighted","sync_word"),-1===a[i].className.toLowerCase().indexOf("sync_user")&&a[i].removeAttribute("id")},settingsCleanUp:function(){rspkr.log("[ClientMarkup.postProcess.settingsCleanUp] called!");
var a=rspkr.HL.clientMarkup.previousWord.element,b=rspkr.HL.clientMarkup.previousWord.className,f=rspkr.HL.clientMarkup.previousSent.element,e=rspkr.HL.clientMarkup.previousSent.className;if(0<a.length){for(var h in a)a[h].className=b[h];rspkr.HL.clientMarkup.previousWord.element=[];rspkr.HL.clientMarkup.previousWord.className=[]}if(0<f.length){for(h in f)f[h].className=e[h];rspkr.HL.clientMarkup.previousSent.element=[];rspkr.HL.clientMarkup.previousSent.className=[]}},fullCleanUp:function(){rspkr.log("[ClientMarkup.postProcess.fullCleanUp] called!");
var a=rspkr.HL.clientMarkup.previousWord.element,b=rspkr.HL.clientMarkup.previousWord.className,f=rspkr.HL.clientMarkup.previousSent.element,e=rspkr.HL.clientMarkup.previousSent.className;if(0<a.length){for(var h in a)a[h].className=b[h];rspkr.HL.clientMarkup.previousWord.element=[];rspkr.HL.clientMarkup.previousWord.className=[]}if(0<f.length){for(h in f)f[h].className=e[h];rspkr.HL.clientMarkup.previousSent.element=[];rspkr.HL.clientMarkup.previousSent.className=[]}this.cleanUpSpans();rspkr.Common.data.selectedHTML=
""}},sync:function(a,b){var f=!1,e;0==(a&2)&&(f=0!=(a&1)?!0:!1);1==this.firstRun&&(this.previousWord.element=[],this.previousWord.className=[],this.previousSent.element=[],this.previousSent.className=[]);e=this.selectedWordsRange["sync"+b];if(e.className.replace("word","")!=e.className){rspkr.log("inside");if(0<this.previousWord.element.length&&0<this.previousWord.className.length&&!f){for(f=0;f<this.previousWord.element.length;f++)this.previousWord.element[f].className=this.previousWord.className[f];
this.previousWord.element=[];this.previousWord.className=[]}this.previousWord.element.push(e);this.previousWord.className.push(e.className);"sent"===rspkr.st.get("hl")?e.className="sync_user sync_sent_highlighted":rspkr.HL.customHL&&rspkr.HL.customHL.active()?rspkr.HL.customHL.wordHL(e,a):e.className="sync_user sync_word_highlighted"}e&&rspkr.HL.Scroll.execScroll(e);if(1==this.firstRun){this.firstRun=0;if(0<this.previousSent.element.length){for(f=0;f<this.previousSent.element.length;f++)this.previousSent.element[f].className=
this.previousSent.className[f];this.previousSent.element=[];this.previousSent.className=[]}if("wordsent"==rspkr.st.get("hl"))for(e=this.preProcess.returnClassArraySubstring("ffsent"+this.preProcess.numberOfSelections+" "),f=0;f<e.length;f++)this.previousSent.element[f]=e[f],this.previousSent.className[f]=e[f].className,e[f].className="ffsent"+this.preProcess.numberOfSelections+" sync_sent_highlighted"}},syncNew:function(a,b){var f;1==this.firstRun&&(this.previousWord.element=[],this.previousWord.className=
[],this.previousSent.element=[],this.previousSent.className=[],this.firstRun=0);f=document.getElementById("sync"+b);if(f.className.replace("word","")!=f.className&&("word"===rspkr.st.get("hl")||"wordsent"===rspkr.st.get("hl"))){if(0<this.previousWord.element.length&&0<this.previousWord.className.length){for(var e=0;e<this.previousWord.element.length;e++)this.previousWord.element[e].className=this.previousWord.className[e];this.previousWord.element=[];this.previousWord.className=[]}this.previousWord.element.push(f);
this.previousWord.className.push(f.className);f.className="sync_user sync_word_highlighted"}else if(f.className.replace("sent","")!=f.className&&("sent"===rspkr.st.get("hl")||"wordsent"===rspkr.st.get("hl"))){if(0<this.previousSent.element.length&&0<this.previousSent.className.length){for(e=0;e<this.previousSent.element.length;e++)this.previousSent.element[e].className=this.previousSent.className[e];this.previousSent.element=[];this.previousSent.className=[]}this.previousSent.element.push(f);this.previousSent.className.push(f.className);
f.className="sync_user sync_sent_highlighted"}f&&rspkr.HL.Scroll.execScroll(f)}}}}();
ReadSpeaker.ui=function(){var a=null,b=[],f=[],e=!1,h=function(a){a=a||window.event;a.returnValue=!1;if(a=a.originalEvent)a.cancelBubble=!0,a.returnValue=!1;a&&a.preventDefault&&a.preventDefault();a&&a.stopPropagation&&a.stopPropagation()},c=function(){rspkr.log("[rspkr.ui] Attempting to add click events.");var a=$rs.get("."+rspkr.ui.rsbtnClass+" a.rsbtn_play"),b=null;$rs.isArray(a)||(a=[a]);for(var c=0,e=a.length;c<e;c++)if($rs.unregEvent(a[c],"click",ReadSpeakerDefer.clickhandler),b=a[c]?$rs.getAttr(a[c],
"data-rsevent-id"):"_bogus_",rspkr.l.f.eq.store[b]&&rspkr.l.f.eq.store[b].click)rspkr.log("[rspkr.ui] Click event already existed on "+a[c],2);else{$rs.regEvent(a[c],"click",function(a){h(a);window.readpage(this)});rspkr.ui.addFocusHandler(a[c],!0,a[c].parentNode);rspkr.log("[rspkr.ui] Added click event to: "+a[c],1);try{$rs.getAttr(a[c],"role")||$rs.setAttr(a[c],"role","button")}catch(f){rspkr.log("[rspkr.ui] Could not add role attribute.",2)}}},g=function(a){for(var b=$rs.get("a"),c=0,e=b.length;c<
e;c++)if(b[c].href&&b[c].href==a)return b[c];return!1},l=function(a){for(var c in b)if(b[c]&&b[c].getContainer&&b[c].getContainer()==a)return b[c];a=new rspkr.ui.Player(a);b.push(a);return a},n=function(){rspkr.log("[rspkr.ui] Initiating global callbacks");rspkr.ui.rsbtnClass=rspkr.cfg.item("ui.rsbtnClass")||"rsbtn";window.readpage=function(a,b){rspkr.ui.initrun&&rspkr.ui.showPlayer(a,b)};window.rshlexit=function(b){void 0!==b&&"false"!==b||a.stop();setTimeout(function(){rspkr.c.dispatchEvent("onAfterSyncExit",
window)},1E3)};window.rshlinit=A().sync.init;window.rshlsetContent=A().sync.setContent;window.rshlsetId=A().sync.setId;window.rshlsync=function(a,b){for(var c=a.split(","),e=b.split(","),f=0,g=a.length;f<g;f++)A().sync.execute(c[f],e[f])};var b=rspkr.c.data.browser;b&&(/iphone|ipad|ios|android/i.test(b.OS)||"android"==b.name.toLowerCase())?$rs.regEvent(document.body,"touchstart",function(a){rspkr.c.data.setSelectedText(a);return!0}):($rs.regEvent(document.body,"mousedown",function(a){rspkr.ui.setPointerPos(a);
return!0}),$rs.regEvent(document.body,"mouseup",function(a){"opera"===b.name.toLowerCase()?setTimeout(function(){rspkr.c.data.setSelectedText(a)},50):rspkr.c.data.setSelectedText(a);return!0}),$rs.regEvent(window,"mouseup",function(a){"opera"===b.name.toLowerCase()?setTimeout(function(){rspkr.c.data.setSelectedText(a)},50):rspkr.c.data.setSelectedText(a);return!0}),$rs.regEvent(document.body,"keydown",rspkr.ui.setPointerPos),$rs.regEvent(document.body,"keyup",function(a){rspkr.c.data.setSelectedText(a);
return!0}))},k=function(){document.removeEventListener?document.removeEventListener("click",window.ReadSpeakerDefer.clickhandler,!1):document.detachEvent&&document.detachEvent("onclick",window.ReadSpeakerDefer.clickhandler);if(ReadSpeakerDefer.deferred){var a=ReadSpeakerDefer.deferred,b=null;if("a"!=a.tagName.toLowerCase()){for(b=a;"body"!=b.tagName.toLowerCase()&&(b=b.parentNode,"a"!=b.tagName.toLowerCase()););a=b}ReadSpeakerDefer.isRSLink(a)&&(rspkr.log("[rspkr.ui] Activating deferred element: "+
a),$rs.removeClass(a.parentNode,"rsdeferred"),rspkr.ui.showPlayer(a));ReadSpeakerDefer.deferred=null}},m=function(b,c,e){rspkr.log("[rspkr.ui.showPlayer]");e=e||!1;var f="string"==typeof b?g(b):b,h=f?$rs.closest(f,".rsexpanded"):void 0;if(h&&!$rs.isArray(h)&&rspkr.ui.getActivePlayer())rspkr.log("Player already active, calling Player.restart() instead"),rspkr.ui.getActivePlayer().restart();else{rspkr.c.dispatchEvent("onBeforeParamsSet",window,[f]);var h="string"==typeof b?b:f.href,p=null;"string"==
typeof b&&(p=h.match(/readid=[^&]+/gi),b=h.match(/readclass=[^&]+/gi),p&&0<p.length&&rspkr.HL.Restore.Storage.readId.push(p[0].replace("readid=","").split(",")),b&&0<b.length&&rspkr.HL.Restore.Storage.readClass.push(b[0].replace("readclass=","").split(",")));rspkr.c.data.setParams(h);void 0!==$rs.getAttr(f,"data-target")&&null!==$rs.getAttr(f,"data-target")&&(p=$rs.getAttr(f,"data-target"),p=$rs.get(p),"object"===typeof p&&(c=p));c&&!e?(p=$rs.get(c),$rs.addClass(p,rspkr.ui.rsbtnClass+" rsfloating"),
rspkr.basicMode&&($rs.removeClass(p,"rshidden"),$rs.addClass(p,rspkr.ui.rsbtnClass+" rsvisible"))):p=$rs.closest(f,"div."+rspkr.ui.rsbtnClass);if(!0===rspkr.cfg.item("survey.allowed")){c=rspkr.c.cookie;e=rspkr.cfg.item("survey.cookieName")||"rspkrsurvey";f=rspkr.cfg.item("survey.cookieLifetime")||15552E6;b=rspkr.c.data.params;if("1"===c.readKey(e,"nmbrdisplays")){rspkr.ui.Lightbox.show(rspkr.cfg.item("survey.url")+"?customerid="+b.customerid+"&lang="+b.lang,rspkr.st.r().replaceTokens(rspkr.cfg.item("ui.survey.buttons").join(),
{rsSURVEY_BUTTON_CLOSErs:rspkr.cfg.getPhrase("close")}),!0,function(a){$rs.regEvent($rs.get("#rssurvey_button_close"),"click",rspkr.u.Lightbox.hide)},500);rspkr.log(c.updateKey(e,"nmbrdisplays","displayed",f),4);return}void 0===c.readKey(e,"nmbrdisplays")&&rspkr.log(c.updateKey(e,"nmbrdisplays","1",f),4)}c=l(p);if(a&&a!=c||a&&h!==a.getHref())a.close(!0),rspkr.c.dispatchEvent("onUIClosePlayer",a.getContainer(),[0<rspkr.c.data.selectedText.length?"textsel":"nosel"]);e=(e=a)?e.getID():null;rspkr.c.dispatchEvent("onUIShowPlayer",
window,[e,c.getID()]);c.setHref(h);c.show();return a=c}},p=function(b,c){c=c||a.getContainer();var e=$rs.findIn(c,".rsbtn_status");0===e.length&&(e=document.createElement("span"),e.className="rsbtn_status_overlay",e.innerHTML='<span class="rsbtn_status"></span>',$rs.findIn(c,".rsbtn_exp").appendChild(e),e=$rs.findIn(c,".rsbtn_status"));$rs.css($rs.findIn(c,".rsbtn_status_overlay"),"display","block");if("nosound"===b)b='<a class="rsbtn_nosound">'+rspkr.cfg.getPhrase("nosound")+"</a>",e.innerHTML=b,
(e=$rs.findIn(c,".rsbtn_nosound"))&&$rs.regEvent(e,"click",function(b){return a.nosound()});else if("loaderror"===b){var f=rspkr.c.data.getSaveData("link"),g=document.createElement("a");window.iframeLoaded=function(a){delete window.iframeLoaded;if("Explorer"!=rs.c.data.browser.name){var b=a.contentWindow.document,c=b.head||b.getElementsByTagName("head")[0],e=document.createElement("style");e.type="text/css";e.styleSheet?e.styleSheet.cssText="pre { white-space: normal; }":e.appendChild(b.createTextNode("pre { white-space: normal; }"));
c.appendChild(e);try{var f=decodeURIComponent(a.contentWindow.location.href),g=-1!=f.indexOf(" ")?f.indexOf(" "):0,h=f.lastIndexOf("/",g)+1,D=f.substr(h);b.body.innerHTML=D}catch(p){}}};g.className="rsbtn_loaderror";g.innerHTML="[?]";g.href=f;$rs.regEvent(g,"click",function(a){rspkr.ui.Lightbox.show("<iframe src='"+g.href+"' style='height:100%' onload='window.iframeLoaded(this)'></iframe>",null,!1,null,300);h(a)});e.innerHTML=rspkr.cfg.getPhrase("loaderror");e.appendChild(g)}else e.innerHTML=b},q=
function(a,b,c){c=c||a;void 0===b&&(b=!0);$rs.focusIn&&"function"==typeof $rs.focusIn&&($rs.focusIn(a,function(){$rs.addClass(c,"rsfocus");!0===b&&(t=a);rspkr.Common.dispatchEvent("onFocusIn",window,[a,c])}),$rs.focusOut(a,function(){$rs.removeClass(c,"rsfocus");rspkr.Common.dispatchEvent("onFocusOut",window,[a,c])}))},t=null,r=function(){t&&$rs.isVisible(t)&&(rspkr.log("[rspkr.ui.updateFocus] "+t.outerHTML),w(t))},w=function(a){$rs.focus&&"function"==typeof $rs.focus&&a&&$rs.focus(a)},x=function(a){if("iconon"==
rspkr.st.get("hlicon")&&!e){var b=f.push(new v)-1;f[b].id=b;f[b].show(a);e=!0}},u=function(a){"iconon"==rspkr.st.get("hlicon")&&e&&(f.pop().hide(),e=!1)},v=function(){var a=0,b=0,c=null,g=52,p=null,q=null,k=null,l=function(a){a=a||c;$rs.addClass(a,rspkr.ui.rsbtnClass+" rspopup");rspkr.cfg.item("general.useCompactPopupButton")&&$rs.addClass(a,"rscompact")},n=function(a){$rs.unregEvent(c,"mouseout",m);window.clearTimeout(p);var b,f=c.clientWidth+10,g;q=rspkr.ui.showPlayer(k,c,!0);g=q.getWidth();b=parseInt($rs.offset(c).left);
(b=rspkr.ui.viewport.width+$rs.scrollLeft(document)-b)<g&&(b=parseInt($rs.css(c,"left"))-(g-(f-10)),$rs.css(c,"left",b+"px"));e=!1;$rs.unregEvent(k,"click",n);$rs.regEvent(k,"click",function(a){h(a);return q.restart()});h(a);return!1},m=function(a){p||(p=window.setTimeout(function(){w()},rspkr.cfg.item("general.popupCloseTime")||2E3))},r=function(a){p&&(window.clearTimeout(p),p=null)},t=function(a,b){var e=$rs.offset(document.body);$rs.css(c,{top:b-e.top+"px",left:a-e.left+"px",width:g+"px"})},w=
function(){$rs.css(c,{display:"none",top:0,left:0});r();f.splice(null,1);e=!1;c.parentElement.removeChild(c)};(function(){var a=rspkr.c.findFirstRSButton();c=document.createElement("div");c.id=rspkr.getID();c.innerHTML=rspkr.cfg.item("ui.popupbutton").join("");l();k=$rs.findIn(c,"a.rsbtn_play");k.href=a?a.href:null;a||(k.href=rspkr.cfg.item("general.popupHref"));var a=k.href.match(/lang=([^&;]*)/i).pop(),b=$rs.findIn($rs.get(c),"a.rsbtn_play span.rsbtn_text span");b&&(b.textContent=b.innerText=rspkr.cfg.getPhrase("listen",
a,"en_us"));$rs.setAttr(k,"title",rspkr.cfg.getPhrase("listentoselectedtext",a,"en_us"));$rs.regEvent(k,"click",n);document.body.appendChild(c)})();return{setPos:t,show:function(e){r(e);if(e&&"none"==$rs.css(c,"display")){var f=c.cloneNode(!0);f.id=rspkr.getID();$rs.css(f,{display:"block",position:"absolute",top:0,left:0});document.body.appendChild(f);g=$rs.outerWidth(f)+3;document.body.removeChild(f);f=e.pageX;e=e.pageY;b=e>rspkr.ui.pointerY?e-$rs.scrollTop(document)+36>rspkr.ui.viewport.height-
46?e-66:e+30:10>e-$rs.scrollTop(document)-66?e+30:e-51;a=10>f-$rs.scrollLeft(document)?f+10:f-$rs.scrollLeft(document)>rspkr.ui.viewport.width-(g+10)?rspkr.ui.viewport.width+$rs.scrollLeft(document)-(g+10):f+0;t(a,b)}$rs.regEvent(c,"mouseout",m);$rs.regEvent(c,"mouseover",r);m(null);l();$rs.css(c,"display","block")},hide:w,id:null}},y={update:function(b,c,e){"hlspeed"===b&&c!==e&&(b=b.replace("hl",""),rspkr.c.converter[b]&&"function"==typeof rspkr.c.converter[b]&&(c=rspkr.c.converter[b](c)),rspkr.c.data[b]=
c,a&&a.stop(),rspkr.pl.releaseAdapter())}},z=function(a,b,c,e,f,g){$rs.css(a,"background-color","rgb("+b+","+c+","+e+")");e<f?(e+=10,window.setTimeout(function(){z(a,b,c,e,f,g)},50)):g&&"function"===typeof g&&g.apply(a,[])},A=function(){return rspkr.XP?rspkr.XP:rspkr.HL};_expand=function(a){"string"==typeof a&&(a=$rs.get(a));$rs.isArray(a)||(a=[a]);for(var b=rspkr.cfg.getPhrases(rspkr.c.data.getParam("lang")),c=rspkr.c.data.browser,e=function(a){return $rs.closest(a,"div."+rspkr.ui.rsbtnClass)},f=
function(){k(this)},g=function(){var a=$rs.findIn(e(this),".rsbtn_play");$rs.removeClass(e(this),"rsstopped rsplaying rspaused rsexpanded");k(this);a.click()},p=function(){$rs.removeClass(e(this),"rsstopped rsplaying rspaused rsexpanded");k(this)},q=function(){var a=e(this);rspkr.ui.Lightbox.show(rspkr.st.getHTML(),rspkr.st.getButtons(),!0,function(b){rspkr.c.dispatchEvent("onSettingsLoaded",window,[]);rspkr.cfg.execCallback("cb.ui.settingsopened",a)})},k=function(a){a=e(a);$rs.unregEvent($rs.findIn(a,
".rsbtn_pause"),"click",g);$rs.unregEvent($rs.findIn(a,".rsbtn_closer"),"click",p);$rs.unregEvent($rs.findIn(a,".rsbtn_settings"),"click",q);$rs.unregEvent($rs.findIn(a,".rsbtn_play"),"click",f);$rs.removeClass(a,"pre-expanded")},l=0;l<a.length;l++){$rs.addClass(a[l],"rsexpanded rsstopped");var n=$rs.findIn(a[l],".rsbtn_powered");if(n){var m=$rs.findIn(n,".rsbtn_btnlabel"),r=b.speechenabled.match(/.*href="([^"]*)"/i).pop(),t=b.newwindow,w=document.createElement("p");w.innerHTML=b.speechenabled;t=
(w.innerText||w.textContent)+(t?" ("+t+")":"");m&&(m.innerHTML=b.speechenabled);$rs.setAttr(n,"title",t);$rs.setAttr(n,"data-readspeaker-href",r);m=$rs.getAttr(n,"data-rsevent-id");(!m||rs.l.f.eq.store[m]&&!rs.l.f.eq.store[m].click)&&$rs.regEvent(n,"click",function(){window.open($rs.getAttr(this,"data-readspeaker-href"))});if(n=$rs.findIn(n,".rsbtn_btnlabel a"))(/Chrome|Safari|Opera/gi.test(c.name)||/Explorer/gi.test(c.name)&&8<=c.version)&&$rs.regEvent(n,"click",function(a){h(a)}),n.innerHTML='<span class="rsbtn_label_read">Read</span><span class="rsbtn_label_speaker">Speaker</span><span class="rsbtn_label_icon rsimg"></span>'}$rs.addClass(a[l],
"pre-expanded");$rs.removeClass($rs.findIn(a[l],".rsbtn_progress_container"),"rsloading");$rs.regEvent($rs.findIn(a[l],".rsbtn_closer"),"click",p);$rs.regEvent($rs.findIn(a[l],".rsbtn_pause"),"click",g);$rs.regEvent($rs.findIn(a[l],".rsbtn_play"),"click",f);$rs.regEvent($rs.findIn(a[l],".rsbtn_settings"),"click",q)}};_animate=function(){var a=rs.cfg.item("ui.animate");if(a){var b,c=15,e=500;"object"==typeof a?(a.id&&(b=$rs.get(a.id)),a.count&&(c=a.count),a.interval&&(e=a.interval)):"string"===typeof a&&
(b=$rs.get(a));if("boolean"===typeof a&&a||$rs.isArray(b)&&0==b.length||!b)b=$rs.get("."+rs.ui.rsbtnClass);$rs.isArray(b)||(b=[b]);var f=c,g=setInterval(function(){0==f&&($rs.removeClass(b,"rsanimate"),clearInterval(g));1==f--%2?$rs.addClass(b,"rsanimate"):$rs.removeClass(b,"rsanimate")},e)}};return{meta:{revision:"2887"},initrun:!1,init:function(){evt=rspkr.Common.addEvent;ui=rspkr.ui;evt("onAfterModsLoaded",n);evt("onReady",c);evt("onReady",k);evt("onReady",_animate);evt("onSelectedText",x);evt("onDeselectedText",
u);evt("onSettingsChanged",y.update);evt("onAfterSyncInit",r);this.initrun=!0;rspkr.Common.dispatchEvent("onUIInitialized");rspkr.log("[rspkr.ui] Initialized!")},addFocusHandler:function(a,b,c){q(a,b,c)},focus:function(a){w(a)},updateFocus:function(){r()},showOverlay:function(a,b){p(a,b)},settings:y,rsbtnClass:"",addClickEvents:function(){c()},initGlobalCallbacks:function(){n()},showPopupIcon:function(a){x(a)},processDeferred:function(){k()},showPlayer:function(a,b,c){return m(a,b,c)},expand:function(a){_expand(a)},
pointerX:0,pointerY:0,setPointerPos:function(a){rspkr.ui.pointerX=a.pageX;rspkr.ui.pointerY=a.pageY;return!0},viewport:{width:$rs.width(window),height:$rs.height(window)},popups:f,hl:function(a,b){window.setTimeout(function(){z(a,255,255,100,255,b)},200)},scroll:{INTERVAL:null,STEPS:25,scrollToElm:function(a){$rs.isVisible(a)&&this.initScroll(a)},scrollToAnchor:function(a){for(var b=$rs.get("a"),c=null,e=0;e<b.length;e++){var f=b[e];if(f.name&&f.name==a){c=f;break}}this.initScroll(c)},initScroll:function(a){if(a){for(var b=
a.offsetTop,c=a;c.offsetParent&&c.offsetParent!=document.body;)c=c.offsetParent,b+=c.offsetTop;b-=50;rs.cfg.item("ui.autoscrollOffset")&&!isNaN(rs.cfg.item("ui.autoscrollOffset"))&&(b-=rs.cfg.item("ui.autoscrollOffset"));clearInterval(rspkr.u.scroll.INTERVAL);var c=rspkr.u.scroll.getCurrentYPos(),e=parseInt((b-c)/rspkr.u.scroll.STEPS);rspkr.u.scroll.INTERVAL=setInterval(function(){rspkr.u.scroll.scrollWindow(e,b,a)},10)}else document.location.hash=a},getCurrentYPos:function(){return document.body&&
document.body.scrollTop?document.body.scrollTop:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:window.pageYOffset?window.pageYOffset:0},scrollWindow:function(a,b,c){var e=rspkr.u.scroll.getCurrentYPos(),f=e<b;window.scrollTo(0,e+a);a=rspkr.u.scroll.getCurrentYPos();if(f!=a<b||e==a)window.scrollTo(0,b),clearInterval(rspkr.u.scroll.INTERVAL),"string"==typeof c&&(location.hash=c)}},activePlayer:a,getActivePlayer:function(){return a}}}();
ReadSpeaker.ui.Slider=function(){var a=this,b={handleClass:"",width:0,height:0,left:0,top:0,steps:-1,stepsize:-1,dir:"h",initval:-1,drop:null,start:null,dragging:null,click:null,labelDragHandle:"",labelStart:"",labelEnd:"",nudge:1},f={rsid:void 0,parent:void 0,ref:void 0},e=void 0,h=void 0,c=void 0,g=void 0,l=void 0,n=!1,k=0,m=function(a){a=a||window.event;a.returnValue=!1;if(a=a.originalEvent)a.cancelBubble=!0,a.returnValue=!1;a&&a.preventDefault&&a.preventDefault();a&&a.stopPropagation&&a.stopPropagation()};
this.initElement=function(a){if(!n){"string"==typeof a&&(a=document.getElementById(a));a.innerHTML+='<a href="javascript:void(0);" role="slider" class="keyLink" style="display:block; border:0;">&#160;</a>';var c=a.getElementsByTagName("a"),c=c[c.length-1],e=-1<b.steps?b.steps:100;c.relatedElement=a;$rs.setAttr(c,"title",b.labelDragHandle);$rs.setAttr(c,"aria-label",b.labelDragHandle);$rs.setAttr(c,"aria-orientation","h"==b.dir?"horizontal":"vertical");$rs.setAttr(c,"aria-valuemin",0);$rs.setAttr(c,
"aria-valuemax",e);$rs.setAttr(c,"aria-valuenow",b.initval||0);k=b.initval;$rs.regEvent(a,"mousedown",this.startDragMouse);$rs.regEvent(c,"click",function(a){m(a)});$rs.regEvent(c,"keyup",this.startDragKeys);$rs.regEvent(c,"dragstart",function(a){m(a)});$rs.regEvent(a,"touchstart",this.touchStart);$rs.regEvent(f.parent,"mousedown",this.mouseClick)}};this.mouseClick=function(e){if(!n&&!$rs.hasClass(f.ref,"dragged")){var h=a.findPos(e.target),k=e.clientX-(h.left-b.left);e=e.clientY-(h.top-b.top);c=
h.left;g=h.top;h=a.getCurrentVal({left:k,top:e});"function"==typeof b.click&&b.click(h,f);return!1}};this.findPos=function(a){var b=curTop=0;if(a.offsetParent){do b+=a.offsetLeft,curTop+=a.offsetTop;while(a=a.offsetParent);return{left:b,top:curTop}}};this.startDragMouse=function(b){rspkr.log("[rspkr.ui.Slider] startDragMouse");if(!n){a.startDrag(this);var c=b||window.event;e=c.clientX;h=c.clientY;$rs.regEvent(document.body,"mousemove",a.dragMouse);$rs.regEvent(document.body,"mouseup",a.releaseElement)}m(b);
return!1};this.startDragKeys=function(b){rspkr.log("[rspkr.ui.Slider] startDragKeys "+(b||window.event).keyCode);a.startDrag(this.relatedElement);$rs.regEvent(document.body,"keydown",a.dragKeys);$rs.regEvent(document.body,"keypress",a.switchKeyEvents);$rs.addClass(this.relatedElement,"rskeycontrolled");m(b)};this.touchStart=function(b){b=b.originalEvent;rspkr.log("[rspkr.ui.Slider] touchStart");n||(a.startDrag(b.target),e=b.touches[0].pageX,h=b.touches[0].pageY,$rs.regEvent(b.target,"touchmove",a.touchMove),
$rs.regEvent(b.target,"touchend",a.releaseElement));return!1};this.startDrag=function(e){rspkr.log("[rspkr.ui.Slider] startDrag");l&&a.releaseElement();c=e.offsetLeft;g=e.offsetTop;l=e;$rs.addClass(l,"dragged");"function"==typeof b.start&&b.start(f)};this.dragMouse=function(b){b=b||window.event;a.setPosition(b.clientX-e,b.clientY-h);a.valueChanged=!0;return!1};this.touchMove=function(b){m(b);a.setPosition(b.touches[0].pageX-e,b.touches[0].pageY-h);a.valueChanged=!0;return!1};this.dragKeys=function(c){switch((c||
window.event).keyCode){case 37:case 63234:a.valueChanged=!0;k-=b.nudge;break;case 38:case 63232:a.valueChanged=!0;k+=b.nudge;break;case 39:case 63235:a.valueChanged=!0;k+=b.nudge;break;case 40:case 63233:a.valueChanged=!0;k-=b.nudge;break;case 13:case 27:return a.releaseElement(),!1;case 9:return a.releaseElement(),!0;default:return rspkr.log("[rspkr.ui.Slider] return TRUE"),!0}!0===a.valueChanged&&(rspkr.c.dispatchEvent("onUISliderMove"),"function"==typeof b.dragging&&b.dragging(a.getCurrentVal({skipValueCalculation:!0}),
f));m(c);rspkr.log("[rspkr.ui.Slider] ready to return!");return!1};this.setPosition=function(e,h){var k,n=!1;k=e;var m=c,x=b.left,u=b.width,v="left";"v"==b.dir&&(k=h,m=g,x=b.top,u=b.height,v="top");k=m+k;-1<b.stepsize&&((k+x)%b.stepsize?k=b.stepsize*Math.ceil(k/b.stepsize)+x:n=!0);k>u+x?k=u+x:k<x&&(k=x);n||(l.style[v]=k+"px","function"==typeof b.dragging&&b.dragging(a.getCurrentVal(),f))};this.switchKeyEvents=function(){$rs.unregEvent(document.body,"keydown",a.dragKeys);$rs.unregEvent(document.body,
"keypress",a.switchKeyEvents);$rs.regEvent(document.body,"keypress",a.dragKeys)};this.releaseElement=function(){rspkr.log("[rspkr.ui.Slider] releaseElement");$rs.unregEvent(document.body,"mousemove",a.dragMouse);$rs.unregEvent(document.body,"mouseup",a.releaseElement);$rs.unregEvent(document.body,"keypress",a.dragKeys);$rs.unregEvent(document.body,"keypress",a.switchKeyEvents);$rs.unregEvent(document.body,"keydown",a.dragKeys);$rs.unregEvent(l,"touchmove",a.touchMove);$rs.unregEvent(l,"touchend",
a.releaseElement);$rs.removeClass(l,"dragged");$rs.removeClass(l,"rskeycontrolled");$rs.removeClass(l,"rsmousecontrolled");var c=a.getCurrentVal();l=null;"function"==typeof b.drop&&!0===a.valueChanged&&b.drop(c,f);a.valueChanged=!1;rs.ui.getActivePlayer()&&rs.ui.getActivePlayer().setProgress();return!1};this.getCurrentVal=function(a){var c,e=b.width;c="left";var g=b.left;"v"==b.dir&&(e=b.height,c="top",g=b.top);var h=-1<b.steps?b.steps:100,e=-1<b.stepsize?b.stepsize:e/h;a=a?a[c]:$rs.css(f.ref,c).replace(/px/i,
"");pos=Math.round(a)-g;c=Math.round(pos/e);"v"==b.dir&&(c=h-c);rspkr.log("[rspkr.ui.Slider] currentval: "+c);return a&&a.skipValueCalculation||isNaN(c)?k=Math.max(Math.min(k,h),0):k=c};return{init:function(c,e){"string"==typeof c&&(c=document.getElementById(c));if(c){var g=c.id||"data-readspeaker-slider-id-"+Math.floor(2E4*Math.random());c.setAttribute&&c.setAttribute("data-readspeaker-slider-id-","data-readspeaker-slider-parent-"+g);var h={width:function(){return $rs.width(c)},height:function(){return $rs.height(c)}};
if("object"==typeof e)for(var k in e)e.hasOwnProperty(k)&&void 0!==b[k]&&(b[k]=e[k]);k=!1;var l;"rsbtn_volume_slider"===c.className&&"jquery"===rspkr.l.f.currentLib()&&1.5>parseFloat(jQuery.fn.jquery)&&(l=c.parentNode.style.display,c.parentNode.style.display="block",k=!0);b.width=h.width();b.height=h.height();k&&(c.parentNode.style.display=l);-1<b.steps&&(b.stepsize=("h"==b.dir?b.width:b.height)/b.steps);h=document.createElement("span");h.setAttribute("data-readspeaker-slider-id-",g);h.className=
b.handleClass||"rsbtn_progress_handle rsimg";c.appendChild(h);f.rsid=g;f.parent=c;f.ref=h;g=$rs.css(h,"left");null!==g&&(b.left=parseInt(g.replace(/px/i,"")));g=$rs.css(h,"top");null!==g&&(b.top=parseInt(g.replace(/px/i,"")));-1<b.initval&&this.jumpTo(b.initval);b.labelStart&&(g=document.createElement("span"),g.className="slider-label-start",g.innerHTML=b.labelStart,c.appendChild(g));b.labelEnd&&(g=document.createElement("span"),g.className="slider-label-end",g.innerHTML=b.labelEnd,c.appendChild(g));
a.initElement(h)}},jumpTo:function(a){if(isNaN(a))return!1;var c=101,e=a;-1<b.steps&&(a=Math.round(a),c=b.steps+1);if(-1<a&&a<c){var g=b.width,h=b.left,k="left";"v"==b.dir&&(g=b.height,h=b.top,k="top",a=c-1-a);f.ref.style[k]=g/(c-1)*a+h+"px";$rs.setAttr($rs.findIn(f.ref,"a.keyLink"),"aria-valuenow",e)}},setCurrentValue:function(a){k=a},getInstance:function(){return f},getContainer:function(){return f.parent},releaseElement:function(){a.releaseElement()},startDragKeys:function(b,c){a.startDragKeys.call(b,
c)},disabled:function(){if(arguments)n=arguments[0];else return n}}};
ReadSpeaker.ui.Player=function(a){var b=function(a){a=a||window.event;a.returnValue=!1;if(a=a.originalEvent)a.cancelBubble=!0,a.returnValue=!1;a&&a.preventDefault&&a.preventDefault();a&&a.stopPropagation&&a.stopPropagation()},f=function(b){b=b||a;b=$rs.clone(b,!0,!0);var c;b.id=rspkr.getID();document.body.appendChild(b);$rs.css(b,{position:"absolute",top:"0",left:"0",display:"block",width:"auto"});$rs.css(b,"float","none");$rs.addClass(b,"rsexpanded");c=$rs.outerWidth(b)+3;b.style.display="none";
document.body.removeChild(b);return c},e=rspkr.getID(),h=this,c=[],g=0,l=!1,n=null,k=!1,m={_play:null,_pause:null,_stop:null,_vol:null,_settings:null,_dl:null,_closer:null,_powered:null,_get:function(b,c){var e;b="_"+b;e=a?this[b]&&0<this[b].length?this[b]:this[b]=$rs.findIn(a,c):null;return e==[]?null:e},play:function(){return this._get("play",".rsbtn_play")},pause:function(){return this._get("pause",".rsbtn_pause")},stop:function(){return this._get("stop",".rsbtn_stop")},vol:function(){return this._get("vol",
".rsbtn_volume")},settings:function(){return this._get("settings",".rsbtn_settings")},dl:function(){return this._get("dl",".rsbtn_dl")},pin:function(){return this._get("pin",".rsbtn_pin")},powered:function(){return this._get("powered",".rsbtn_powered")},closer:function(){return this._get("closer",".rsbtn_closer")},nosound:function(){return this._get("nosound",".rsbtn_nosound")},setPlayPause:function(a){rspkr.log("[rspkr.ui.Player.setPlayPause("+a+")]");a=a?$rs.getAttr(this.pause(),"data-rsphrase-play"):
$rs.getAttr(this.pause(),"data-rsphrase-pause");$rs.setAttr(this.pause(),"title",rspkr.c.decodeEntities(a));$rs.findIn(this.pause(),".rsbtn_btnlabel").innerHTML=a}},p=!1,q=[],t=function(){var b=null,b=rspkr.cfg,c=rspkr.cfg.getPhrases(rspkr.c.data.getParam("lang"));if(0==$rs.findIn(a,".rsbtn_exp").length){var e=$rs.hasClass(a,"rspopup")?b.item("ui.popupplayer"):b.item("ui.player"),b=document.createElement("div");b.className="rsbtn_exp rsimg rspart";b.innerHTML+=e.join("\n");a.appendChild(b)}b=m.pin();
$rs.isArray(b)&&0==b.length&&(b=void 0);rspkr.cfg.item("ui.usePin")&&b?$rs.removeClass(b,"turnedOff"):b&&b.parentElement.removeChild(b);if(c){b=function(a,b){var c=$rs.findIn(a,".rsbtn_btnlabel");$rs.isArray(c)||(c=[c]);0<c.length&&(c[0].innerHTML=b)};m.pause()&&($rs.setAttr(m.pause(),"data-rsphrase-pause",c.pause),$rs.setAttr(m.pause(),"data-rsphrase-play",c.play),$rs.setAttr(m.pause(),"title",rspkr.c.decodeEntities(c.pause)),b(m.pause(),rspkr.c.decodeEntities(c.pause)));m.stop()&&($rs.setAttr(m.stop(),
"title",rspkr.c.decodeEntities(c.stop)),b(m.stop(),rspkr.c.decodeEntities(c.stop)));m.vol()&&($rs.setAttr(m.vol(),"title",rspkr.c.decodeEntities(c.volume)),b(m.vol(),rspkr.c.decodeEntities(c.volume)));m.settings()&&($rs.setAttr(m.settings(),"title",rspkr.c.decodeEntities(c.settings)),b(m.settings(),rspkr.c.decodeEntities(c.settings)));m.dl()&&($rs.setAttr(m.dl(),"title",rspkr.c.decodeEntities(c.download)),b(m.dl(),rspkr.c.decodeEntities(c.download)));if(m.powered()){var e=$rs.findIn(m.powered(),".rsbtn_btnlabel"),
f=c.speechenabled.match(/.*href="([^"]*)"/i).pop(),g=c.newwindow,h=document.createElement("p");h.innerHTML=c.speechenabled;g=(h.innerText||h.textContent)+(g?" ("+g+")":"");e&&(e.innerHTML=c.speechenabled);$rs.setAttr(m.powered(),"title",g);$rs.setAttr(m.powered(),"data-readspeaker-href",f);e=$rs.getAttr(m.powered(),"data-rsevent-id");(!e||rs.l.f.eq.store[e]&&!rs.l.f.eq.store[e].click)&&$rs.regEvent(m.powered(),"click",function(){window.open($rs.getAttr(this,"data-readspeaker-href"))})}m.closer()&&
($rs.setAttr(m.closer(),"title",rspkr.c.decodeEntities(c.closeplayer)),b(m.closer(),rspkr.c.decodeEntities(c.closeplayer)))}c=rspkr.c.data.browser;/safari/i.test(c.name)&&/iphone|ipad|ios/i.test(c.OS)||$rs.addClass(a,"rs-no-touch")},r={play:function(){rspkr.c.dispatchEvent("onUIBeforePlay");rspkr.log("[rspkr.ui.handlers.play]");q.progress&&q.progress.disabled(!1);r.setStateClass(a,"rsplaying");rspkr.basicMode&&r.setStateClass($rs.findIn(a,".rsbtn_exp"),"rsplaying");$rs.addClass($rs.findIn(a,".rsbtn_progress_container"),
"rsloading");m.setPlayPause(!1);rspkr.pl.play();k&&rspkr.pl.getProgress.apply(rspkr.pl,[!0,x,h]);rspkr.c.addEvent("onBeforeSyncInit",function(){k=!0;rspkr.pl.getProgress.apply(rspkr.pl,[!0,x,h])});"flash"!==rspkr.pl.adapter||rspkr.displog.onVolumeAdjusted||rspkr.pl.setVolume(parseInt(rspkr.st.get("hlvol")||"100"));rspkr.c.dispatchEvent("onUIAfterPlay");rspkr.cfg.execCallback("cb.ui.play",a)},pause:function(){rspkr.log("[rspkr.ui.handlers.pause]");r.setStateClass(a,"rspaused");rspkr.basicMode&&r.setStateClass($rs.findIn(a,
".rsbtn_exp"),"rspaused");m.setPlayPause(!0);rspkr.pl.pause();rspkr.pl.getProgress(!1);rspkr.c.dispatchEvent("onUIPause");rspkr.cfg.execCallback("cb.ui.pause",a);rspkr.log("ReadSpeaker.ui.pause")},stop:function(){rspkr.log("[rspkr.ui.handlers.stop]");q.progress&&q.progress.disabled(!0);r.setStateClass(a,"rsstopped");$rs.removeClass($rs.findIn(a,".rsbtn_progress_container"),"rsloading");rspkr.basicMode&&r.setStateClass($rs.findIn(a,".rsbtn_exp"),"rsstopped");m.setPlayPause(!0);$rs.setAttr(a,"data-readspeaker-current",
0);q.progress&&(q.progress.jumpTo(0),w(0));rspkr.pl.stop();rspkr.pl.getProgress(!1);rspkr.c.dispatchEvent("onUIStop",a);rspkr.cfg.execCallback("cb.ui.stop",a);document.getElementById("rslightbox_contentcontainer")&&$rs.isVisible(document.getElementById("rslightbox_contentcontainer"))||m.pause().focus();rspkr.log("ReadSpeaker.ui.stop")},setStateClass:function(a,b){a&&($rs.removeClass(a,"rspaused rsstopped rsplaying"),$rs.addClass(a,b))},vol:function(b){var c=$rs.findIn(a,".rsbtn_volume_container"),
e=$rs.findIn(a,".rsbtn_volume");b=b.originalEvent;var f=function(a){var b=a.originalEvent,b=$rs.closest(b.srcElement||b.originalTarget,".rsbtn_volume_container");if("none"===$rs.css(c,"display"))return!1;if("click"===a.type){if(void 0===b||$rs.isArray(b)&&!b.length)$rs.css(c,"display","none"),$rs.unregEvent(document.body,"click",f)}else"keyup"===a.type&&27===a.keyCode&&($rs.css(c,"display","none"),$rs.unregEvent(document.body,"keyup",f))};$rs.css(c,"left",e.offsetLeft+"px");$rs.css(c,"display","none"==
$rs.css(c,"display")?"block":"none");"block"===$rs.css(c,"display")&&($rs.regEvent(document.body,"click",f),$rs.regEvent(document.body,"keyup",f));b&&b.stopPropagation&&b.stopPropagation();b.cancelBubble=!0;e=$rs.findIn(c,".keyLink");q.vol.startDragKeys(e,{keyCode:13});return!1},settings:function(){$rs.hasClass(a,"rsplaying")&&this.pause();rspkr.ui.Lightbox.show(rspkr.st.getHTML(),rspkr.st.getButtons(),!0,function(a){var b=$rs.get("rslightbox_closer"),c=function(){document.removeEventListener?b.removeEventListener("click",
c,!1):document.detachEvent&&document.detachEvent("onclick",c);rspkr.c.dispatchEvent("onSettingsClosed",window,[])};$rs.regEvent(b,"click",c);rspkr.ui.addClickEvents();rspkr.c.dispatchEvent("onSettingsLoaded",window,[]);rspkr.cfg.execCallback("cb.ui.settingsopened",a)})},close:function(b){r.pin(!0);b=b||!1;var c=rspkr.pl,e=!1;b||rspkr.cfg.execCallback("cb.ui.beforeclose",a);c.hasOwnProperty("getProgress")&&rspkr.pl.getProgress(!1);c.hasOwnProperty("releaseAdapter")&&rspkr.pl.releaseAdapter();$rs.setAttr(a,
"data-readspeaker-current",0);q.progress&&q.progress.jumpTo(0);$rs.removeClass(a,"rsstopped rsplaying rspaused rsexpanded");if(rspkr.basicMode){var f;(f=$rs.findIn(a,".rsbtn_play"))&&$rs.removeClass(f,"rsexpanded")}$rs.hasClass(a,"rsfloating")&&($rs.removeClass(a,rspkr.ui.rsbtnClass),rspkr.basicMode&&($rs.removeClass(a,"rsvisible"),$rs.addClass(a,"rshidden")));m.setPlayPause(!0);$rs.hasClass(a,"rspopup")&&(e=!0,$rs.removeClass(a,"rspopup"),$rs.css(a,"display","none"),a.parentNode.removeChild(a));
$rs.css(a,"width","auto");delete rspkr.displog.onVolumeAdjusted;b||(rspkr.c.dispatchEvent("onUIClosePlayer",a,["userclick"]),rspkr.cfg.execCallback("cb.ui.close",a),rspkr.log("ReadSpeaker.ui.close: "+a));b||!1!==e||rspkr.ui.focus($rs.findIn($rs.get(a),".rsbtn_play"))},dl:function(){$rs.hasClass(a,"rsplaying")&&this.pause();var c=rspkr.c.data.getSaveData("dialog"),e=!1;rspkr.log("[rspkr.ui.handlers.dl] Savelink: "+c);rspkr.u.Lightbox.show(this.getDlDialog(),this.getDlButtons(),!0,function(){var a=
$rs.get("#rsdl_button_accept"),f=$rs.get("#rsdl_button_decline");a&&$rs.regEvent(a,"click",function(b){rspkr.u.Lightbox.hide(b);e="iOS"!==rspkr.c.data.browser.OS&&0<rspkr.c.data.selectedHTML.length?!0:"iOS"!==rspkr.c.data.browser.OS&&!0===rspkr.cfg.item("general.usePost")?!0:!1;if(!0===e){b=null;if(document.getElementById("dliframe"))b=document.getElementById("dliframe");else{if(document.selection)try{b=document.createElement('<iframe name="dliframe">')}catch(f){b=document.createElement("iframe")}else b=
document.createElement("iframe");b.name="dliframe";b.setAttribute("id","dliframe");b.setAttribute("style","display: none; position: absolute;");b.style.display="none";var g=document.getElementsByTagName("body"),h=null;0<g.length&&(h=g.item(0));if(h)h.appendChild(b);else return}b.src=c;return!1}$rs.setAttr(a,"href",c);return!0});f&&($rs.regEvent(f,"click",function(a){b(a);rspkr.u.Lightbox.hide(a)}),setTimeout(function(){rspkr.ui.focus(f)},200));rspkr.c.dispatchEvent("onDownloadLoaded",window,[])})},
pin:function(a){var b=rs.ui.getActivePlayer().getContainer(),c=b.id+"_pinnedHome",e=document.getElementById(c);if(!$rs.hasClass(m.pin(),"pinned")&&!a){if($rs.addClass(m.pin(),"pinned"),!e){e=$rs.clone(b,!1,!0);a=window.getComputedStyle(b);var f=b.offsetLeft,g=b.offsetTop;e.style.width=a.getPropertyValue("width").replace(/[^-\d\.]/g,"")-2+"px";e.style.height=a.getPropertyValue("height").replace(/[^-\d\.]/g,"")-2+"px";for(var h="position left right top bottom margin".split(" "),k=0,l;l=h[k];k++)e.style[l]=
a.getPropertyValue(l);b.style.position="fixed";b.style.left=f-document.body.scrollLeft+"px";b.style.top=g-document.body.scrollTop+"px";e.className="rsbtn_pinnedHome rsbtn";for(e.id=c;e.hasChildNodes();)e.removeChild(e.lastChild);b.parentElement.insertBefore(e,b)}}else if($rs.hasClass(m.pin(),"pinned")||a)$rs.removeClass(m.pin(),"pinned"),e&&(e.parentNode.removeChild(e),c=function(a,b){document.body.style.removeProperty?a.style.removeProperty(b):a.style.removeAttribute(b)},c(b,"position"),c(b,"top"),
c(b,"left"))},getDlDialog:function(){var a=rspkr.cfg.item("ui.dldialog").join("\n"),b={};b.rsTERMS_OF_USE_HEADINGrs=rspkr.cfg.getPhrase("touheading");b.rsTERMS_OF_USE_BODYrs=rspkr.cfg.getPhrase("toubody");return rspkr.st.r().replaceTokens(a,b)},getDlButtons:function(){var a=rspkr.cfg.item("ui.dlbuttons").join("\n"),b={};b.rsTERMS_OF_USE_ACCEPTrs=rspkr.cfg.getPhrase("touaccept");b.rsTERMS_OF_USE_DECLINErs=rspkr.cfg.getPhrase("toudecline");return rspkr.st.r().replaceTokens(a,b)},nosound:function(){var a=
rspkr.c.data.getSaveData("link");$rs.setAttr(m.nosound(),"href",a);return!0}},w=function(b){b=100<b?100:b;var c=$rs.findIn(a,".rsbtn_progress_played");"object"===typeof c&&$rs.css(c,"width",b+"%");rspkr.cfg.execCallback("cb.ui.progresschanged",a,[b])},x=function(b){if(b.length){var c=parseInt(b[0]);b=parseInt(b[1]);var e=0==b?0:Math.round(c/b*100),f=$rs.findIn(a,".rsbtn_current_time"),g=$rs.findIn(a,".rsbtn_total_time"),h,k;q.progress&&(q.progress.setCurrentValue(e),p||(q.progress.jumpTo(e),w(e),
f&&(f.innerHTML=h=u(c)),g&&(g.innerHTML=k=u(b)),rspkr.cfg.execCallback("cb.ui.timeupdated",a,[h,k])));rspkr.log("[rspkr.player.updateProgress] current time: "+c+" total time: "+b);$rs.setAttr(a,"data-readspeaker-current",c);$rs.setAttr(a,"data-readspeaker-buffered",b);0<c&&$rs.removeClass($rs.findIn(a,".rsbtn_progress_container"),"rsloading")}},u=function(a){a/=1E3;var b=parseInt(a%60),c=parseInt(a/60%60);a=parseInt(a/60/60%60);return(10>a?"0"+a:a.toString())+":"+(10>c?"0"+c:c.toString())+":"+(10>
b?"0"+b:b.toString())},v=function(){p=!0},y=function(b,c){rspkr.log("_dropProgress ("+b+")",5);if(b){var e=b/100*$rs.getAttr(a,"data-readspeaker-buffered")/1E3;rspkr.pl.setProgress(e)}p=!1},z=function(a){y(a)},A=function(b,c){rspkr.log("_dropVolume, "+b,5);b=0>b?0:20*b;q.vol&&q.vol.jumpTo(b/20);rspkr.pl.setVolume(b);rspkr.st.set("hlvol",b);rspkr.cfg.execCallback("cb.ui.volumechanged",a,[b]);return!1},B=function(b,c){if("keyLink"===b.className){var e="";$rs.hasClass(c,"rsbtn_volume_handle")?e="vol":
$rs.hasClass(c,"rsbtn_progress_handle")&&(e="progress");var f={keyCode:13};q[e].startDragKeys(b,f)}else $rs.hasClass(c,"rsbtn_volume")&&(f={keyCode:13},e=$rs.findIn(a,".rsbtn_volume_container"),e=$rs.findIn(e,".keyLink"),q.vol.startDragKeys(e,f))},C=function(a,b){if("keyLink"===a.className){var c="";$rs.hasClass(b,"rsbtn_volume_handle")?c="vol":$rs.hasClass(b,"rsbtn_progress_handle")&&(c="progress");q[c].releaseElement();p=!1}};return{init:function(){c.push([this.show,[]])},show:function(){$rs.rsid(a);
a.id=e=a.id||rspkr.getID();ui=rspkr.ui;$rs.hasClass(a,rspkr.ui.rsbtnClass)||$rs.addClass(a,rspkr.ui.rsbtnClass);t();var c=$rs.findIn(a,".rsbtn_status_overlay");$rs.isArray(c)||$rs.css(c,"display","none");"fallback"===rspkr.pl.adapter&&(rspkr.ui.showOverlay("nosound",a),$rs.addClass(a,"rsstopped"));$rs.addClass(a,"rsexpanded");if(rspkr.basicMode){var h;(h=$rs.findIn(a,".rsbtn_play"))&&$rs.addClass(h,"rsexpanded")}l||(m.stop()&&($rs.regEvent(m.stop(),"click",function(a){b(a);r.stop()}),ui.addFocusHandler(m.stop())),
m.pause()&&($rs.regEvent(m.pause(),"click",function(c){b(c);$rs.hasClass(a,"rsplaying")?r.pause():($rs.hasClass(a,"rsstopped")||$rs.hasClass(a,"rspaused"))&&r.play()}),ui.addFocusHandler(m.pause())),m.closer()&&($rs.regEvent(m.closer(),"click",function(a){b(a);r.close()}),ui.addFocusHandler(m.closer())),m.vol()&&($rs.regEvent(m.vol(),"click",function(a){b(a);r.vol(a)}),ui.addFocusHandler(m.vol())),m.dl()&&($rs.regEvent(m.dl(),"click",function(a){b(a);return r.dl()}),ui.addFocusHandler(m.dl())),m.settings()&&
($rs.regEvent(m.settings(),"click",function(a){b(a);r.settings()}),ui.addFocusHandler(m.settings())),m.pin()&&($rs.regEvent(m.pin(),"click",function(a){b(a);r.pin()}),ui.addFocusHandler(m.pin())),c=rspkr.cfg,$rs.setAttr(a,"data-readspeaker-current",0),$rs.setAttr(a,"data-readspeaker-buffered",0),$rs.isArray($rs.findIn($rs.get(a),".rsbtn_progress_container"))||(q.progress=new rspkr.ui.Slider,q.progress.init($rs.findIn($rs.get(a),".rsbtn_progress_container"),{handleClass:c.item("ui.progressHandleClass")||
"rsbtn_progress_handle rsimg",dir:c.item("ui.progressDir")||"h",nudge:5,start:v,dragging:y,click:z,labelDragHandle:c.getPhrase("sliderseek")}),h=$rs.findIn($rs.get(a),".rsbtn_progress_handle a"),ui.addFocusHandler(h,!1,h.parentNode)),$rs.isArray($rs.findIn($rs.get(a),".rsbtn_volume_slider"))||(h=rspkr.st.get("hlvol")||"100",h=parseInt(h)/100*5,q.vol=new rspkr.ui.Slider,q.vol.init($rs.findIn(a,".rsbtn_volume_slider"),{handleClass:c.item("ui.volumeHandleClass")||"rsbtn_volume_handle rsimg",dir:c.item("ui.volumeDir")||
"v",steps:5,nudge:1,initval:h,dragging:A,click:A,labelDragHandle:c.getPhrase("slidervolumedesc")}),h=$rs.findIn($rs.get(a),".rsbtn_volume_handle a"),ui.addFocusHandler(h,!1,h.parentNode)),rspkr.Common.addEvent("onFocusIn",B),rspkr.Common.addEvent("onFocusOut",C),rspkr.cfg.execCallback("cb.ui.open",a),l=!0);$rs.findIn(a,".rsbtn_powered")&&(c=$rs.findIn(a,".rsbtn_powered .rsbtn_btnlabel a"))&&((/Chrome|Safari|Opera/gi.test(rs.c.data.browser.name)||/Explorer/gi.test(rs.c.data.browser.name)&&8<=rs.c.data.browser.version)&&
$rs.regEvent(c,"click",function(a){b(a)}),c.innerHTML='<span class="rsbtn_label_read">Read</span><span class="rsbtn_label_speaker">Speaker</span><span class="rsbtn_label_icon rsimg"></span>');"0"!=$rs.getAttr(a,"data-readspeaker-current")&&(rspkr.pl.releaseAdapter(),$rs.setAttr(a,"data-readspeaker-current",0));"fallback"!==rspkr.pl.adapter&&(r.play(),rspkr.ui.focus(m.pause()));g=f(a);isNaN(g)||$rs.css(a,"width",g+(/[Ee]xplorer/.test(ReadSpeaker.c.data.browser.name)?1:0)+"px")},close:function(a){r.close(a)},
stop:function(){r.stop()},nosound:function(){return r.nosound()},pause:function(){r.pause()},play:function(){r.play()},restart:function(){rspkr.log("[rspkr.ui.restart]");r.stop();window.setTimeout(function(){r.play()},500);return!1},updateProgress:function(a){x(a)},setProgress:function(a){y(a)},getContainer:function(){return a},getID:function(){return e},getWidth:function(){return g},setHref:function(a){n=a},getHref:function(){return n}}};
ReadSpeaker.ui.Lightbox=function(){var a=null,b=null,f=null,e=null,h=null,c=null,g,l=[],n=function(a){a=a||window.event;a.returnValue=!1;if(a=a.originalEvent)a.cancelBubble=!0,a.returnValue=!1;a&&a.preventDefault&&a.preventDefault();a&&a.stopPropagation&&a.stopPropagation()},k=function(){$rs.css(c,"display","none");var a=$rs.height(window),b=$rs.height(document),e=parseInt($rs.css(document.documentElement,"width")),f=$rs.width(document),g=$rs.absOffset(document.body),k=0,l=0;isNaN(e)&&(e=$rs.width(window));
g.left&&(l=g.left);g.top&&(k=g.top);$rs.css(h,{width:(f>e?f:e)+"px",height:(b>a?b:a)+"px",top:"-"+Math.abs(k)+"px",left:"-"+Math.abs(l)+"px"});$rs.css(c,"display","block");m()},m=function(){var a=$rs.outerWidth(c),b=$rs.outerHeight(c),e=$rs.width(window),f=$rs.height(window),b=g+80+50<f?g+80:f-50;c.style.height=b+"px";$rs.get("#rslightbox_content").style.height=b-80+"px";b>f?(c.style.top=$rs.scrollTop(document)+"px",c.style.marginTop="10px"):(c.style.top=f/2+"px",c.style.marginTop=-(b/2-$rs.scrollTop(document))+
"px");a>e?(c.style.left=$rs.scrollLeft(document)+"px",c.style.marginLeft="0"):(c.style.left="50%",c.style.marginLeft=-(a/2-$rs.scrollLeft(document))+"px")},p=function(a){27===a.keyCode&&rspkr.ui.Lightbox.hide()};return{init:function(){var c=rspkr.pub.Config;a=c.item("ui.overlay.overlayStyles");b=c.item("ui.overlay.contentStyles");f=c.item("ui.overlay.contentTemplate");document.querySelectorAll||(d=document,s=d.createStyleSheet(),d.querySelectorAll=function(a,b,c,e,f){f=d.all;b=[];a=a.replace(/\[for\b/gi,
"[htmlFor").split(",");for(c=a.length;c--;){s.addRule(a[c],"k:v");for(e=f.length;e--;)f[e].currentStyle.k&&b.push(f[e]);s.removeRule(0)}return b});rspkr.log("[rspkr.ui.Lightbox] Heartbeat!")},show:function(m,t,r,w,x){for(var u=0,v=document.body.getElementsByTagName("*"),y;y=v[u];u++)-1!=y.tabIndex&&(l.push([y,y.tabIndex]),y.tabIndex=-1);y=document.querySelectorAll("body > *");for(u=0;v=y[u];u++)if("rslightbox_overlay"!=v.id&&"rslightbox_contentcontainer"!=v.id&&"script"!=v.tagName.toLowerCase()){var z=
v.getAttribute("aria-hidden");z&&v.setAttribute("data-original-aria-hidden",z);v.setAttribute("aria-hidden","true")}m=m||"";r=r||!1;h?(h.style.display="",c.style.display=""):(h=document.createElement("div"),h.id="rslightbox_overlay",c=document.createElement("div"),c.id="rslightbox_contentcontainer",c.innerHTML=rspkr.st.r().replaceTokens(f.join("\n"),{rsLIGHTBOX_CLOSE_LABELrs:rspkr.cfg.getPhrase("close")}),$rs.setAttr(h,"style",a.join(";")),$rs.setAttr(c,"style",b.join(";")),document.body.appendChild(h),
document.body.appendChild(c),rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.changed.addButtonEvents,context:rspkr.st.r().handlers.changed,params:[this]}));u=$rs.get("rslightbox_closer");rspkr.ui.addFocusHandler(u,!1);$rs.regEvent(u,"click",function(a){n(a);rspkr.ui.Lightbox.hide(a)});$rs.regEvent(h,"click",rspkr.ui.Lightbox.hide);$rs.regEvent(document.body,"keyup",p);(u=document.documentElement)&&document.all&&(u.style.overflowX=u.style.overflowY="hidden");if(m!=e||r)$rs.get("#rslightbox_content").innerHTML=
"",$rs.css("#rslightbox_content","height","auto"),/^http/i.test(m)?$rs.findIn("#rslightbox_content","iframe").length||(r=document.createElement("iframe"),r.src=m,r.className="rslightbox-iframe",void 0===x&&(x=2E3),$rs.get("#rslightbox_content").appendChild(r)):"<"==m.substr(0,1)&&($rs.get("#rslightbox_content").innerHTML=m),$rs.get("#rslightbox_buttons").innerHTML=t,e=m,"ar_ar"==rs.c.data.params.lang&&(-1==c.className.indexOf("rtl")&&(c.className=(c.className+" rtl").replace(/^\s+|\s+$/g,"")),$rs.setAttr($rs.findIn(c,
"legend"),"align","right"));g=void 0===x||isNaN(x)?rspkr.basicMode?$rs.get("#rslightbox_content").scrollHeight:$rs.get("#rslightbox_content").clientHeight:x;m=$rs.findIn("#rslightbox_content",".rsform-row");for(u=0;u<m.length;u++)for(t=$rs.findIn(m[u],"input, a, select"),$rs.isArray(t)||(t=[t]),v=0;v<t.length;v++)rspkr.ui.addFocusHandler(t[v],!1,m[u]);var A=$rs.findIn("#rslightbox_buttons",".rssettings-button-close");rspkr.ui.addFocusHandler(A,!1);$rs.regEvent(A,"click",function(a){n(a)});(m=$rs.findIn("#rsform_wrapper",
".rssettings-button-gotobottom"))&&!$rs.isArray(m)&&rspkr.ui.addFocusHandler(m,!1);(m=$rs.findIn("#rslightbox_buttons",".rssettings-button-gototop"))&&!$rs.isArray(m)&&rspkr.ui.addFocusHandler(m,!1);var B=$rs.findIn("#rslightbox_content","input");$rs.isArray(B)&&0<B.length?setTimeout(function(){rspkr.ui.focus(B[0]);rspkr.Common.addEvent("onFocusIn",function(a,b){a.className&&$rs.hasClass(a,"rssettings-button-gototop")?rspkr.ui.focus(B[0]):a.className&&$rs.hasClass(a,"rssettings-button-gotobottom")&&
rspkr.ui.focus(A)})},200):$rs.isArray(B)||setTimeout(function(){rspkr.ui.focus(B)},200);k();$rs.regEvent(window,"resize",k);"function"==typeof w&&w.apply(this,[c])},hide:function(a){for(;0<l.length;)a=l.pop(),a[0].tabIndex=a[1];a=document.querySelectorAll("body > *");for(var b=0,e;e=a[b];b++){var f=e.getAttribute("data-original-aria-hidden");f?(e.setAttribute("aria-hidden",f),e.removeAttribute("data-original-aria-hidden")):e.removeAttribute("aria-hidden")}n(a);h.style.display="none";c.style.display=
"none";$rs.unregEvent(window,"resize",k);$rs.unregEvent($rs.get("#rslightbox_closer"),"click",rspkr.ui.Lightbox.hide);$rs.unregEvent(h,"click",rspkr.ui.Lightbox.hide);$rs.unregEvent(document.body,"keyup",p);(a=document.documentElement)&&document.all&&(a.style.overflowX=a.style.overflowY="auto");rspkr.ui.updateFocus();rspkr.c.dispatchEvent("onSettingsClosed",window,[])},reposition:m}}();
rspkr.initialize.mods=function(){for(var a="string"===typeof rspkr.getParams().pids?[rspkr.getParams().pids]:rspkr.getParams().pids,b,f,e=0,h=a.length;e<h;e++){rspkr.log("Product: "+a[e],4);b=rspkr.modmap.products[a[e]]();for(var c=0,g=b.length;c<g;c++){f=3>b[c].length?[b[c][0]]:"string"===typeof b[c][2]?[b[c][2]]:b[c][2];for(var l=0,n=f.length;l<n;l++)rspkr.initialize.execInit(f[l])}}rspkr.Common.addEvent("onReady",function(){rspkr.dispatcher.executeCode();rspkr.dispatcher.flush()});rspkr.Common.addEvent("onReady",
function(){var a=$rs.get("."+rspkr.ui.rsbtnClass+" a.rsbtn_play");a&&($rs.isArray(a)&&0<a.length||!$rs.isArray(a)&&"object"===typeof a)&&rspkr.pub.Config.execCallback("cb.rsReady",window)});rspkr.Common.addEvent("onDOMReady",function(){rspkr.Common.createShortcuts();rspkr.Common.dispatchEvent("onModsLoaded",window);rspkr.Common.dispatchEvent("onAfterModsLoaded",window);rspkr.displog.onAdapterReady?rspkr.Common.dispatchEvent("onReady",window):rspkr.Common.addEvent("onAdapterReady",function(){rspkr.Common.dispatchEvent("onReady",
window)})});return!0}();(function(a){var b=navigator.userAgent,f=eval("/*@cc_on! @*/false"),e=setTimeout;/mozilla/i.test(b)&&!/(compati)/.test(b)||/opera/i.test(b)||/webkit/i.test(b)?document.addEventListener("DOMContentLoaded",a,!1):f?function(){var b=document.createElement("doc:rdy");try{b.doScroll("left"),a()}catch(c){e(arguments.callee,0)}}():window.onload=a})(ReadSpeaker.init);
